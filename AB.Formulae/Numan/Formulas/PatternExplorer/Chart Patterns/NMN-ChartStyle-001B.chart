<?xml version="1.0" encoding="UTF-8"?>
<Window>
	<Sheet>
		<Name>Price-MACD-StochRSI-Vol</Name>
		<Pane>
			<ChartID>1001</ChartID>
			<PercentHeight>50</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) Vol " +WriteVal( V, 1.0 ) +" {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 )) ));\r\nPlot( C, "Close", ParamColor("Color", colorBlack ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\nif( ParamToggle("Tooltip shows", "All Values|Only Prices" ) )\r\n{\r\n ToolTip=StrFormat("Open: %g\\nHigh:  %g\\nLow:   %g\\nClose:  %g (%.1f%%)\\nVolume: "+NumToStr( V, 1 ), O, H, L, C, SelectedValue( ROC( C, 1 )));\r\n}\r\nGfxSetOverlayMode(1);\r\nGfxSelectFont("Tahoma", Status("pxheight")/6 );\r\nGfxSetTextAlign( 3 );// center alignment\r\nGfxSetTextColor( ColorRGB( 200, 200, 200 ) );\r\nGfxSetBkMode(1); // transparent\r\nGfxTextOut( Name(), Status("pxwidth")/2, Status("pxheight")/12 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Mid MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 45, 2, 300, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Long MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 100, 2, 400, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands-A");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorWhite, 0.9 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands-B");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 10, 1.35, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorViolet );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorViolet, 0.29 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Volume");\r\nPlot( Volume, _DEFAULT_NAME(), ParamColor("Color", colorLavender ), styleNoTitle | ParamStyle( "Style", styleHistogram | styleOwnScale | styleThick | styleNoLabel, maskHistogram  ), 2 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Price Interpretation");\r\nmovshort = ParamField("Short Time MA", 8 );\r\nmovmed = ParamField("Mid Time MA", 9 );\r\nmovlong = ParamField("Long Time MA", 10 );\r\nbtop = ParamField("BBTop", 11 );\r\nbbot = ParamField("BBBottom", 12 );\r\nif( Status("action") == actionCommentary )\r\n{\r\nwidth = btop - bbot;\r\nlslop = LinRegSlope( C, 30 ) + 100;\r\nlslo = LLV( lslop, 90 );\r\nlshi = HHV( lslop, 90 );\r\nlswidth = lshi - lslo;\r\ntrend = 100*( lslop - lslo )/lswidth;\r\n\r\nmawidth = MA( width, 100 );\r\nrelwidth = 100*(width - mawidth)/mawidth;\r\n\r\n_N( tname = Name()+"("+FullName()+")" );\r\n\r\nprintf("Price and moving averages:\\n");\r\nprintf( tname + " has closed " + WriteIf( C &gt; movshort, "above" , "below" ) + " its Short time moving average. ");\r\n\r\nprintf("\\nShort time moving average is currently " + WriteIf( movshort &gt; movmed, "above", "below") + " mid-time, AND " + WriteIf( movshort &gt; movlong, "above", "below" ) + " long time moving averages.");\r\n\r\nprintf("\\nThe relationship between price and moving averages is: "+\r\nWriteIf( C &gt; movshort AND movshort &gt; movmed, "bullish",\r\nWriteIf( C &lt; movshort AND movshort &lt; movmed, "bearish", "neutral" ) ) + " in short-term, and "+\r\nWriteIf( movshort &gt; movmed AND movmed &gt; movlong , "bullish",\r\nWriteIf( movshort &lt; movmed AND movmed &lt; movlong, "bearish", "neutral" ) ) + " in mid-long term. ");\r\n\r\nprintf("\\n\\nBollinger Bands:\\n");\r\nprintf(tname+ " has closed " + \r\nWriteIf( C &lt; bbot, "below the lower band by " +\r\nWriteVal( 100 *( bbot-C )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &lt; 30, " This combined with the steep downtrend can suggest that the downward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the lower band and a downside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &gt; btop, "above the upper band by " +\r\nWriteVal( 100 *( C- btop )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &gt; 70, " This combined with the steep uptrend suggests that the upward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the upper band and a upside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &lt; btop AND ( ( btop - C ) / width ) &lt; 0.5, \r\n"below upper band by " +\r\nWriteVal( 100 *( btop - C )/ width, 1.1 ) + "%%. ", \r\nWriteIf( C &lt; btop AND C &gt; bbot , "above bottom band by " +\r\nWriteVal( 100 *( C - bbot )/ width, 1.1 ) + "%%. ", "" ) ));\r\n\r\nprintf("\\n"+\r\nWriteIf( ( trend &gt; 30 AND trend &lt; 70 AND ( C &gt; btop OR C &lt; bbot ) ) AND abs(relwidth) &gt; 40,\r\n\t\t "This picture becomes somewhat unclear due to the fact that Bollinger Bands are  currently",\r\n\t\t "Bollinger Bands are " )+\t  \r\nWriteVal( abs( relwidth ), 1.1 ) + "%% " +\r\nWriteIf( relwidth &gt; 0, "wider" , "narrower" ) +\r\n" than normal.");\r\n\r\nprintf("\\n");\r\n\r\nprintf(\r\nWriteIf( abs( relwidth ) &lt; 40, "The current width of the bands (alone) does not suggest anything conclusive about the future volatility or movement of prices.","")+\r\nWriteIf( relwidth &lt; -40, "The narrow width of the bands suggests low volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility increasing with a sharp price move has increased for the near-term. "+\r\n"The bands have been in this narrow range for " + WriteVal(BarsSince(Cross(-40,relwidth)),1.0) + " bars. The probability of a significant price move increases the longer the bands remain in this narrow range." ,"")+\r\nWriteIf( relwidth &gt; 40, "The large width of the bands suggest high volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility decreasing and prices entering (or remaining in) a trading range has increased for the near-term. "+\r\n"The bands have been in this wide range for  " + WriteVal(BarsSince(Cross(relwidth,40)),1.0) + " bars.The probability of prices consolidating into a less volatile trading range increases the longer the bands remain in this wide range." ,""));\r\n\r\nprintf("\\n\\nThis commentary is not a recommendation to buy or sell. Use at your own risk.");\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Custom\\Price (all in one) 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>474.685</Min>
			<Max>973.596</Max>
		</Pane>
		<Pane>
			<ChartID>2</ChartID>
			<PercentHeight>13</PercentHeight>
			<Formula>_SECTION_BEGIN("MACD");\r\nr1 = Param( "Fast avg", 12, 2, 200, 1 );\r\nr2 = Param( "Slow avg", 26, 2, 200, 1 );\r\nr3 = Param( "Signal avg", 9, 2, 200, 1 );\r\nPlot( ml = MACD(r1, r2), StrFormat(_SECTION_NAME()+"(%g,%g)", r1, r2), ParamColor("MACD color", colorRed ), ParamStyle("MACD style") );\r\nPlot( sl = Signal(r1,r2,r3), "Signal" + _PARAM_VALUES(), ParamColor("Signal color", colorBlue ), ParamStyle("Signal style") );\r\nPlot( ml-sl, "MACD Histogram", ParamColor("Histogram color", colorBlack ), styleNoTitle | ParamStyle("Histogram style", styleHistogram | styleNoLabel, maskHistogram ) );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_MACD.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741849</MoreFlags>
			<Min>-68.5486</Min>
			<Max>52.6346</Max>
		</Pane>
		<Pane>
			<ChartID>1007</ChartID>
			<PercentHeight>16</PercentHeight>
			<Formula> \r\n\r\n \r\n\r\n_SECTION_BEGIN("StochRSI T3 based");\r\n\r\n/*StochRSI with smoothing formula*/\r\n\r\n \r\n\r\n//Tillson Smoothing Function\r\n\r\nfunction T3(price,periods) //AMA-based\r\n\r\n \r\n\r\n{\r\n\r\n \r\n\r\ns=Param("Hot ?",0.618,0,100,0.001,0);\r\n\r\nperiods = 2/(periods+1);\r\n\r\n \r\n\r\ne1=AMA(price,periods);\r\n\r\ne2=AMA(e1,Periods);\r\n\r\n \r\n\r\ne3=AMA(e2,Periods);\r\n\r\ne4=AMA(e3,Periods);\r\n\r\n \r\n\r\ne5=AMA(e4,Periods);\r\n\r\ne6=AMA(e5,Periods);\r\n\r\n \r\n\r\nc1=-s*s*s;\r\n\r\nc2=3*s*s+3*s*s*s;\r\n\r\n \r\n\r\nc3=-6*s*s-3*s-3*s*s*s;\r\n\r\nc4=1+3*s+s*s*s+3*s*s;\r\n\r\n \r\n\r\nTi3=c1*e6+c2*e5+c3*e4+c4*e3;\r\n\r\nreturn Ti3;\r\n\r\n \r\n\r\n}\r\n\r\n \r\n\r\n \r\n\r\n//StochRSI\r\n\r\nStochRSI=(Sum(RSI(14) - LLV(RSI(14), 14), 3) / \r\n\r\n \r\n\r\nSum(HHV(RSI(14), 14) - LLV(RSI(14), 14), 3))*100;\r\n\r\nPlot(StochRSI,"StochRSI",ParamColor("StochRSI color", colorRed ), ParamStyle("StochRSI style", styleLine) );\r\n\r\n \r\n\r\n//Smoothing\r\n\r\n \r\n\r\nPlot(T3(StochRSI,3),"T3-StochRSI",ParamColor("T3-StochRSI color", colorLime), ParamStyle("T3-StochRSI", styleDashed));\r\n\r\n \r\n\r\nPlot(30,"",3, styleNoLabel + styleDashed);\r\n\r\n \r\n\r\nPlot(70,"",3, styleNoLabel + styleDashed);\r\n\r\n \r\n\r\n//End\r\n\r\n \r\n\r\n_SECTION_END();\r\n\r\n \r\n\r\n \r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\StochRSI 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-3.25555</Min>
			<Max>105.183</Max>
		</Pane>
		<Pane>
			<ChartID>1024</ChartID>
			<PercentHeight>19</PercentHeight>
			<Formula>_SECTION_BEGIN("Volume");\r\nPlot( Volume, _DEFAULT_NAME(), IIf( C &gt; O, ParamColor("Up Color", colorGreen ), ParamColor("Down Color", colorRed ) ), ParamStyle( "Style", styleHistogram | styleThick, maskHistogram  ) );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Volume1");\r\nPlot( Volume, _DEFAULT_NAME(), ParamColor("Color", colorBlueGrey ), ParamStyle( "Style", styleHistogram | styleOwnScale | styleThick, maskHistogram  ), 2 );\r\n_SECTION_END();\r\n\r\nfunction PlotGradientArea( array, caption, ColorTop, ColorBottom ) \r\n{ \r\n bkclr = GetChartBkColor(); \r\n\r\n HH = HighestVisibleValue( array ); \r\n if( NOT IsNull( hh ) ) SetChartBkGradientFill( ColorTop, ColorBottom, bkclr, Null, HH ); \r\n Plot( array, Caption, ColorBlend( ColorBottom, colorBlack ) ); \r\n PlotOHLC( HH, HH, array, HH, "", bkclr, styleNoLabel | styleNoTitle | styleCloud, Null, Null, 0, -10 ); \r\n}\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Volume (color) 3.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>-8101</Min>
			<Max>425789</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>GradPrice.RSI(14)-AD</Name>
		<Pane>
			<ChartID>1004</ChartID>
			<PercentHeight>60</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) Vol " +WriteVal( V, 1.0 ) +" {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 )) ));\r\nPlot( C, "Close", ParamColor("Color", colorBlack ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\nif( ParamToggle("Tooltip shows", "All Values|Only Prices" ) )\r\n{\r\n Tooltip=StrFormat("Open: %g\\nHigh:  %g\\nLow:   %g\\nClose:  %g (%.1f%%)\\nVolume: "+NumToStr( V, 1 ), O, H, L, C, SelectedValue( ROC( C, 1 )));\r\n}\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Mid MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 45, 2, 300, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Long MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 100, 2, 400, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorWhite, 0.9 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Price Interpretation");\r\nmovshort = ParamField("Short Time MA", 8 );\r\nmovmed = ParamField("Mid Time MA", 9 );\r\nmovlong = ParamField("Long Time MA", 10 );\r\nbtop = ParamField("BBTop", 11 );\r\nbbot = ParamField("BBBottom", 12 );\r\nif( Status("action") == actionCommentary )\r\n{\r\nwidth = btop - bbot;\r\nlslop = LinRegSlope( C, 30 ) + 100;\r\nlslo = LLV( lslop, 90 );\r\nlshi = HHV( lslop, 90 );\r\nlswidth = lshi - lslo;\r\ntrend = 100*( lslop - lslo )/lswidth;\r\n\r\nmawidth = MA( width, 100 );\r\nrelwidth = 100*(width - mawidth)/mawidth;\r\n\r\n_N( tname = Name()+"("+FullName()+")" );\r\n\r\nprintf("Price and moving averages:\\n");\r\nprintf( tname + " has closed " + WriteIf( C &gt; movshort, "above" , "below" ) + " its Short time moving average. ");\r\n\r\nprintf("\\nShort time moving average is currently " + WriteIf( movshort &gt; movmed, "above", "below") + " mid-time, AND " + WriteIf( movshort &gt; movlong, "above", "below" ) + " long time moving averages.");\r\n\r\nprintf("\\nThe relationship between price and moving averages is: "+\r\nWriteIf( C &gt; movshort AND movshort &gt; movmed, "bullish",\r\nWriteIf( C &lt; movshort AND movshort &lt; movmed, "bearish", "neutral" ) ) + " in short-term, and "+\r\nWriteIf( movshort &gt; movmed AND movmed &gt; movlong , "bullish",\r\nWriteIf( movshort &lt; movmed AND movmed &lt; movlong, "bearish", "neutral" ) ) + " in mid-long term. ");\r\n\r\nprintf("\\n\\nBollinger Bands:\\n");\r\nprintf(tname+ " has closed " + \r\nWriteIf( C &lt; bbot, "below the lower band by " +\r\nWriteVal( 100 *( bbot-C )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &lt; 30, " This combined with the steep downtrend can suggest that the downward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the lower band and a downside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &gt; btop, "above the upper band by " +\r\nWriteVal( 100 *( C- btop )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &gt; 70, " This combined with the steep uptrend suggests that the upward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the upper band and a upside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &lt; btop AND ( ( btop - C ) / width ) &lt; 0.5, \r\n"below upper band by " +\r\nWriteVal( 100 *( btop - C )/ width, 1.1 ) + "%%. ", \r\nWriteIf( C &lt; btop AND C &gt; bbot , "above bottom band by " +\r\nWriteVal( 100 *( C - bbot )/ width, 1.1 ) + "%%. ", "" ) ));\r\n\r\nprintf("\\n"+\r\nWriteIf( ( trend &gt; 30 AND trend &lt; 70 AND ( C &gt; btop OR C &lt; bbot ) ) AND abs(relwidth) &gt; 40,\r\n\t\t "This picture becomes somewhat unclear due to the fact that Bollinger Bands are  currently",\r\n\t\t "Bollinger Bands are " )+\t  \r\nWriteVal( abs( relwidth ), 1.1 ) + "%% " +\r\nWriteIf( relwidth &gt; 0, "wider" , "narrower" ) +\r\n" than normal.");\r\n\r\nprintf("\\n");\r\n\r\nprintf(\r\nWriteIf( abs( relwidth ) &lt; 40, "The current width of the bands (alone) does not suggest anything conclusive about the future volatility or movement of prices.","")+\r\nWriteIf( relwidth &lt; -40, "The narrow width of the bands suggests low volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility increasing with a sharp price move has increased for the near-term. "+\r\n"The bands have been in this narrow range for " + WriteVal(BarsSince(Cross(-40,relwidth)),1.0) + " bars. The probability of a significant price move increases the longer the bands remain in this narrow range." ,"")+\r\nWriteIf( relwidth &gt; 40, "The large width of the bands suggest high volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility decreasing and prices entering (or remaining in) a trading range has increased for the near-term. "+\r\n"The bands have been in this wide range for  " + WriteVal(BarsSince(Cross(relwidth,40)),1.0) + " bars.The probability of prices consolidating into a less volatile trading range increases the longer the bands remain in this wide range." ,""));\r\n\r\nprintf("\\n\\nThis commentary is not a recommendation to buy or sell. Use at your own risk.");\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Price (all in one) 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>474.685</Min>
			<Max>973.596</Max>
		</Pane>
		<Pane>
			<ChartID>3</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("RSI");\r\nSetChartOptions(0,0,chartGrid30|chartGrid70);\r\nperiods = Param( "Periods", 15, 1, 200, 1 );\r\nPlot( vrsi = RSI( periods), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style")  );\r\n\r\nif( Status("action") == actionCommentary ) \r\n{\r\n\r\nBuy = Cross( vrsi, 30 );\r\nSell = Cross( 70, vrsi );\r\n\r\nprintf( "The current value for the RSI" + periods + " is " + WriteVal( vrsi ) );\r\n\r\nprintf("\\n\\nThe RSI, written by J. Welles Wilder in 1978, can be used in several different ways to analyze a chart.\\n");\r\n\r\nprintf("Tops and Bottoms:\\n\\n");\r\n\r\nprintf( \r\nWriteIf( vrsi &gt; 70, "The RSI is above 70.  This is where it usually tops.  The RSI usually forms tops and bottoms before the underlying security.",\r\nWriteIf( vrsi &lt; 30, "The RSI is below 30.  This is where it usually bottoms.  The RSI usually forms tops and bottoms before the underlying security.",\r\n"The RSI is not currently in a topping (above 70) or bottoming (below 30) range. " \r\n+ WriteIf( Cross( 70, vrsi ), "However, the RSI just crossed below 70 from a topping formation.  This is a bearish sign.",\r\nWriteIf( Cross( vrsi, 30 ), "However, the RSI just crossed above 30 from a bottoming formation.  This is a bullish sign.", "" ) ) ) ) ); \r\n\r\nbars30 = BarsSince( Buy );\r\nbars70 = BarsSince( Sell );\r\n\r\nprintf("\\n\\nBuy/Sell signals:");\r\nprintf("\\nA buy or sell signal is generated when the RSI moves out of an overbought/oversold area. \\nThe last signal was a "+\r\nWriteIf( bars30 &lt; bars70, "buy", WriteIf( bars30 &gt; bars70, "sell", "" ))+\r\nWriteVal( Min( bars30, bars70 ), 3.0 ) + " period(s) ago.");\r\n\r\nprintf("\\n\\nChart Formations:");\r\n\r\nprintf("\\nThe RSI often forms chart patterns (such as head and shoulders or rising wedges) and support/resistance levels that may or may not be visible on the price chart.  "+\r\n"Since the analysis of chart patterns/formations is subjective, the automatic interpretator cannot find them.  Please visually inspect the chart and look for such patterns.");\r\n\r\nprintf("\\n\\nFailure Swings (also known as support or resistance penetrations or breakouts):");\r\nprintf(\r\nWriteIf( vrsi &gt;= HHV( vrsi, 14 ), "The RSI has just reached its highest value in the last 14 period(s).  This is bullish.",\r\nWriteIf( vrsi &lt;= LLV( vrsi, 14 ), "The RSI has just reached its lowest value in the last 14 period(s).  This is bearish.",\r\n"The RSI does not currently show any Failure Swings." ) ) );\r\n\r\nprintf("\\n\\nDivergence:\\n");\r\nprintf(\r\nWriteIf( Close &gt;= HHV( Close, 14 ) AND vrsi &lt; HHV( vrsi, 14 ), \r\n"The security price has set a new 14-day high while the RSI has not.  This is a bearish divergence.",\r\nWriteIf( vrsi &gt;= HHV( vrsi, 14 ) AND Close &lt; HHV( Close, 14 ), \r\n"The RSI has set a new 14-day high while the security price has not.  This is a bullish divergence.",\r\nWriteIf( Close &lt;= LLV( Close, 14 ) AND vrsi &gt; LLV( vrsi, 14 ), \r\n"The security price has set a new 14-day low while the RSI has not.  This is a bullish divergence.",\r\nWriteIf( vrsi &lt;= LLV( vrsi, 14) AND Close &gt; LLV(Close,14), \r\n"The RSI has set a new 14-day low while the security price has not.  This is a bearish divergence.",\r\n"The RSI and price are not diverging." ) ) ) )); \r\n\r\nprintf("\\nThis commentary is not a recommendation to buy or sell. Use at your own risk.");\r\n}\r\n_SECTION_END();\r\n\r\nfunction PlotGradientArea( array, caption, ColorTop, ColorBottom ) \r\n{ \r\n bkclr = GetChartBkColor(); \r\n\r\n HH = HighestVisibleValue( array ); \r\n if( NOT IsNull( hh ) ) SetChartBkGradientFill( ColorTop, ColorBottom, bkclr, Null, HH ); \r\n Plot( array, Caption, ColorBlend( ColorBottom, colorBlack ) ); \r\n PlotOHLC( HH, HH, array, HH, "", bkclr, styleNoLabel | styleNoTitle | styleCloud, Null, Null, 0, -10 ); \r\n} \r\n\r\n_SECTION_BEGIN("Price"); \r\nSetChartOptions(0,chartShowArrows|chartShowDates); \r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) )); \r\nPlotGradientArea( C, "Close", ParamColor("Top", colorLightOrange), ParamColor("Bottom", colorPaleGreen ) ); \r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_RSI.afl</FilePath>
			<Flags>3330</Flags>
			<MoreFlags>1073741849</MoreFlags>
			<Min>479.585</Min>
			<Max>957.072</Max>
		</Pane>
		<Pane>
			<ChartID>1003</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("AccDist");\r\nPlot( AccDist(), _DEFAULT_NAME(), ParamColor("Color", colorCycle ), ParamStyle("Style") );\r\n_SECTION_END();\r\n\r\nfunction PlotGradientArea( array, caption, ColorTop, ColorBottom ) \r\n{ \r\n bkclr = GetChartBkColor(); \r\n\r\n HH = HighestVisibleValue( array ); \r\n if( NOT IsNull( hh ) ) SetChartBkGradientFill( ColorTop, ColorBottom, bkclr, Null, HH ); \r\n Plot( array, Caption, ColorBlend( ColorBottom, colorBlack ) ); \r\n PlotOHLC( HH, HH, array, HH, "", bkclr, styleNoLabel | styleNoTitle | styleCloud, Null, Null, 0, -10 ); \r\n}\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\AccDist - Accumulation Distribution 1.afl</FilePath>
			<Flags>3328</Flags>
			<MoreFlags>1073741849</MoreFlags>
			<Min>-648598</Min>
			<Max>352286</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>%K%D-Vol.MAVol(15)</Name>
		<Pane>
			<ChartID>1008</ChartID>
			<PercentHeight>59</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) Vol " +WriteVal( V, 1.0 ) +" {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 )) ));\r\nPlot( C, "Close", ParamColor("Color", colorBlack ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\nif( ParamToggle("Tooltip shows", "All Values|Only Prices" ) )\r\n{\r\n Tooltip=StrFormat("Open: %g\\nHigh:  %g\\nLow:   %g\\nClose:  %g (%.1f%%)\\nVolume: "+NumToStr( V, 1 ), O, H, L, C, SelectedValue( ROC( C, 1 )));\r\n}\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Mid MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 45, 2, 300, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Long MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 100, 2, 400, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorWhite, 0.9 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Bollinger Bands");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorWhite, 0.9 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Price (foreign) 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>474.685</Min>
			<Max>973.596</Max>
		</Pane>
		<Pane>
			<ChartID>5</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("Stochastic Slow");\r\nperiods = Param( "Periods", 15, 1, 200, 1 );\r\nKsmooth = Param( "%K avg", 3, 1, 200, 1 );\r\nPlot( StochK( periods , Ksmooth), "%K"+_PARAM_VALUES(), ParamColor( "%K color", colorCycle ), ParamStyle("%K style") );\r\nDsmooth = Param( "%D avg", 3, 1, 200, 1 );\r\nPlot( StochD( periods , Ksmooth, DSmooth ), "%D"+_PARAM_VALUES(), ParamColor( "%D color", colorCycle ), ParamStyle("%D style") );\r\n\r\nif( Status("action") == actionCommentary )\r\n{\r\n printf("(Interpretation is not available yet)");\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_Stochastic_Slow.afl</FilePath>
			<Flags>3072</Flags>
			<MoreFlags>1073741825</MoreFlags>
			<Min>2.32134</Min>
			<Max>96.5143</Max>
		</Pane>
		<Pane>
			<ChartID>6</ChartID>
			<PercentHeight>21</PercentHeight>
			<Formula>_SECTION_BEGIN("Volume");\r\nPlot( Volume, _DEFAULT_NAME(), IIf( C &gt; O, ParamColor("Up Color", colorGreen ), ParamColor("Down Color", colorRed ) ), ParamStyle( "Style", styleHistogram | styleThick, maskHistogram  ) );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1, 10 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorBlue ), ParamStyle("Style") ); \r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_Volume.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741827</MoreFlags>
			<Min>-8101</Min>
			<Max>425789</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Ultimate(7,14,28)-OBV</Name>
		<Pane>
			<ChartID>1025</ChartID>
			<PercentHeight>51</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) Vol " +WriteVal( V, 1.0 ) +" {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 )) ));\r\nPlot( C, "Close", ParamColor("Color", colorBlack ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\nif( ParamToggle("Tooltip shows", "All Values|Only Prices" ) )\r\n{\r\n ToolTip=StrFormat("Open: %g\\nHigh:  %g\\nLow:   %g\\nClose:  %g (%.1f%%)\\nVolume: "+NumToStr( V, 1 ), O, H, L, C, SelectedValue( ROC( C, 1 )));\r\n}\r\nGfxSetOverlayMode(1);\r\nGfxSelectFont("Tahoma", Status("pxheight")/6 );\r\nGfxSetTextAlign( 3 );// center alignment\r\nGfxSetTextColor( ColorRGB( 200, 200, 200 ) );\r\nGfxSetBkMode(1); // transparent\r\nGfxTextOut( Name(), Status("pxwidth")/2, Status("pxheight")/12 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Mid MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 45, 2, 300, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Long MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 100, 2, 400, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands-A");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorWhite, 0.9 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands-B");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 10, 1.35, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorViolet );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorViolet, 0.29 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Volume");\r\nPlot( Volume, _DEFAULT_NAME(), ParamColor("Color", colorLavender ), styleNoTitle | ParamStyle( "Style", styleHistogram | styleOwnScale | styleThick | styleNoLabel, maskHistogram  ), 2 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Price Interpretation");\r\nmovshort = ParamField("Short Time MA", 8 );\r\nmovmed = ParamField("Mid Time MA", 9 );\r\nmovlong = ParamField("Long Time MA", 10 );\r\nbtop = ParamField("BBTop", 11 );\r\nbbot = ParamField("BBBottom", 12 );\r\nif( Status("action") == actionCommentary )\r\n{\r\nwidth = btop - bbot;\r\nlslop = LinRegSlope( C, 30 ) + 100;\r\nlslo = LLV( lslop, 90 );\r\nlshi = HHV( lslop, 90 );\r\nlswidth = lshi - lslo;\r\ntrend = 100*( lslop - lslo )/lswidth;\r\n\r\nmawidth = MA( width, 100 );\r\nrelwidth = 100*(width - mawidth)/mawidth;\r\n\r\n_N( tname = Name()+"("+FullName()+")" );\r\n\r\nprintf("Price and moving averages:\\n");\r\nprintf( tname + " has closed " + WriteIf( C &gt; movshort, "above" , "below" ) + " its Short time moving average. ");\r\n\r\nprintf("\\nShort time moving average is currently " + WriteIf( movshort &gt; movmed, "above", "below") + " mid-time, AND " + WriteIf( movshort &gt; movlong, "above", "below" ) + " long time moving averages.");\r\n\r\nprintf("\\nThe relationship between price and moving averages is: "+\r\nWriteIf( C &gt; movshort AND movshort &gt; movmed, "bullish",\r\nWriteIf( C &lt; movshort AND movshort &lt; movmed, "bearish", "neutral" ) ) + " in short-term, and "+\r\nWriteIf( movshort &gt; movmed AND movmed &gt; movlong , "bullish",\r\nWriteIf( movshort &lt; movmed AND movmed &lt; movlong, "bearish", "neutral" ) ) + " in mid-long term. ");\r\n\r\nprintf("\\n\\nBollinger Bands:\\n");\r\nprintf(tname+ " has closed " + \r\nWriteIf( C &lt; bbot, "below the lower band by " +\r\nWriteVal( 100 *( bbot-C )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &lt; 30, " This combined with the steep downtrend can suggest that the downward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the lower band and a downside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &gt; btop, "above the upper band by " +\r\nWriteVal( 100 *( C- btop )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &gt; 70, " This combined with the steep uptrend suggests that the upward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the upper band and a upside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &lt; btop AND ( ( btop - C ) / width ) &lt; 0.5, \r\n"below upper band by " +\r\nWriteVal( 100 *( btop - C )/ width, 1.1 ) + "%%. ", \r\nWriteIf( C &lt; btop AND C &gt; bbot , "above bottom band by " +\r\nWriteVal( 100 *( C - bbot )/ width, 1.1 ) + "%%. ", "" ) ));\r\n\r\nprintf("\\n"+\r\nWriteIf( ( trend &gt; 30 AND trend &lt; 70 AND ( C &gt; btop OR C &lt; bbot ) ) AND abs(relwidth) &gt; 40,\r\n\t\t "This picture becomes somewhat unclear due to the fact that Bollinger Bands are  currently",\r\n\t\t "Bollinger Bands are " )+\t  \r\nWriteVal( abs( relwidth ), 1.1 ) + "%% " +\r\nWriteIf( relwidth &gt; 0, "wider" , "narrower" ) +\r\n" than normal.");\r\n\r\nprintf("\\n");\r\n\r\nprintf(\r\nWriteIf( abs( relwidth ) &lt; 40, "The current width of the bands (alone) does not suggest anything conclusive about the future volatility or movement of prices.","")+\r\nWriteIf( relwidth &lt; -40, "The narrow width of the bands suggests low volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility increasing with a sharp price move has increased for the near-term. "+\r\n"The bands have been in this narrow range for " + WriteVal(BarsSince(Cross(-40,relwidth)),1.0) + " bars. The probability of a significant price move increases the longer the bands remain in this narrow range." ,"")+\r\nWriteIf( relwidth &gt; 40, "The large width of the bands suggest high volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility decreasing and prices entering (or remaining in) a trading range has increased for the near-term. "+\r\n"The bands have been in this wide range for  " + WriteVal(BarsSince(Cross(relwidth,40)),1.0) + " bars.The probability of prices consolidating into a less volatile trading range increases the longer the bands remain in this wide range." ,""));\r\n\r\nprintf("\\n\\nThis commentary is not a recommendation to buy or sell. Use at your own risk.");\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Custom\\Price (all in one) 11.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>474.685</Min>
			<Max>973.596</Max>
		</Pane>
		<Pane>
			<ChartID>7</ChartID>
			<PercentHeight>27</PercentHeight>
			<Formula>_SECTION_BEGIN("Ultimate");\r\nr1 = Param("Fast avg", 7, 2, 200, 1 );\r\nr2 = Param("Med avg", 14, 2, 200, 1 );\r\nr3 = Param("Slow avg", 28, 2, 200, 1 );\r\nPlot( Ultimate( r1, r2, r3 ), _DEFAULT_NAME(), ParamColor("Color", colorCycle ), ParamStyle("Style"));\r\n\r\nif( Status("action") == actionCommentary )\r\n{\r\n  printf( "(Interpretation is not available yet)" );\r\n}\r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_Ultimate.afl</FilePath>
			<Flags>19458</Flags>
			<MoreFlags>1073741837</MoreFlags>
			<Min>24.4055</Min>
			<Max>66.4101</Max>
		</Pane>
		<Pane>
			<ChartID>8</ChartID>
			<PercentHeight>21</PercentHeight>
			<Formula>_SECTION_BEGIN("OBV");\r\n\r\nPlot( OBV(), _DEFAULT_NAME(), ParamColor("Color", colorCycle ), ParamStyle("Style")  );\r\n\r\nif( Status("action") == actionCommentary )\r\n{\r\nprintf("Interpretation is NOT available yet)");\r\nprintf("On Balance Volume is a running total of volume. It shows if volume is flowing into or out of a security.");\r\n}\r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_OBV.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>3.11885e+006</Min>
			<Max>6.87732e+006</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE.Fib-Trix</Name>
		<Pane>
			<ChartID>1021</ChartID>
			<PercentHeight>80</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Fibonacci Recognition\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Fibonacci Recognition";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nAddparamUsefromChart( def_UseFromChart );\r\nSensitivity = Param( "Sensitivity", 10, 0, 100, 1 );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "P0O3U2", Sensitivity );\r\n\r\nif ( inAA AND Usefromchart )\r\n    Sensitivity = StaticVarGet( "P0O3U2" );\r\n\r\nColorstyle = ParamToggle( "Color Mode", "S/R|Custom", 1 );\r\n\r\nColor_SL =  ParamColor( "Support (S/R Mode)", def_Color_SL );\r\n\r\nColor_RL =  ParamColor( "Resistance (S/R Mode)", def_Color_RL );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Levels" );\r\n\r\nLevel_1p = Param( "Level 1", 38.2, 0, 200, 1 );\r\n\r\nLevel_2p = Param( "Level 2", 50.0, 0, 200, 1 );\r\n\r\nLevel_3p = Param( "Level 3", 61.8, 0, 200, 1 );\r\n\r\nLevel_4p = Param( "Level 4", 138.2, 0, 200, 1 );\r\n\r\nLevel_5p = Param( "Level 5", 150, 0, 200, 1 );\r\n\r\nLevel_6p = Param( "Level 6", 161.8, 0, 200, 1 );\r\n\r\nLevel_7p = Param( "Level 7", 200, 0, 300, 1 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\n\r\nSwingLow_style = ParamStyle( "Swing Low", styleLine + styleDots, maskAll );\r\n\r\nSwingHigh_style = ParamStyle( "Swing High", styleLine + styleDots, maskAll );\r\n\r\nL1_style = ParamStyle( "Level 1", styleLine + styleDashed, maskAll );\r\n\r\nL2_style = ParamStyle( "Level 2", styleLine, maskAll );\r\n\r\nL3_style = ParamStyle( "Level 3", styleLine + styleDashed, maskAll );\r\n\r\nL4_style = ParamStyle( "Level 4", styleLine + styleDashed, maskAll );\r\n\r\nL5_style = ParamStyle( "Level 5", styleLine, maskAll );\r\n\r\nL6_style = ParamStyle( "Level 6", styleLine + styleDashed, maskAll );\r\n\r\nL7_style = ParamStyle( "Level 7", styleLine + styleThick + styleDots, maskAll );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\n\r\nSwingLow_color = ParamColor( "Swing Low", def_SwingLow_color );\r\n\r\nSwingHigh_color = ParamColor( "Swing High", def_SwingHigh_color );\r\n\r\nL1_color = ParamColor( "Level 1", def_L1_color );\r\n\r\nL2_color = ParamColor( "Level 2", def_L2_color );\r\n\r\nL3_color = ParamColor( "Level 3", def_L3_color );\r\n\r\nL4_color = ParamColor( "Level 4", def_L4_color );\r\n\r\nL5_color = ParamColor( "Level 5", def_L5_color );\r\n\r\nL6_color = ParamColor( "Level 6", def_L6_color );\r\n\r\nL7_color = ParamColor( "Level 7", def_L7_color );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Selection" );\r\n\r\nL1_switch = ParamToggle( "Plot Level 1", "Off|On", 1 );\r\n\r\nL2_switch = ParamToggle( "Plot Level 2", "Off|On", 1 );\r\n\r\nL3_switch = ParamToggle( "Plot Level 3", "Off|On", 1 );\r\n\r\nL4_switch = ParamToggle( "Plot Level 4", "Off|On", 1 );\r\n\r\nL5_switch = ParamToggle( "Plot Level 5", "Off|On", 1 );\r\n\r\nL6_switch = ParamToggle( "Plot Level 6", "Off|On", 1 );\r\n\r\nL7_switch = ParamToggle( "Plot Level 7", "Off|On", 1 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f10.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\n\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\n\r\nAddColumn( CurrentRT_EXT, "Current RT/EXT %" );\r\n\r\nAddColumn( MaxRT_EXT, "Current max. RT/EXT %" );\r\n\r\nAddTextColumn(\r\n    WriteIf( Sup_pricejustabove, "Price just above",\r\n             WriteIf( Sup_confirmed, "Confirmed",\r\n                      WriteIf( Sup_break, "Break", "" ) ) ), "Swing Low", 1.2,\r\n    IIf( Sup_pricejustabove OR sup_confirmed, colorGreen, colorRed ) );\r\n\r\nAddTextColumn(\r\n    WriteIf( Res_pricejustbelow, "Price just below",\r\n             WriteIf( Res_confirmed, "Confirmed",\r\n                      WriteIf( Res_break, "Break", "" ) ) ), "Swing High", 1.2,\r\n    IIf( Res_pricejustbelow OR Res_confirmed, colorRed, colorGreen ) );\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nPlot( IIf( x &gt;= xa &amp;NOT AnZ, ya, -1e10 ), "", SLcol, 1 + 8 + 2048 );\r\n\r\nPlot( IIf( x &gt;= xb &amp;NOT AnZ, yb, -1e10 ), "", SHcol, 1 + 8 + 2048 );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_1, -1e10 ), "", L1col, L1_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_2, -1e10 ), "", L2col, L2_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_3, -1e10 ), "", L3col, L3_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_4, -1e10 ), "", L4col, L4_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_5, -1e10 ), "", L5col, L5_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_6, -1e10 ), "", L6col, L6_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_7, -1e10 ), "", L7col, L7_style + styleNoRescale );\r\n\r\nPlotText( WriteIf( L1_switch, "" + Level_1p + " %", "" ), LastValue( BarIndex() + 2 ), Level_1, L1col, colorDefault );\r\n\r\nPlotText( WriteIf( L2_switch, "" + Level_2p + " %", "" ), LastValue( BarIndex() + 2 ), Level_2, L2col, colorDefault );\r\n\r\nPlotText( WriteIf( L3_switch, "" + Level_3p + " %", "" ), LastValue( BarIndex() + 2 ), Level_3, L3col, colorDefault );\r\n\r\nPlotText( WriteIf( L4_switch, "" + Level_4p + " %", "" ), LastValue( BarIndex() + 2 ), Level_4, L4col, colorDefault );\r\n\r\nPlotText( WriteIf( L5_switch, "" + Level_5p + " %", "" ), LastValue( BarIndex() + 2 ), Level_5, L5col, colorDefault );\r\n\r\nPlotText( WriteIf( L6_switch, "" + Level_6p + " %", "" ), LastValue( BarIndex() + 2 ), Level_6, L6col, colorDefault );\r\n\r\nPlotText( WriteIf( L7_switch, "" + Level_7p + " %", "" ), LastValue( BarIndex() + 2 ), Level_7, L7col, colorDefault );\r\n\r\nPlotText( "100 %", LastValue( BarIndex() + 2 ), SwingLow, IIf( LastValue( up ), SwingLow_color, SwingHigh_color ), colorDefault );\r\n\r\nPlotText( "0 %", LastValue( BarIndex() + 2 ), Swinghigh, IIf( LastValue( dn ), SwingLow_color, SwingHigh_color ), colorDefault );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Fibonacci Recognition" + default_priceTitle + EncodeColor( IIf( NOT AnZ, def_Text2, colorRed ) ) + ", Sensitivity = " + WriteVal( Sensitivity, 1 ) + EncodeColor( colorRed ) + WriteIf( NOT AnZ, "", "  NO POINTS AVAILABLE -&gt; REDUCE SENSITIVITY" ) + EncodeColor( IIf( LastValue( L ) &gt; 0, Color_SL, Color_RL ) ) + ", Current Correction = " + WriteVal( CurrentRT_EXT, 1.0 ) + "%     ";\r\n\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Fibonacci Recognition 3.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>376.437</Min>
			<Max>1271.81</Max>
		</Pane>
		<Pane>
			<ChartID>9</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("TRIX");\r\nperiods = Param("Periods", 9, 2, 200, 1 );\r\nPlot( Trix( periods ), _DEFAULT_NAME(), ParamColor("color", colorCycle ), ParamStyle("Style") );\r\n\r\nif( Status("action") == actionCommentary )\r\n{\r\n printf( "(Interpretation is not available yet)" );\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_TRIX.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741825</MoreFlags>
			<Min>-18.8214</Min>
			<Max>12.8562</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE.Fractals.Swing-Volume</Name>
		<Pane>
			<ChartID>1026</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) Vol " +WriteVal( V, 1.0 ) +" {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 )) ));\r\nPlot( C, "Close", ParamColor("Color", colorBlack ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\nif( ParamToggle("Tooltip shows", "All Values|Only Prices" ) )\r\n{\r\n ToolTip=StrFormat("Open: %g\\nHigh:  %g\\nLow:   %g\\nClose:  %g (%.1f%%)\\nVolume: "+NumToStr( V, 1 ), O, H, L, C, SelectedValue( ROC( C, 1 )));\r\n}\r\nGfxSetOverlayMode(1);\r\nGfxSelectFont("Tahoma", Status("pxheight")/6 );\r\nGfxSetTextAlign( 6 );// center alignment\r\nGfxSetTextColor( ColorRGB( 200, 200, 200 ) );\r\nGfxSetBkMode(1); // transparent\r\nGfxTextOut( Name(), Status("pxwidth")/2, Status("pxheight")/12 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Mid MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 45, 2, 300, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Long MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 100, 2, 400, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands-A");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorWhite, 0.9 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands-B");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 10, 1.35, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorViolet );\r\nStyle = ParamStyle("Style") | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, colorViolet, 0.29 ), styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Volume");\r\nPlot( Volume, _DEFAULT_NAME(), ParamColor("Color", colorLavender ), styleNoTitle | ParamStyle( "Style", styleHistogram | styleOwnScale | styleThick | styleNoLabel, maskHistogram  ), 2 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Price Interpretation");\r\nmovshort = ParamField("Short Time MA", 8 );\r\nmovmed = ParamField("Mid Time MA", 9 );\r\nmovlong = ParamField("Long Time MA", 10 );\r\nbtop = ParamField("BBTop", 11 );\r\nbbot = ParamField("BBBottom", 12 );\r\nif( Status("action") == actionCommentary )\r\n{\r\nwidth = btop - bbot;\r\nlslop = LinRegSlope( C, 30 ) + 100;\r\nlslo = LLV( lslop, 90 );\r\nlshi = HHV( lslop, 90 );\r\nlswidth = lshi - lslo;\r\ntrend = 100*( lslop - lslo )/lswidth;\r\n\r\nmawidth = MA( width, 100 );\r\nrelwidth = 100*(width - mawidth)/mawidth;\r\n\r\n_N( tname = Name()+"("+FullName()+")" );\r\n\r\nprintf("Price and moving averages:\\n");\r\nprintf( tname + " has closed " + WriteIf( C &gt; movshort, "above" , "below" ) + " its Short time moving average. ");\r\n\r\nprintf("\\nShort time moving average is currently " + WriteIf( movshort &gt; movmed, "above", "below") + " mid-time, AND " + WriteIf( movshort &gt; movlong, "above", "below" ) + " long time moving averages.");\r\n\r\nprintf("\\nThe relationship between price and moving averages is: "+\r\nWriteIf( C &gt; movshort AND movshort &gt; movmed, "bullish",\r\nWriteIf( C &lt; movshort AND movshort &lt; movmed, "bearish", "neutral" ) ) + " in short-term, and "+\r\nWriteIf( movshort &gt; movmed AND movmed &gt; movlong , "bullish",\r\nWriteIf( movshort &lt; movmed AND movmed &lt; movlong, "bearish", "neutral" ) ) + " in mid-long term. ");\r\n\r\nprintf("\\n\\nBollinger Bands:\\n");\r\nprintf(tname+ " has closed " + \r\nWriteIf( C &lt; bbot, "below the lower band by " +\r\nWriteVal( 100 *( bbot-C )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &lt; 30, " This combined with the steep downtrend can suggest that the downward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the lower band and a downside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &gt; btop, "above the upper band by " +\r\nWriteVal( 100 *( C- btop )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &gt; 70, " This combined with the steep uptrend suggests that the upward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the upper band and a upside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &lt; btop AND ( ( btop - C ) / width ) &lt; 0.5, \r\n"below upper band by " +\r\nWriteVal( 100 *( btop - C )/ width, 1.1 ) + "%%. ", \r\nWriteIf( C &lt; btop AND C &gt; bbot , "above bottom band by " +\r\nWriteVal( 100 *( C - bbot )/ width, 1.1 ) + "%%. ", "" ) ));\r\n\r\nprintf("\\n"+\r\nWriteIf( ( trend &gt; 30 AND trend &lt; 70 AND ( C &gt; btop OR C &lt; bbot ) ) AND abs(relwidth) &gt; 40,\r\n\t\t "This picture becomes somewhat unclear due to the fact that Bollinger Bands are  currently",\r\n\t\t "Bollinger Bands are " )+\t  \r\nWriteVal( abs( relwidth ), 1.1 ) + "%% " +\r\nWriteIf( relwidth &gt; 0, "wider" , "narrower" ) +\r\n" than normal.");\r\n\r\nprintf("\\n");\r\n\r\nprintf(\r\nWriteIf( abs( relwidth ) &lt; 40, "The current width of the bands (alone) does not suggest anything conclusive about the future volatility or movement of prices.","")+\r\nWriteIf( relwidth &lt; -40, "The narrow width of the bands suggests low volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility increasing with a sharp price move has increased for the near-term. "+\r\n"The bands have been in this narrow range for " + WriteVal(BarsSince(Cross(-40,relwidth)),1.0) + " bars. The probability of a significant price move increases the longer the bands remain in this narrow range." ,"")+\r\nWriteIf( relwidth &gt; 40, "The large width of the bands suggest high volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility decreasing and prices entering (or remaining in) a trading range has increased for the near-term. "+\r\n"The bands have been in this wide range for  " + WriteVal(BarsSince(Cross(relwidth,40)),1.0) + " bars.The probability of prices consolidating into a less volatile trading range increases the longer the bands remain in this wide range." ,""));\r\n\r\nprintf("\\n\\nThis commentary is not a recommendation to buy or sell. Use at your own risk.");\r\n}\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Volume At Price");\r\nPlotVAPOverlay( Param("Lines", 300, 100, 1000, 1 ), Param("Width", 5, 1, 100, 1 ), ParamColor("Color", colorCycle ), ParamToggle("Side", "Left|Right" ) | 4*ParamToggle("Z-order", "On top|Behind", 1 ) );\r\n \r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Price (all in one) 4.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>474.685</Min>
			<Max>973.596</Max>
		</Pane>
		<Pane>
			<ChartID>1029</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Fractals\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Fractals";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Alerts" );\r\nSRbS = ParamToggle( "S/R broken", "Off,On", 1 );\r\nSRcS = ParamToggle( "S/R confirmed", "Off,On", 1 );\r\nPjabS = ParamToggle( "Price just above/below", "Off,On", 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main parameters" );\r\nSRplot = ParamToggle( "Plot S/R", "Off,On", 1 );\r\nSswitch = ParamToggle( "PLot Swing Chart", "Off,On", 0 );\r\nShswitch = ParamToggle( "Plot Swing Shapes", "Off,On", 0 );\r\nSwingSize = Param( "Swing Size %", 5, 0.1, 40, 0.1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Sensitivity" );\r\nAddparamUsefromChart2( def_UseFromChart );\r\nPatternPriceBasis = ParamToggle( "Pattern Price Basis", "Close|High &amp; Low", def_PatternPriceBasisFractals );\r\nBars = Param( "Bars", 5, 2, 20, 1 );\r\nMinVertSize = Param( "Minimum Vertical Size (*ATR)", 0, 0, 3.01, 0.05 );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "Ddf343", PatternPriceBasis );\r\n\r\nif ( inAA AND Usefromchart )\r\n    PatternPriceBasis = StaticVarGet( "Ddf343" );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "P54972", Bars );\r\n\r\nif ( inAA AND Usefromchart )\r\n    Bars = StaticVarGet( "P54972" );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "Adf343", MinVertSize );\r\n\r\nif ( inAA AND Usefromchart )\r\n    MinVertSize = StaticVarGet( "Adf343" );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\n\r\nSwingstyle = ParamStyle( "Swing Line", styleLine | styleThick, maskDefault );\r\n\r\nTopShape = Param( "Top Fractal Typ", 21, 0, 50, 1 );\r\n\r\nValleyShape = Param( "Valley Fractal Typ", 22, 0, 50, 1 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\n\r\nSLC = ParamColor( "Swing Low", colorPaleGreen );\r\n\r\nSHC = ParamColor( "Swing High", colorLightOrange );\r\n\r\nSwingcolor = ParamColor( "Swing Line", def_Color6 );\r\n\r\nTopshapecolor = ParamColor( "Top  Fractal", def_SellShapeColor );\r\n\r\nValleyshapecolor = ParamColor( "Bottom Fractal", def_BuyShapeColor );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f13.afl&gt;\r\n/*******************************************************************************************/\r\nPlotShapes( IIf( Top, TopShape, -1e10 ), Topshapecolor, 0, H, def_BuyShapeOffset );\r\n\r\nPlotShapes( IIf( Valley, Valleyshape, -1e10 ), ValleyShapecolor, 0, L, def_SellShapeOffset );\r\n\r\nPlot( IIf( SRplot &amp; x &gt;= x_lasttop, LastValue( ValueWhen( top, TopInput, 1 ) ), Null ), "", Topshapecolor, 1 + styleNoRescale );\r\n\r\nPlot( IIf( SRplot &amp; x &gt;= x_lastvalley, LastValue( ValueWhen( Valley, ValleyInput, 1 ) ), Null ), "", Valleyshapecolor, 1 + styleNoRescale );\r\n\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND ( Sup_confirmed OR Res_break );\r\n\r\nSell = def_Sell AND ( Res_confirmed OR Sup_break );\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( SupSignals OR ResSignals );\r\n\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\n\r\nAdddefaultcolumns( 2, 1 );\r\n\r\nAddTextColumn(\r\n    WriteIf( Sup_pricejustabove, "Price just above",\r\n             WriteIf( Sup_confirmed, "Confirmed",\r\n                      WriteIf( Sup_break, "Break", "" ) ) ), "Support", 1.2,\r\n    IIf( Sup_pricejustabove OR sup_confirmed, colorGreen, colorRed ) );\r\n\r\nAddTextColumn(\r\n    WriteIf( Res_pricejustbelow, "Price just below",\r\n             WriteIf( Res_confirmed, "Confirmed",\r\n                      WriteIf( Res_break, "Break", "" ) ) ), "Resistance", 1.2,\r\n    IIf( Res_pricejustbelow OR Res_confirmed, colorRed, colorGreen ) );\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nPlotShapes( IIf( Shswitch AND PivotLow, shapeCircle, Null ), SLC, 0, L, -35 ) ;\r\n\r\nPlotShapes( IIf( Shswitch AND PivotHigh, shapeCircle, Null ), SHC, 0, H, 35 ) ;\r\n\r\nPlot( IIf( Sswitch, ZZ, Null ), " ", Swingcolor, Swingstyle + styleNoTitle );\r\n\r\n/*******************************************************************************************/\r\nif ( SRbS )\r\n{\r\n    AddAlert( Res_break, Audio, Email, "Resistance broken", 1, BarComplete, def_BuySound1 );\r\n    AddAlert( Sup_break, Audio, Email, "Support broken", 2, BarComplete, def_SellSound1 );\r\n}\r\n\r\nif ( SRcS )\r\n{\r\n    AddAlert( Sup_confirmed, Audio, Email, "Support confirmed", 1, BarComplete, def_BuySound2 );\r\n    AddAlert( Res_confirmed, Audio, Email, "Resistance confirmed", 2, BarComplete, def_SellSound2 );\r\n}\r\n\r\nif ( PjabS )\r\n{\r\n    AddAlert( Sup_pricejustabove, Audio, Email, "Price just above Support", 1, BarComplete, def_BuySound1 );\r\n    AddAlert( Res_pricejustbelow, Audio, Email, "Price just below Resistance", 2, BarComplete, def_SellSound1 );\r\n}\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Fractals" + default_priceTitle;\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Fractals 3.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>454.583</Min>
			<Max>974.605</Max>
		</Pane>
		<Pane>
			<ChartID>1030</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Candlestick Recognition\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Candlesticks";\r\n\r\nSetChartOptions( 0, chartShowDates | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\ndef_PE_AB_Style = 0; //PatternExplorer style:0 //Amibroker style: 1\r\ndef_pricestyle = styleCandle;// + styleThick; //can be used at PatternExplorer mode\r\ndef_Band_switch = 1;//Off:0 //On:1\r\ndef_BandTyp = 0;//Off:0 //Bollinger Bands:1 //Headley Acceleration Bands:2 //Keltner Channel:3 //Price Channel:4\r\n/*******************************************************************************************/\r\n//AddparamUsefromChart(1);\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nActTrendFilter = ParamToggle( "Trend Filter", "Off,On", 0 );\r\nSRplot = ParamToggle( "Plot S/R", "Off,On", 1 );\r\nTextPlot = ParamToggle( "Plot Signal Text", "Off,On", 0 );\r\nBuyshape = Param( "Buy Shape Typ", def_BuyShape, 1, 60, 1 );\r\nSellshape = Param( "Sell Shape Typ", def_SellShape, 1, 60, 1 );\r\nBuyColor = ParamColor( "Buy Signals", def_BuyShapeColor );\r\nSellColor = ParamColor( "Sell Signals", def_SellShapeColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Pattern Selection" );\r\nDojistar_s = ParamToggle( "Doji Star", "Off,On", 1 );\r\nHammer_s = ParamToggle( "Hammer/Shooting Star", "Off,On", 1 );\r\nHangingman_s = ParamToggle( "Hanging Man/Inverted Hammer", "Off,On", 1 );\r\nSpinningtop_s = ParamToggle( "Spinning Top", "Off,On", 1 );\r\nEng_s = ParamToggle( "Engulfing", "Off,On", 1 );\r\nHarami_s = ParamToggle( "Harami", "Off,On", 1 );\r\nPiercingline_s = ParamToggle( "Piercing Line/Dark Cloud Cover", "Off,On", 1 );\r\nMorning_evening_star_s = ParamToggle( "Morning Star/Evening Star", "Off,On", 1 );\r\n_SECTION_END();\r\n/*Static - currently not support by amibroker\r\nif(InChart)StaticVarSet("PQQAWN",Dojistar_s);if(inAA AND Usefromchart) Dojistar_s = StaticVarGet("PQQAWN");\r\nif(InChart)StaticVarSet("ONLDUM",Hammer_s);if(inAA AND Usefromchart) Hammer_s = StaticVarGet("ONLDUM");\r\nif(InChart)StaticVarSet("CPAWNL",Hangingman_s);if(inAA AND Usefromchart) Hangingman_s = StaticVarGet("CPAWNL");\r\nif(InChart)StaticVarSet("MNHCWV",Spinningtop_s);if(inAA AND Usefromchart) Spinningtop_s = StaticVarGet("MNHCWV");\r\nif(InChart)StaticVarSet("FLXSHT",Eng_s);if(inAA AND Usefromchart) Eng_s = StaticVarGet("FLXSHT");\r\nif(InChart)StaticVarSet("FBDBRN",Harami_s);if(inAA AND Usefromchart) Harami_s = StaticVarGet("FBDBRN");\r\nif(InChart)StaticVarSet("OVITBK",Piercingline_s);if(inAA AND Usefromchart) Piercingline_s = StaticVarGet("OVITBK");\r\nif(InChart)StaticVarSet("VHVRAB",Morning_evening_star_s);if(inAA AND Usefromchart) Morning_evening_star_s = StaticVarGet("VHVRAB");\r\n*/\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f01.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\n\r\nif ( ActTrendFilter == 0 )\r\n{\r\n    Buy = def_Buy AND CandlePatternRank &gt; 0;\r\n    Sell = def_Sell AND CandlePatternRank &lt; 0;\r\n}\r\n\r\nif ( ActTrendFilter )\r\n{\r\n    Buy = def_Buy AND CandlePatternRank &gt; 0\r\n          AND PeTaio() &gt; 0\r\n          AND TaioTimeFrame( 5, 6, 4, expandLast ) &gt; 0\r\n          AND Taio2direction == 1; //define your conditions for the Trendfilter here.\r\n\r\n    Sell = def_Sell AND CandlePatternRank &lt; 0\r\n           AND PeTaio() &lt; 0\r\n           AND TaioTimeFrame( 5, 6, 4, expandLast ) &lt; 0\r\n           AND Taio2direction == 0; //define your conditions for the Trendfilter here.\r\n}\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter  AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( Buy OR Sell );\r\n\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\n\r\nAdddefaultcolumns( 2, 1 );\r\n\r\nif ( CandleColumnOn == 0 )\r\n    AddCandleColumn();\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nPlotShapes(\r\n    IIf( Buy, Buyshape,\r\n         IIf( Sell, Sellshape, Null ) ),\r\n    IIf( Buy, BuyColor, SellColor ), 0,\r\n    IIf( Buy, L, H ), IIf( Buy, -def_BuyShapeOffset, -def_SellShapeOffset ) );\r\n\r\nPlot( IIf( SRplot, Plot_Buy, Null ), "Support", Buycolor, 1 + styleNoTitle );\r\n\r\nPlot( IIf( SRplot, Plot_Sell, Null ), "Resistance", Sellcolor, 1 + styleNoTitle );\r\n\r\n/*******************************************************************************************/\r\nif ( TextPlot )\r\n{\r\n    //PlotSignalText (Condition,Text,AdText,AdTextArray,Distance,Array,TextColor,BGColor);\r\n    PlotSignalText ( PR &gt; 0, "Buy", 0, L, -0.8, L, BuyColor, colorDefault );\r\n    PlotSignalText ( PR &lt; 0, "Sell", 0, H, 1.0, H, SellColor, colorDefault );\r\n}\r\n\r\n/*******************************************************************************************/\r\nAddAlert( Hammer, Audio, Email, "Bullish Hammer" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beSSTAR, Audio, Email, "Bearish Shooting Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( InvertedHammer, Audio, Email, "Bullish Inverted Hammer" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( HangingMan, Audio, Email, "Bearish Hanging Man" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( SpinningTop AND NOT buDS, Audio, Email, "Bearish Spinning Top" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buENG, Audio, Email, "Bullish Engulfing" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beENG, Audio, Email, "Bearish Engulfing" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buHARAMI, Audio, Email, "Bullish Harami" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beHARAMI, Audio, Email, "Bearish Harami" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buHARAMICROSS, Audio, Email, "Bullish Harami Cross" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beHARAMICROSS, Audio, Email, "Bearish Harami Cross" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buDS, Audio, Email, "Bullish Doji Star" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beDS, Audio, Email, "Bearish Doji Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buPIERCINGLINE, Audio, Email, "Bullish Piercingline" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beDARKCLOUDCOVER, Audio, Email, "Bearish Dark Cloud Cover" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buMorningStar, Audio, Email, "Bullish Morning Star" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( buMorningDojiStar, Audio, Email, "Bullish Morning Doji Star" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beEveningStar, Audio, Email, "Bearish Evening Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( beEveningDojiStar, Audio, Email, "Bearish Evening Doji Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip + "\\n\\n" + CandlePattern;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Candlestick Recognition" + default_priceTitle + ", " + EncodeColor( def_Color3 ) + WriteIf( CandlePatternRank &gt; 0, "Bullish ", WriteIf( CandlePatternRank &lt; 0, "Bearish ", "" ) ) + CandlePattern + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Candlesticks 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741847</MoreFlags>
			<Min>454.848</Min>
			<Max>1000.35</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE.PriceTS-AD-Chaikin-PE.Fib</Name>
		<Pane>
			<ChartID>1016</ChartID>
			<PercentHeight>36</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Price chart TS - with Taio based Shapes\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Price Chart TS";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Indicator Periods" );\r\nperiod1 = Param( "Period 1", 5, 1, 30, 1 );\r\nperiod2 = Param( "Period 2", 6, 1, 30, 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Settings" );\r\nTrendLevel = Param( "Trend Level", 50, 0, 90, 1 );\r\nOBOSLevel = Param( "OB/OS Level", 80, 0, 100, 1 );\r\nOBOSLevelTF2 = Param( "OB/OS Level TF2", 60, 25, 100, 1 );\r\nTF2drop = ParamToggle( "TF2 Turn Over", "Off|0n", 0 );\r\nTaio2expandMode = ParamToggle( "Taio TF2 Expand Mode", "Expand First|Expand Last", 1 );\r\nMultiplier = Param( "Second Time Frame Multiplier", 4, 1, 30, 1 );\r\nUseExrem = ParamToggle( "Use Exrem", "Off|0n", 0 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Buy and Sell Signals" );\r\nBuySig = ParamList( "Buy Signal", List1 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Oversold,Trend Level reached,Taio2 Direction change", 2 );\r\nSellSig = ParamList( "Sell Signal", List2 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Overbought,Trend Level reached,Taio2 Direction change", 1 );\r\nBuyShape = Param( "Buy Shape Typ", def_BuyShape, 0, 50, 1 );\r\nSellShape = Param( "Sell Shape Typ", def_SellShape, 0, 50, 2 );\r\nBuyshapecolor = ParamColor( "Buy Shape Color", def_BuyShapeColor );\r\nSellshapecolor = ParamColor( "Sell Shape Color", def_SellShapeColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Short and Cover Signals" );\r\nShortSig = ParamList( "Short Signal", List1sig2 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Overbought,Trend Level reached,Taio2 Direction change", 7 );\r\nCoverSig = ParamList( "Cover Signal", List2sig2 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Oversold,Trend Level reached,Taio2 Direction change", 7 );\r\nShortShape = Param( "Short Shape Typ", def_ShortShape, 0, 50, 2 );\r\nCoverShape = Param( "Cover Shape Typ", def_CoverShape, 0, 50, 1 );\r\nShortshapecolor = ParamColor( "Short Shape Color", def_ShortShapeColor );\r\nCovershapecolor = ParamColor( "Cover Shape Color", def_CoverShapeColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f05.afl&gt;\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND\r\n      IIf( BuySignal == 0, Null,\r\n           IIf( BuySignal == 1, TpVa == -1,\r\n                IIf( BuySignal == 2, TpVa == 1,\r\n                     IIf( BuySignal == 3, ZLC == 1,\r\n                          IIf( BuySignal == 4, ZLB == 1,\r\n                               IIf( BuySignal == 5, Oversold == 1,\r\n                                    IIf( BuySignal == 6, UpperLevelreached == 1,\r\n                                         IIf( BuySignal == 7, Taio2upsig == 1, Null ) ) ) ) ) ) ) );\r\nSell = def_Sell AND\r\n       IIf( SellSignal == 0, Null,\r\n            IIf( SellSignal == 1, TpVa == -1,\r\n                 IIf( SellSignal == 2, TpVa == 1,\r\n                      IIf( SellSignal == 3, ZLC == -1,\r\n                           IIf( SellSignal == 4, ZLB == -1,\r\n                                IIf( SellSignal == 5, Overbought == -1,\r\n                                     IIf( SellSignal == 6, LowerLevelreached == -1,\r\n                                          IIf( SellSignal == 7, Taio2dnsig == 1, Null ) ) ) ) ) ) ) );\r\nShort = def_Short AND\r\n        IIf( ShortSignal == 0, Null,\r\n             IIf( ShortSignal == 1, TpVa == -1,\r\n                  IIf( ShortSignal == 2, TpVa == 1,\r\n                       IIf( ShortSignal == 3, ZLC == -1,\r\n                            IIf( ShortSignal == 4, ZLB == -1,\r\n                                 IIf( ShortSignal == 5, Overbought == 1,\r\n                                      IIf( ShortSignal == 6, LowerLevelreached == 1,\r\n                                           IIf( ShortSignal == 7, Taio2dnsig == 1, Null ) ) ) ) ) ) ) );\r\nCover = def_Cover AND\r\n        IIf( CoverSignal == 0, Null,\r\n             IIf( CoverSignal == 1, TpVa == -1,\r\n                  IIf( CoverSignal == 2, TpVa == 1,\r\n                       IIf( CoverSignal == 3, ZLC == 1,\r\n                            IIf( CoverSignal == 4, ZLB == 1,\r\n                                 IIf( CoverSignal == 5, Oversold == 1,\r\n                                      IIf( CoverSignal == 6, UpperLevelreached == 1,\r\n                                           IIf( CoverSignal == 7, Taio2upsig == 1, Null ) ) ) ) ) ) ) );\r\n\r\nif ( UseExrem )\r\n{\r\n    Buy = ExRem( Buy, Sell );\r\n    Sell = ExRem( Sell, Buy );\r\n    Short = ExRem( Short, Cover );\r\n    Cover = ExRem( Cover, Short );\r\n}\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( Buy OR Sell OR Short OR Cover );\r\n\r\n/*******************************************************************************************/\r\nAddAlert( Buy, Audio, Email, BuySig, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( Sell, Audio, Email, SellSig, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( Short, Audio, Email, ShortSig, 3, BarComplete, def_ShortSound1 );\r\n\r\nAddAlert( Cover, Audio, Email, CoverSig, 4, BarComplete, def_CoverSound1 );\r\n\r\n/*******************************************************************************************/\r\nif ( inAA )\r\n{\r\n    _SECTION_BEGIN( "Automatic Analysis - Exploration" );\r\n    Widecolumns = ParamToggle( "Wide columns", "No,Yes", 1 );\r\n    _SECTION_END();\r\n    /*******************************************************************************************/\r\n\r\n    if ( Widecolumns )\r\n    {\r\n        Addefaultcolumns();\r\n        AddColumn( Taio, "Taio", 1 );\r\n        AddColumn( Taio2, "Taio TF2", 1, 1, colorWhite, 60 );\r\n        AddColumn( TpVa, "Taio Top / Valley", 1, 1, IIf( TpVa == 1 OR TpVa == -1, colorLightBlue, colorWhite ), 100 );\r\n        AddColumn( ZLC, "Zero Line Cross", 1, 1, IIf( ZLCp, def_Color1, IIf( ZLCn, colorRed, colorWhite ) ), 90 );\r\n        AddColumn( ZLB, "Zero Line Bounce", 1, 1, IIf( ZLBp, def_Color1, IIf( ZLBn, colorRed, colorWhite ) ), 100 );\r\n        AddColumn( TrendLevelreached, "Trend Level reached", 1, 1, IIf( UpperLevelreached, def_Color1, IIf( LowerLevelreached, colorRed, colorWhite ) ), 120 );\r\n        AddColumn( OBOS, "Overbought/Oversold", 1, 1, IIf( Oversold, def_Color1, IIf( Overbought, colorRed, colorWhite ) ), 120 );\r\n        AddColumn( IIf( Taio &gt; TrendLevel, BarsSince( Cross( Taio, TrendLevel ) ), IIf( Taio &lt; -TrendLevel, BarsSince( Cross( -TrendLevel, Taio ) ), Null ) ), "Bars since Trendlevel reached", 1.0 );\r\n        AddTextColumn( FullName(), "Full name", 120 );\r\n    }\r\n    else\r\n    {\r\n        Addefaultcolumns();\r\n        Adddefaultcolumns( 2, 1 );\r\n        AddColumn( Taio, "Taio", 1 );\r\n        AddColumn( Taio2, "Taio TF2", 1, 1, colorWhite, 60 );\r\n        AddColumn( TpVa, "T/V", 1, 1, IIf( TpVa == 1 OR TpVa == -1, colorLightBlue, colorWhite ), 40 );\r\n        AddColumn( ZLC, "ZLC", 1, 1, IIf( ZLCp, def_Color1, IIf( ZLCn, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( ZLB, "ZLB", 1, 1, IIf( ZLBp, def_Color1, IIf( ZLBn, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( TrendLevelreached, "TLR", 1, 1, IIf( UpperLevelreached, def_Color1, IIf( LowerLevelreached, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( OBOS, "OB/OS", 1, 1, IIf( Oversold, def_Color1, IIf( Overbought, colorRed, colorWhite ) ), 60 );\r\n        AddColumn( IIf( Taio &gt; TrendLevel, BarsSince( Cross( Taio, TrendLevel ) ), IIf( Taio &lt; -TrendLevel, BarsSince( Cross( -TrendLevel, Taio ) ), Null ) ), "BSTR", 1.0 );\r\n        AddTextColumn( FullName(), "Full name" );\r\n    }\r\n}\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nPlotShapes( BuyShape*Buy, BuyShapecolor, 0, L, -def_BuyShapeOffset );\r\n\r\nPlotShapes( SellShape*Sell, SellShapecolor, 0, H, -def_SellShapeOffset );\r\n\r\nPlotShapes( ShortShape*Short, Shortshapecolor, 0, H, -def_ShortShapeOffset );\r\n\r\nPlotShapes( CoverShape*Cover, Covershapecolor, 0, L, -def_CoverShapeOffset );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\nTitle = "PatternExplorer.com - Price Chart TS" + default_priceTitle + " ";\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Price Chart TS 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
		<Pane>
			<ChartID>13</ChartID>
			<PercentHeight>12</PercentHeight>
			<Formula>_SECTION_BEGIN("AccDist");\r\nPlot( AccDist(), _DEFAULT_NAME(), ParamColor("Color", colorCycle ), ParamStyle("Style") );\r\n"(Interpretation is not available yet)";\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_Accumulation_Distribution.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741825</MoreFlags>
			<Min>-648598</Min>
			<Max>352286</Max>
		</Pane>
		<Pane>
			<ChartID>14</ChartID>
			<PercentHeight>12</PercentHeight>
			<Formula>_SECTION_BEGIN("Chaikin");\r\nr1 = Param( "Fast Avg", 9, 2, 200, 1 );\r\nr2 = Param( "Slow avg", 14, 2, 200, 1 );\r\nPlot( Chaikin(r1,r2), _DEFAULT_NAME(), ParamColor( "Color",  colorCycle ), ParamStyle("Style")  );\r\n\r\nif( Status("action") == actionCommentary )\r\n{\r\n printf("(Interpretation is not available yet)");\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_Chaikin.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741825</MoreFlags>
			<Min>-9362.55</Min>
			<Max>7621.47</Max>
		</Pane>
		<Pane>
			<ChartID>1017</ChartID>
			<PercentHeight>36</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Fibonacci Recognition\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Fibonacci Recognition";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nAddparamUsefromChart( def_UseFromChart );\r\nSensitivity = Param( "Sensitivity", 10, 0, 100, 1 );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "P0O3U2", Sensitivity );\r\n\r\nif ( inAA AND Usefromchart )\r\n    Sensitivity = StaticVarGet( "P0O3U2" );\r\n\r\nColorstyle = ParamToggle( "Color Mode", "S/R|Custom", 1 );\r\n\r\nColor_SL =  ParamColor( "Support (S/R Mode)", def_Color_SL );\r\n\r\nColor_RL =  ParamColor( "Resistance (S/R Mode)", def_Color_RL );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Levels" );\r\n\r\nLevel_1p = Param( "Level 1", 38.2, 0, 200, 1 );\r\n\r\nLevel_2p = Param( "Level 2", 50.0, 0, 200, 1 );\r\n\r\nLevel_3p = Param( "Level 3", 61.8, 0, 200, 1 );\r\n\r\nLevel_4p = Param( "Level 4", 138.2, 0, 200, 1 );\r\n\r\nLevel_5p = Param( "Level 5", 150, 0, 200, 1 );\r\n\r\nLevel_6p = Param( "Level 6", 161.8, 0, 200, 1 );\r\n\r\nLevel_7p = Param( "Level 7", 200, 0, 300, 1 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\n\r\nSwingLow_style = ParamStyle( "Swing Low", styleLine + styleDots, maskAll );\r\n\r\nSwingHigh_style = ParamStyle( "Swing High", styleLine + styleDots, maskAll );\r\n\r\nL1_style = ParamStyle( "Level 1", styleLine + styleDashed, maskAll );\r\n\r\nL2_style = ParamStyle( "Level 2", styleLine, maskAll );\r\n\r\nL3_style = ParamStyle( "Level 3", styleLine + styleDashed, maskAll );\r\n\r\nL4_style = ParamStyle( "Level 4", styleLine + styleDashed, maskAll );\r\n\r\nL5_style = ParamStyle( "Level 5", styleLine, maskAll );\r\n\r\nL6_style = ParamStyle( "Level 6", styleLine + styleDashed, maskAll );\r\n\r\nL7_style = ParamStyle( "Level 7", styleLine + styleThick + styleDots, maskAll );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\n\r\nSwingLow_color = ParamColor( "Swing Low", def_SwingLow_color );\r\n\r\nSwingHigh_color = ParamColor( "Swing High", def_SwingHigh_color );\r\n\r\nL1_color = ParamColor( "Level 1", def_L1_color );\r\n\r\nL2_color = ParamColor( "Level 2", def_L2_color );\r\n\r\nL3_color = ParamColor( "Level 3", def_L3_color );\r\n\r\nL4_color = ParamColor( "Level 4", def_L4_color );\r\n\r\nL5_color = ParamColor( "Level 5", def_L5_color );\r\n\r\nL6_color = ParamColor( "Level 6", def_L6_color );\r\n\r\nL7_color = ParamColor( "Level 7", def_L7_color );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Selection" );\r\n\r\nL1_switch = ParamToggle( "Plot Level 1", "Off|On", 1 );\r\n\r\nL2_switch = ParamToggle( "Plot Level 2", "Off|On", 1 );\r\n\r\nL3_switch = ParamToggle( "Plot Level 3", "Off|On", 1 );\r\n\r\nL4_switch = ParamToggle( "Plot Level 4", "Off|On", 1 );\r\n\r\nL5_switch = ParamToggle( "Plot Level 5", "Off|On", 1 );\r\n\r\nL6_switch = ParamToggle( "Plot Level 6", "Off|On", 1 );\r\n\r\nL7_switch = ParamToggle( "Plot Level 7", "Off|On", 1 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f10.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\n\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\n\r\nAddColumn( CurrentRT_EXT, "Current RT/EXT %" );\r\n\r\nAddColumn( MaxRT_EXT, "Current max. RT/EXT %" );\r\n\r\nAddTextColumn(\r\n    WriteIf( Sup_pricejustabove, "Price just above",\r\n             WriteIf( Sup_confirmed, "Confirmed",\r\n                      WriteIf( Sup_break, "Break", "" ) ) ), "Swing Low", 1.2,\r\n    IIf( Sup_pricejustabove OR sup_confirmed, colorGreen, colorRed ) );\r\n\r\nAddTextColumn(\r\n    WriteIf( Res_pricejustbelow, "Price just below",\r\n             WriteIf( Res_confirmed, "Confirmed",\r\n                      WriteIf( Res_break, "Break", "" ) ) ), "Swing High", 1.2,\r\n    IIf( Res_pricejustbelow OR Res_confirmed, colorRed, colorGreen ) );\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nPlot( IIf( x &gt;= xa &amp;NOT AnZ, ya, -1e10 ), "", SLcol, 1 + 8 + 2048 );\r\n\r\nPlot( IIf( x &gt;= xb &amp;NOT AnZ, yb, -1e10 ), "", SHcol, 1 + 8 + 2048 );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_1, -1e10 ), "", L1col, L1_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_2, -1e10 ), "", L2col, L2_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_3, -1e10 ), "", L3col, L3_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_4, -1e10 ), "", L4col, L4_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_5, -1e10 ), "", L5col, L5_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_6, -1e10 ), "", L6col, L6_style + styleNoRescale );\r\n\r\nPlot( IIf( x &gt;= xab &amp;NOT AnZ, Level_7, -1e10 ), "", L7col, L7_style + styleNoRescale );\r\n\r\nPlotText( WriteIf( L1_switch, "" + Level_1p + " %", "" ), LastValue( BarIndex() + 2 ), Level_1, L1col, colorDefault );\r\n\r\nPlotText( WriteIf( L2_switch, "" + Level_2p + " %", "" ), LastValue( BarIndex() + 2 ), Level_2, L2col, colorDefault );\r\n\r\nPlotText( WriteIf( L3_switch, "" + Level_3p + " %", "" ), LastValue( BarIndex() + 2 ), Level_3, L3col, colorDefault );\r\n\r\nPlotText( WriteIf( L4_switch, "" + Level_4p + " %", "" ), LastValue( BarIndex() + 2 ), Level_4, L4col, colorDefault );\r\n\r\nPlotText( WriteIf( L5_switch, "" + Level_5p + " %", "" ), LastValue( BarIndex() + 2 ), Level_5, L5col, colorDefault );\r\n\r\nPlotText( WriteIf( L6_switch, "" + Level_6p + " %", "" ), LastValue( BarIndex() + 2 ), Level_6, L6col, colorDefault );\r\n\r\nPlotText( WriteIf( L7_switch, "" + Level_7p + " %", "" ), LastValue( BarIndex() + 2 ), Level_7, L7col, colorDefault );\r\n\r\nPlotText( "100 %", LastValue( BarIndex() + 2 ), SwingLow, IIf( LastValue( up ), SwingLow_color, SwingHigh_color ), colorDefault );\r\n\r\nPlotText( "0 %", LastValue( BarIndex() + 2 ), Swinghigh, IIf( LastValue( dn ), SwingLow_color, SwingHigh_color ), colorDefault );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Fibonacci Recognition" + default_priceTitle + EncodeColor( IIf( NOT AnZ, def_Text2, colorRed ) ) + ", Sensitivity = " + WriteVal( Sensitivity, 1 ) + EncodeColor( colorRed ) + WriteIf( NOT AnZ, "", "  NO POINTS AVAILABLE -&gt; REDUCE SENSITIVITY" ) + EncodeColor( IIf( LastValue( L ) &gt; 0, Color_SL, Color_RL ) ) + ", Current Correction = " + WriteVal( CurrentRT_EXT, 1.0 ) + "%     ";\r\n\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Fibonacci Recognition 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE.Triangular-Volume</Name>
		<Pane>
			<ChartID>1014</ChartID>
			<PercentHeight>42</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Chart Pattern Recognition 1\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Chart Pattern Recognition 1";\r\n\r\nSetChartOptions( 0, chartShowDates | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\ndef_GraphXSpace = 10;\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Alerts" );\r\nSRbS = ParamToggle( "S/R broken", "Off,On", 1 );\r\nSRcS = ParamToggle( "S/R confirmed", "Off,On", 1 );\r\nPjabS = ParamToggle( "Price just above/below", "Off,On", 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nAddparamUsefromChart( def_UseFromChart );\r\nPatternPriceBasis = ParamToggle( "Pattern Price Basis", "Close|High &amp; Low", def_PatternPriceBasisCPR );\r\nSensitivity = Param( "Sensitivity", 15, 1, 100, 1 );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "UO3443", PatternPriceBasis );\r\n\r\nif ( inAA AND Usefromchart )\r\n    PatternPriceBasis = StaticVarGet( "UO3443" );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "D4Q5T6", Sensitivity );\r\n\r\nif ( inAA AND Usefromchart )\r\n    Sensitivity = StaticVarGet( "D4Q5T6" );\r\n\r\nPatternPriceBasis = ParamToggle( "Pattern Price Basis", "Close|High &amp; Low", def_PatternPriceBasisCPR );\r\n\r\nPlotP1P2 = ParamToggle( "Plot P1/P2 Shapes", "Off,On", def_Plot_P1P2_Shapes );\r\n\r\nP1Shape = Param( "P1 Shape Typ", 35, 0, 50, 1 );\r\n\r\nP2Shape = Param( "P2 Shape Typ", 37, 0, 50, 1 );\r\n\r\nParallellinesswitch = ParamToggle( "Plot Parallel Lines", "Off,On" );\r\n\r\nDisRange = Param( "Plot Parallel Lines Trigger", 3, 0.0, 10, 0.5 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\n\r\nStyle_SL = ParamStyle( "Support", styleLine + styleThick, maskDefault ) + styleNoRescale;\r\n\r\nStyle_RL = ParamStyle( "Resistance", styleLine + styleThick, maskDefault ) + styleNoRescale;\r\n\r\nStyle_PHL = ParamStyle( "Parallel Support", styleLine, maskDefault ) + styleNoRescale;\r\n\r\nStyle_PLL = ParamStyle( "Parallel Resistance", styleLine, maskDefault ) + styleNoRescale;\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\n\r\nColor_SL =  ParamColor( "Support", def_Color1 );\r\n\r\nColor_RL = ParamColor( "Resistance", colorRed );\r\n\r\nShadowcolor = ParamColor( "Shadow", def_Shadowcolor );\r\n\r\nColor_PLL = Color_RL; //ParamColor("Resistance",colorRed);\r\n\r\nColor_PHL = Color_SL; //ParamColor("Support",def_Color1);\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\nif ( inAA )\r\n{\r\n    _SECTION_BEGIN( "Pattern Selection" );\r\n    AscTs = ParamToggle( "Ascending Triangle", "Off,On", 1 );\r\n    DscTs = ParamToggle( "Descending Triangle", "Off,On", 1 );\r\n    STs = ParamToggle( "Symmetrically Triangle", "Off,On", 1 );\r\n    ETs = ParamToggle( "Expanding Triangle", "Off,On", 1 );\r\n    RWs = ParamToggle( "Rising Wedge", "Off,On", 1 );\r\n    FWs = ParamToggle( "Falling Wedge", "Off,On", 1 );\r\n    UTs = ParamToggle( "Up Trend", "Off,On", 1 );\r\n    DTs = ParamToggle( "Down Trend", "Off,On", 1 );\r\n    Rectangles = ParamToggle( "Rectangle", "Off,On", 1 );\r\n    NonDefinedPatterns = ParamToggle( "Not defined Patterns", "Off,On", 0 );\r\n    _SECTION_END();\r\n}\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f06.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nGraphZOrder = 0;\r\n\r\nPlot( TRS, "  SL" , Color_SL, Style_SL + styleNoTitle );\r\n\r\nPlot( TRR, "  RL" , Color_RL, Style_RL + styleNoTitle );\r\n\r\nPlotOHLC( Null, TRR, TRS, Null, "", Shadowcolor, styleCloud + styleNoLabel );\r\n\r\nPlot( IIf( Parallellinesswitch, PLL_plot, -1e10 ), "  PLL", Color_PLL, Style_PLL + styleNoTitle );\r\n\r\nPlot( IIf( Parallellinesswitch, PHL_plot, -1e10 ), "  PHL", Color_PHL, Style_PHL + styleNoTitle );\r\n\r\n/*******************************************************************************************/\r\nPlotShapes( IIf( BS &amp; x &gt; LastValue( x ) - 3, def_BuyShape, shapeNone ), def_BuyShapeColor, 0, Low, -def_BuyShapeOffset );\r\n\r\nPlotShapes( IIf( SS &amp; x &gt; LastValue( x ) - 3, def_SellShape, shapeNone ), def_SellShapeColor, 0, High, -def_SellShapeOffset );\r\n\r\nif ( PlotP1P2 )\r\n{\r\n    PlotShapes( IIf( x == xa &amp; NOT AnZ, P1Shape, shapeNone ), Color_SL, 0, SL, -13 );\r\n    PlotShapes( IIf( x == xb &amp; NOT AnZ, P2Shape, shapeNone ), Color_SL, 0, SL, -13 );\r\n    PlotShapes( IIf( x == xc &amp; NOT AnZ, P1Shape, shapeNone ), Color_RL, 0, H, 13 );\r\n    PlotShapes( IIf( x == xd &amp; NOT AnZ, P2Shape, shapeNone ), Color_RL, 0, H, 13 );\r\n}\r\n\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND BS;\r\n\r\nSell = def_Sell AND SS;\r\n\r\n/*******************************************************************************************/\r\nif ( inAA )\r\n{\r\n    CPRFilter =\r\n        ( AscT AND AscTs ) | ( DscT AND DscTs ) | ( ST AND STs ) |\r\n        ( ET AND ETs ) | ( RW AND RWs ) | ( FW AND FWs ) |\r\n        ( UT AND UTs ) | ( DT AND DTs ) | ( Rectangle AND Rectangles ) |\r\n        ( SupSignals AND NonDefinedPatterns AND NOT DefinedPatterns ) |\r\n        ( ResSignals AND NonDefinedPatterns AND NOT DefinedPatterns );\r\n    Filter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\n    Filter = Filter AND CPRFilter;\r\n    /*******************************************************************************************/\r\n    Addefaultcolumns();\r\n    Adddefaultcolumns( 2, 1 );\r\n    AddTextColumn( WriteIf( Sup_pricejustabove, "Price just above",\r\n                            WriteIf( Sup_confirmed, "Confirmed",\r\n                                     WriteIf( Sup_break, "Break", "" ) ) ), "Support Line", 1.2, IIf( Sup_pricejustabove OR sup_confirmed, colorGreen, colorRed ) );\r\n    AddTextColumn(\r\n        WriteIf( Res_pricejustbelow, "Price just below", WriteIf( Res_confirmed, "confirmed",\r\n                 WriteIf( Res_break, "Break", "" ) ) ), "Resistance Line", 1.2, IIf( Res_pricejustbelow OR Res_confirmed, colorRed, colorGreen ) );\r\n    /*******************************************************************************************/\r\n    patterncolor =\r\n        IIf( AscT | FW | UT, colorGreen,\r\n             IIf( DscT | RW | DT, colorRed,\r\n                  IIf( ST | ET | Rectangle, colorBlue, colorBlack ) ) );\r\n    AddTextColumn( PatternText, "Pattern", 0, patterncolor );\r\n    AddTextColumn( FullName(), "Full name" );\r\n}\r\n\r\n/*******************************************************************************************/\r\n/*\r\nAddTextColumn(\r\nWriteIf(PLL_pricejustabove,"price just above",\r\nWriteIf(PLL_confirmed,"confirmed",\r\nWriteIf(PLL_break,"break",""))),"Parallel support line");\r\n\r\nAddTextColumn(\r\nWriteIf(PHL_pricejustbelow,"price just below",\r\nWriteIf(PHL_confirmed,"confirmed",\r\nWriteIf(PHL_break,"break",""))),"Parallel resistance line");\r\n*/\r\n/*******************************************************************************************/\r\nif ( SRbS )\r\n{\r\n    AddAlert( Res_break, Audio, Email, "Resistance broken", 1, BarComplete, def_BuySound1 );\r\n    AddAlert( Sup_break, Audio, Email, "Support broken", 2, BarComplete, def_SellSound1 );\r\n}\r\n\r\nif ( SRcS )\r\n{\r\n    AddAlert( Sup_confirmed, Audio, Email, "Support confirmed", 1, BarComplete, def_BuySound2 );\r\n    AddAlert( Res_confirmed, Audio, Email, "Resistance confirmed", 2, BarComplete, def_SellSound2 );\r\n}\r\n\r\nif ( PjabS )\r\n{\r\n    AddAlert( Sup_pricejustabove AND PatternDirection == 1, Audio, Email, "Price just above Support", 1, BarComplete, def_BuySound3 );\r\n    AddAlert( Res_pricejustbelow AND PatternDirection == -1, Audio, Email, "Price just below Resistance", 2, BarComplete, def_SellSound3 );\r\n    AddAlert( Sup_pricejustabove AND PatternDirection == 0, Audio, Email, "Price just above Support", 5, BarComplete, def_BuySound3 );\r\n    AddAlert( Res_pricejustbelow AND PatternDirection == 0, Audio, Email, "Price just below Resistance", 5, BarComplete, def_SellSound3 );\r\n}\r\n\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Chart Pattern Recognition 1 "\r\n        + default_priceTitle + ", " + EncodeColor( def_Text3 ) + "Pattern: " + PatternText\r\n        + EncodeColor( IIf( NOT AnZ, def_Text2, colorRed ) ) + ", Sensitivity = " + WriteVal( Sensitivity, 1 ) + " " + EncodeColor( colorRed ) + WriteIf( NOT AnZ, "", " NO POINTS AVAILABLE -&gt; REDUCE SENSITIVITY " );\r\n\r\n/*******************************************************************************************/\r\nST = LastValue( ST );\r\n\r\nAscT = LastValue( AscT );\r\n\r\nDscT = LastValue( DscT );\r\n\r\nET = LastValue( ET );\r\n\r\nRW = LastValue( RW );\r\n\r\nFW = LastValue( FW );\r\n\r\nUT = LastValue( UT );\r\n\r\nParamToggle( "Up Trend", "Off,On", 1 );\r\n\r\nDT = LastValue( DT );\r\n\r\nParamToggle( "Down Trend", "Off,On", 1 );\r\n\r\nRectangles = LastValue( Rectangle );\r\n\r\nParamToggle( "Rectangle", "Off,On", 1 );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\nif ( ST )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Symmetrical Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( AscT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Ascending Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( DscT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Descending Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( ET )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Expanding Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( RW )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Rising Wedge" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( FW )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Falling Wedge" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( UT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Up Channel" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( DT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Down Channel" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( Rectangles )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Rectangle" + "\\n" +\r\n              " ";\r\n}\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Chart Pattern Recognition 1 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>415.747</Min>
			<Max>1015.77</Max>
		</Pane>
		<Pane>
			<ChartID>1018</ChartID>
			<PercentHeight>14</PercentHeight>
			<Formula>_SECTION_BEGIN("Volume");\r\nPlot( Volume, _DEFAULT_NAME(), IIf( C &gt; O, ParamColor("Up Color", colorGreen ), ParamColor("Down Color", colorRed ) ), ParamStyle( "Style", styleHistogram | styleThick, maskHistogram  ) );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Volume (color) 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-8101</Min>
			<Max>425789</Max>
		</Pane>
		<Pane>
			<ChartID>1015</ChartID>
			<PercentHeight>43</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Chart Pattern Recognition - 2\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Chart Pattern Recognition 2";\r\n\r\nSetChartOptions( 0, chartShowDates | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\ndef_GraphXSpace = 10;\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Alerts" );\r\nSRbS = ParamToggle( "S/R broken", "Off,On", 1 );\r\nSRcS = ParamToggle( "S/R confirmed", "Off,On", 1 );\r\nPjabS = ParamToggle( "Price just above/below", "Off,On", 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Sensitivity" );\r\nAddparamUsefromChart2( def_UseFromChart );\r\nPatternPriceBasis = ParamToggle( "Pattern Price Basis", "Close|High &amp; Low", def_PatternPriceBasisCPR );\r\nBars = Param( "Bars", 5, 2, 20, 1 );\r\nMinVertSize = Param( "Minimum Vertical Size (*ATR)", 0, 0, 5.01, 0.05 );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "Re3442", PatternPriceBasis );\r\n\r\nif ( inAA AND Usefromchart )\r\n    PatternPriceBasis = StaticVarGet( "Re3442" );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "P56947", Bars );\r\n\r\nif ( inAA AND Usefromchart )\r\n    Bars = StaticVarGet( "P56947" );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "Adr897", MinVertSize );\r\n\r\nif ( inAA AND Usefromchart )\r\n    MinVertSize = StaticVarGet( "Adr897" );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_END();\r\n\r\nPlotP1P2 = ParamToggle( "Plot P1/P2 Shapes", "Off,On", def_Plot_P1P2_Shapes );\r\n\r\nP1Shape = Param( "P1 Shape Typ", 35, 0, 50, 1 );//default 35\r\n\r\nP2Shape = Param( "P2 Shape Typ", 37, 0, 50, 1 );//default 37\r\n\r\nParallellinesswitch = ParamToggle( "Plot Parallel Lines", "Off,On" );\r\n\r\nDisRange = Param( "Plot Parallel Lines Trigger", 3, 0.0, 10, 0.5 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\n\r\nStyle_SL = ParamStyle( "Support", styleLine + styleThick, maskDefault ) + styleNoRescale;\r\n\r\nStyle_RL = ParamStyle( "Resistance", styleLine + styleThick, maskDefault ) + styleNoRescale;\r\n\r\nStyle_PHL = ParamStyle( "Parallel Support", styleLine, maskDefault ) + styleNoRescale;\r\n\r\nStyle_PLL = ParamStyle( "Parallel Resistance", styleLine, maskDefault ) + styleNoRescale;\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\n\r\nColor_SL =  ParamColor( "Support", def_Color1 );\r\n\r\nColor_RL = ParamColor( "Resistance", colorRed );\r\n\r\nShadowcolor = ParamColor( "Shadow", def_Shadowcolor );\r\n\r\nColor_PLL = Color_RL; //ParamColor("Resistance",colorRed);\r\n\r\nColor_PHL = Color_SL; //ParamColor("Support",def_Color1);\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\nif ( inAA )\r\n{\r\n    _SECTION_BEGIN( "Pattern Selection" );\r\n    AscTs = ParamToggle( "Ascending Triangle", "Off,On", 1 );\r\n    DscTs = ParamToggle( "Descending Triangle", "Off,On", 1 );\r\n    STs = ParamToggle( "Symmetrically Triangle", "Off,On", 1 );\r\n    ETs = ParamToggle( "Expanding Triangle", "Off,On", 1 );\r\n    RWs = ParamToggle( "Rising Wedge", "Off,On", 1 );\r\n    FWs = ParamToggle( "Falling Wedge", "Off,On", 1 );\r\n    UTs = ParamToggle( "Up Trend", "Off,On", 1 );\r\n    DTs = ParamToggle( "Down Trend", "Off,On", 1 );\r\n    Rectangles = ParamToggle( "Rectangle", "Off,On", 1 );\r\n    NonDefinedPatterns = ParamToggle( "Not defined Patterns", "Off,On", 1 );\r\n    _SECTION_END();\r\n}\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f07.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nGraphZOrder = 0;\r\n\r\nPlot( TRS, "  SL" , Color_SL, Style_SL + styleNoTitle );\r\n\r\nPlot( TRR, "  RL" , Color_RL, Style_RL + styleNoTitle );\r\n\r\nPlotOHLC( Null, TRR, TRS, Null, "", Shadowcolor, styleCloud + styleNoLabel );\r\n\r\nPlot( IIf( Parallellinesswitch, PLL_plot, -1e10 ), "  PLL", Color_PLL, Style_PLL + styleNoTitle );\r\n\r\nPlot( IIf( Parallellinesswitch, PHL_plot, -1e10 ), "  PHL", Color_PHL, Style_PHL + styleNoTitle );\r\n\r\nPlotShapes( IIf( BS &amp; x &gt; LastValue( x ) - 3, def_BuyShape, shapeNone ), def_BuyShapeColor, 0, Low, -def_BuyShapeOffset );\r\n\r\nPlotShapes( IIf( SS &amp; x &gt; LastValue( x ) - 3, def_SellShape, shapeNone ), def_SellShapeColor, 0, High, -def_SellShapeOffset );\r\n\r\nif ( PlotP1P2 )\r\n{\r\n    PlotShapes( IIf( x == xa &amp; NOT AnZ, P1Shape, shapeNone ), Color_SL, 0, SL, -13 );\r\n    PlotShapes( IIf( x == xb &amp; NOT AnZ, P2Shape, shapeNone ), Color_SL, 0, SL, -13 );\r\n    PlotShapes( IIf( x == xc &amp; NOT AnZ, P1Shape, shapeNone ), Color_RL, 0, H, 13 );\r\n    PlotShapes( IIf( x == xd &amp; NOT AnZ, P2Shape, shapeNone ), Color_RL, 0, H, 13 );\r\n}\r\n\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND BS;\r\n\r\nSell = def_Sell AND SS;\r\n\r\n/*******************************************************************************************/\r\nif ( inAA )\r\n{\r\n    CPRFilter =\r\n        ( AscT AND AscTs ) | ( DscT AND DscTs ) | ( ST AND STs ) |\r\n        ( ET AND ETs ) | ( RW AND RWs ) | ( FW AND FWs ) |\r\n        ( UT AND UTs ) | ( DT AND DTs ) | ( Rectangle AND Rectangles ) |\r\n        ( SupSignals AND NonDefinedPatterns AND NOT DefinedPatterns ) |\r\n        ( ResSignals AND NonDefinedPatterns AND NOT DefinedPatterns );\r\n    Filter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\n    Filter = Filter AND CPRFilter;\r\n    /*******************************************************************************************/\r\n    Addefaultcolumns();\r\n    Adddefaultcolumns( 2, 1 );\r\n    AddTextColumn(\r\n        WriteIf( Sup_pricejustabove, "Price just above",\r\n                 WriteIf( Sup_confirmed, "Confirmed",\r\n                          WriteIf( Sup_break, "Break", "" ) ) ), "Support Line", 1.2,\r\n        IIf( Sup_pricejustabove OR sup_confirmed, colorGreen, colorRed ) );\r\n    AddTextColumn(\r\n        WriteIf( Res_pricejustbelow, "Price just below",\r\n                 WriteIf( Res_confirmed, "Confirmed",\r\n                          WriteIf( Res_break, "Break", "" ) ) ), "Resistance Line", 1.2,\r\n        IIf( Res_pricejustbelow OR Res_confirmed, colorRed, colorGreen ) );\r\n    /*******************************************************************************************/\r\n    patterncolor =\r\n        IIf( AscT | FW | UT, colorGreen,\r\n             IIf( DscT | RW | DT, colorRed,\r\n                  IIf( ST | ET | Rectangle, colorBlue, colorBlack ) ) );\r\n    AddTextColumn( PatternText, "Pattern", 0, patterncolor );\r\n    AddTextColumn( FullName(), "Full name" );\r\n}\r\n\r\n/*******************************************************************************************/\r\n/*\r\nAddTextColumn(\r\nWriteIf(PLL_pricejustabove,"price just above",\r\nWriteIf(PLL_confirmed,"confirmed",\r\nWriteIf(PLL_break,"break",""))),"Parallel support line");\r\n\r\nAddTextColumn(\r\nWriteIf(PHL_pricejustbelow,"price just below",\r\nWriteIf(PHL_confirmed,"confirmed",\r\nWriteIf(PHL_break,"break",""))),"Parallel resistance line");\r\n*/\r\n/*******************************************************************************************/\r\nif ( SRbS )\r\n{\r\n    AddAlert( Res_break, Audio, Email, "Resistance broken", 1, BarComplete, def_BuySound1 );\r\n    AddAlert( Sup_break, Audio, Email, "Support broken", 2, BarComplete, def_SellSound1 );\r\n}\r\n\r\nif ( SRcS )\r\n{\r\n    AddAlert( Sup_confirmed, Audio, Email, "Support confirmed", 1, BarComplete, def_BuySound2 );\r\n    AddAlert( Res_confirmed, Audio, Email, "Resistance confirmed", 2, BarComplete, def_SellSound2 );\r\n}\r\n\r\nif ( PjabS )\r\n{\r\n    AddAlert( Sup_pricejustabove AND PatternDirection == 1, Audio, Email, "Price just above Support", 1, BarComplete, def_BuySound3 );\r\n    AddAlert( Res_pricejustbelow AND PatternDirection == -1, Audio, Email, "Price just below Resistance", 2, BarComplete, def_SellSound3 );\r\n    AddAlert( Sup_pricejustabove AND PatternDirection == 0, Audio, Email, "Price just above Support", 5, BarComplete, def_BuySound3 );\r\n    AddAlert( Res_pricejustbelow AND PatternDirection == 0, Audio, Email, "Price just below Resistance", 5, BarComplete, def_SellSound3 );\r\n}\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Chart Pattern Recognition 2" + default_priceTitle + ", " + EncodeColor( def_Text3 ) +\r\n        "Pattern: " + PatternText + " "\r\n        + EncodeColor( IIf( NOT AnZ, def_Text2, colorRed ) ) + ", Bars = " + WriteVal( Bars, 1 ) + ", Min.Vertical Size (*ATR) = " + WriteVal( MinVertSize, 1.2 ) + " " + EncodeColor( colorRed ) + WriteIf( NOT AnZ, "", " NO POINTS AVAILABLE -&gt; REDUCE BARS/MIN.VERTICAL SIZE " );\r\n\r\n/*******************************************************************************************/\r\nST = LastValue( ST );\r\n\r\nAscT = LastValue( AscT );\r\n\r\nDscT = LastValue( DscT );\r\n\r\nET = LastValue( ET );\r\n\r\nRW = LastValue( RW );\r\n\r\nFW = LastValue( FW );\r\n\r\nUT = LastValue( UT );\r\n\r\nParamToggle( "Up Trend", "Off,On", 1 );\r\n\r\nDT = LastValue( DT );\r\n\r\nParamToggle( "Down Trend", "Off,On", 1 );\r\n\r\nRectangles = LastValue( Rectangle );\r\n\r\nParamToggle( "Rectangle", "Off,On", 1 );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\nif ( ST )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Symmetrical Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( AscT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Ascending Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( DscT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Descending Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( ET )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Expanding Triangle" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( RW )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Rising Wedge" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( FW )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Falling Wedge" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( UT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Up Channel" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( DT )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Down Channel" + "\\n" +\r\n              " ";\r\n}\r\n\r\nif ( Rectangles )\r\n{\r\n    ToolTip = ToolTip +\r\n              "\\n\\n" +\r\n              "Current Pattern = Rectangle" + "\\n" +\r\n              " ";\r\n}\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Chart Pattern Recognition 2 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741847</MoreFlags>
			<Min>418.954</Min>
			<Max>1090.55</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE-Indicators</Name>
		<Pane>
			<ChartID>1073</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Heikin Ashi Indicator (HaDiffCO indicator)\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Heikin Ashi Diffco";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle, chartGridmiddle == 0 );\r\nGraphXSpace = 10;\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nper = Param( "Average Period", 3, 3, 50, 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\nHAstyle = ParamStyle( "Ha Diffco", styleThick );\r\nHADiffcostyle = ParamStyle( "Average HA Diffco", styleThick );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\ncolorHA = ParamColor( "HA Diffco", def_colorHeikinAshi );\r\ncolorMA = ParamColor( "Average HA Diffco", def_colorHeikinAshiDiffco );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n/*******************************************************************************************/\r\nHaClose = ( O + H + L + C ) / 4;\r\nHaOpen = AMA( Ref( HaClose, -1 ), 0.5 );\r\nHaHigh = Max( H, Max( HaClose, HaOpen ) );\r\nHaLow = Min( L, Min( HaClose, HaOpen ) );\r\nHaDiffCO = HaClose - HaOpen;\r\n/*******************************************************************************************/\r\nPlot( HaDiffCo, "HaDiffCO", colorHA, HAstyle );\r\nPlot( MA( HaDiffCo, per ), "MA(" + per + ")", colorMA, HADiffcostyle );\r\nPlotGrid( 0, colorDefault );\r\n/*******************************************************************************************/\r\nFilter = def_Filter;\r\nAddColumn( HaDiffco, "HaDiffco" );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Heikin Ashi Diffco" + " - " +  Name() + " - " + EncodeColor( colorRed ) + Interval( 2 ) + EncodeColor() + "  - " + Date() + " - " + EncodeColor( ColorHA ) + "HaDiffCO = " + WriteVal( HaDiffCO, 1.2 ) + ", " + EncodeColor( ColorMA ) + "MA = " + WriteVal( MA( HaDiffCo, per ), 1.2 ) + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Heikin Ashi Diffco 2.afl</FilePath>
			<Flags>0</Flags>
			<MoreFlags>1073741843</MoreFlags>
			<Min>-216.704</Min>
			<Max>96.1173</Max>
		</Pane>
		<Pane>
			<ChartID>1074</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - MACD - modified\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - MACD Modified";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle, chartGridMiddle = 0 );\r\nGraphXSpace = 10;\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Alerts" );\r\nBuySig = ParamList( "Buy Signal", List1 = "MACD crosses Signal,MACD crosses zero Level", 0 );\r\nSellSig = ParamList( "Sell Signal", List2 = "Signal crosses MACD,MACD crosses zero Level", 0 );\r\n\r\nfor ( i = 0; i &lt; 10; i++ )\r\n{\r\n    if ( StrExtract( List1, i ) == BuySig )\r\n        BuySignal = i + 1;\r\n}\r\n\r\nfor ( i = 0; i &lt; 10; i++ )\r\n{\r\n    if ( StrExtract( List2, i ) == SellSig )\r\n        SellSignal = i + 1;\r\n}\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nAddAvgTypeParam( 1 );\r\nr1 = Param( "Fast Average", 6, 2, 100, 1 );\r\nr2 = Param( "Slow Average", 13, 2, 100, 1 );\r\nr3 = Param( "Signal Average", 5, 2, 100, 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\nMACDstyle = ParamStyle( "MACD", styleThick );\r\nSignalstyle = ParamStyle( "Signal", styleThick );\r\nHistostyle = ParamStyle( "Histogram", styleHistogram, maskAll );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\nMACDcolor = ParamColor( "MACD", def_MACDcolor );\r\nSignalcolor = ParamColor( "Signal", def_Signalcolor );\r\nHistocolor = ParamColor( "Histogram", def_Histocolor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nMACD_mod = Average( C, r1, AvgType ) - Average( C, r2, AvgType );\r\nMACDsignal_mod = Average( MACD_mod, r3, AvgType );\r\nMACDHistogram_mod = MACD_mod - MACDsignal_mod;\r\n/*******************************************************************************************/\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n/*******************************************************************************************/\r\nPlot( MACD_mod, StrFormat( _SECTION_NAME() + "(%g,%g)", r1, r2 ), MACDcolor, MACDstyle );\r\nPlot( MACDsignal_mod, "Signal" + _PARAM_VALUES(), Signalcolor, Signalstyle );\r\nPlot( MACDHistogram_mod, "MACD Histogram", Histocolor, Histostyle );\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND IIf( BuySignal == 1, Cross( MACD_mod, MACDsignal_mod ), Cross( MACD_mod, 0 ) );\r\nSell = def_Sell AND IIf( SellSignal == 1, Cross( MACDsignal_mod, MACD_mod ), Cross( 0, MACD_mod ) );\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nFilter = Filter AND ( Buy OR Sell );\r\nAddefaultcolumns();\r\nAdddefaultcolumns( 2, 1 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\nAlerttext =\r\n    "\\n, MACD =   " + WriteVal( MACD_mod ) + ", "\r\n    + "\\n, Signal =   " + WriteVal( MACDSignal_mod );\r\nAddAlert( Buy, Audio, Email, BuySig + Alerttext, 1, BarComplete, def_BuySound1 );\r\nAddAlert( Sell, Audio, Email, SellSig + Alerttext, 2, BarComplete, def_SellSound1 );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - MACD Modified " + AvgText + " - " +  Name() + " - " + EncodeColor( colorRed ) + Interval( 2 ) + EncodeColor() + " " + Date() + ", " + EncodeColor( colorRed ) + "MACD("\r\n        + WriteVal( r1, 1.0 ) + "," + WriteVal( r2, 1.0 ) + ") = "\r\n        + WriteVal( MACD_mod, 1.2 ) + "," + EncodeColor( Signalcolor ) + " Signal(" + WriteVal( r1, 1.0 ) + ","\r\n        + WriteVal( r2, 1.0 ) + "," + WriteVal( r3, 1.0 ) + ") = " + WriteVal( MACDSignal_mod, 1.2 ) + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - MACD Modified 2.afl</FilePath>
			<Flags>704</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>-101.361</Min>
			<Max>76.6198</Max>
		</Pane>
		<Pane>
			<ChartID>1075</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Schaff Trend Cycle indicator\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Schaff Trend Cycle";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle, Chartgridmiddle == 0 );\r\nGraphXSpace = 10;\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Build-In Average" );\r\nAddAvgTypeParam( 3 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "First Time Frame" );\r\nTC = Param( "TC Period", 10, 1, 100, 1 );\r\nMA1 = Param( "MA1 Period", 23, 5, 50, 1 );\r\nMA2 = Param( "MA2 Period", 50, 20, 200, 1 );\r\nLowerLevel1 = Param( "Lower level", 25, 5, 35, 1 );\r\nUpperLevel1 = Param( "Upper level", 75, 65, 95, 1 );\r\nSTCstyle = ParamStyle( "Style", styleLine | styleThick, maskDefault );\r\nColor = ParamColor( "Color", def_STCcolor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Second Time Frame" );\r\nTF = Param( "TF-Multiplier", 4, 0, 24, 1 );\r\nSTC2expandMode = ParamToggle( "STC TF2 Expand Mode", "Expand First|Expand Last", 1 );\r\nTC_TF2 = Param( "TC Period", 10, 1, 100, 1 );\r\nMA1_TF2 = Param( "MA1 Period", 23, 5, 50, 1 );\r\nMA2_TF2 = Param( "MA2 Period", 50, 20, 200, 1 );\r\nLowerLevel2 = Param( "Lower level", 25, 5, 35, 1 );\r\nUpperLevel2 = Param( "Upper level", 75, 65, 95, 1 );\r\nSTCstyle = ParamStyle( "Style", styleLine | styleThick, maskDefault );\r\nColor2 = ParamColor( "Color", def_STC_TF2color );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f11.afl&gt;\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND STC_TF2 &gt; UpperLevel2 AND STC_TF2 &gt;= Ref( STC_TF2, -1 ) AND STCValley;\r\nSell = def_Sell AND STC_TF2 &lt; LowerLevel2 AND STC_TF2 &lt;= Ref( STC_TF2, -1 ) AND STCTop;\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nFilter = Filter AND ( WB | WS | SB | SS | WB_TF2 | WS_TF2 | SB_TF2 | SS_TF2 );\r\n/*******************************************************************************************/\r\nBC = colorDefault;\r\nAddefaultcolumns();\r\nAdddefaultcolumns( 2, 1 );\r\nAddColumn( IIf( WB, 66, IIf( WS, 83, Null ) ), "Weak Signal", formatChar, TC, BC, 80 );\r\nAddColumn( IIf( SB, 66, IIf( SS, 83, Null ) ), "Strong Signal", formatChar, TC, BC, 80 );\r\nAddColumn( IIf( WB_TF2, 66, IIf( WS_TF2, 83, Null ) ), "TF2 Weak Signal", formatChar, TC, BC, 100 );\r\nAddColumn( IIf( SB_TF2, 66, IIf( SS_TF2, 83, Null ) ), "TF2 Strong Signal", formatChar, TC, BC, 100 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\nPlot( STC1, "STC", Color, STCstyle );\r\nPlot( STC_TF2, "STC TF2", Color2, STCstyle );\r\nPlotGrid( LowerLevel1, colorDefault );\r\nPlotGrid( UpperLevel1, colorDefault );\r\nPlotGrid( LowerLevel2, colorDefault );\r\nPlotGrid( UpperLevel2, colorDefault );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle =\r\n    "PatternExplorer.com - Schaff Trend Cycle" + " - " +  Name() + " - " +\r\n    EncodeColor( colorRed ) + Interval( 2 ) + EncodeColor() + "  - " + Date() + " - " + EncodeColor( Color ) +\r\n    "STC = " + WriteVal( STC1, 1.2 ) + ", " + EncodeColor( color2 ) + "STC 2nd time frame = " + WriteVal( STC_TF2, 1.2 );\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Schaff Trend Cycle 2.afl</FilePath>
			<Flags>0</Flags>
			<MoreFlags>1073741843</MoreFlags>
			<Min>-9.99967</Min>
			<Max>113.597</Max>
		</Pane>
		<Pane>
			<ChartID>1076</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - TAIO indicator\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - TAIO Indicator";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle, chartGridMiddle == 0 );\r\nGraphXSpace = 10;\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Alerts" );\r\nBuySig = ParamList( "Buy Signal", List1 = "Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Oversold,Trend Level reached,Taio2 direction change", 1 );\r\nSellSig = ParamList( "Sell Signal", List2 = "Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Overbought,Trend Level reached,Taio2 direction change", 0 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Indicator Periods" );\r\nperiod1 = Param( "Period 1", def_TaioPeriod1, 1, 30, 1 );\r\nperiod2 = Param( "Period 2", def_TaioPeriod2, 1, 30, 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "First Time Frame" );\r\nTAIO_switchvalue = ParamList( "Color Mode", List = "1 - Rising/Falling/Range,2 - Range/Trend,3 - Rising/Falling,4 - Zero based,5 - Single Color", def_TaioModeInd - 1 );\r\nLevel = Param( "Trend Level", def_TrendLevel, 0, 90 );\r\nShadows_switch = ParamToggle( "Plot Shadows", "Off|On", 0 );\r\nRibbons_switch = ParamToggle( "Plot Ribbons", "On|Off", 1 );\r\nRibbonsheight = Param( "Height", 5, 1, 100, 1 );\r\nStyle1 = ParamStyle( "Style", styleHistogram + styleThick, maskAll );\r\nup_color1 = ParamColor( "Taio &gt; Trend Level", def_TAIO_up_color );\r\ndn_color1 = ParamColor( "Taio &lt; Trend Level", def_TAIO_dn_color );\r\nRangeP_color1 = ParamColor( "Range (&gt;0)", def_TaioRangeP_color );\r\nRangeN_color1 = ParamColor( "Range (&lt;0)", def_TaioRangeN_color );\r\nSinglecolor1 = ParamColor( "Single Color", colorLightBlue );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Second Time Frame" );\r\nSecondTF2 = ParamToggle( "Plot Indicator", "Off|On", def_SecondTF2Switch );\r\nMultiplier = Param( "Multiplier", def_Taio2TFMultiplier, 1, 30, 1 );\r\nTaio2expandMode = ParamToggle( "Taio TF2 Expand Mode", "Expand First|Expand Last", 1 );\r\nSecondTFstyle = ParamStyle( "Style", styleLine + styleThick + styleDots, maskAll );\r\nColor_Mode2 = ParamToggle( "Color Mode", "1 - Rising/Falling|2 - Above/Below Zero", 0 );\r\nup_Color2 = ParamColor( "Up Color", def_TaioTF2Up_Color );\r\ndn_Color2 = ParamColor( "Dn Color", def_TaioTF2Dn_Color );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f12.afl&gt;\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND\r\n      IIf( BuySignal == 0, TpVa == -1,\r\n           IIf( BuySignal == 1, TpVa == 1,\r\n                IIf( BuySignal == 2, ZLC == 1,\r\n                     IIf( BuySignal == 3, ZLB == 1,\r\n                          IIf( BuySignal == 4, Oversold == 1,\r\n                               IIf( BuySignal == 5, UpperLevelreached == 1,\r\n                                    IIf( BuySignal == 6, Taio2upsig == 1, Null ) ) ) ) ) ) );\r\nSell = def_Sell AND\r\n       IIf( SellSignal == 0, TpVa == -1,\r\n            IIf( SellSignal == 1, TpVa == 1,\r\n                 IIf( SellSignal == 2, ZLC == -1,\r\n                      IIf( SellSignal == 3, ZLB == -1,\r\n                           IIf( SellSignal == 4, Overbought == -1,\r\n                                IIf( SellSignal == 5, LowerLevelreached == -1,\r\n                                     IIf( SellSignal == 6, Taio2dnsig == 1, Null ) ) ) ) ) ) );\r\n/*******************************************************************************************/\r\nAlerttext =\r\n    "\\nTaio =   " + WriteVal( Taio ) + ", "\r\n    + "\\nTaio 2nd Time Frame =   " + WriteVal( Taio2 );\r\nAddAlert( Buy, Audio, Email, BuySig + Alerttext, 1, BarComplete, def_BuySound1 );\r\nAddAlert( Sell, Audio, Email, SellSig + Alerttext, 2, BarComplete, def_SellSound1 );\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\n/*******************************************************************************************/\r\n\r\nif ( inAA )\r\n{\r\n    if ( Widecolumns )\r\n    {\r\n        Addefaultcolumns();\r\n        AddColumn( Taio, "Taio", 1 );\r\n        AddColumn( Taio2, "Taio TF2", 1, 1, colorWhite, 60 );\r\n        AddColumn( TpVa, "Taio Top / Valley", 1, 1, IIf( TpVa == 1 OR TpVa == -1, colorLightBlue, colorWhite ), 0 );\r\n        AddColumn( ZLC, "Zero Line Cross", 1, 1, IIf( ZLCp, def_Color1, IIf( ZLCn, colorRed, colorWhite ) ), 90 );\r\n        AddColumn( ZLB, "Zero Line Bounce", 1, 1, IIf( ZLBp, def_Color1, IIf( ZLBn, colorRed, colorWhite ) ), 100 );\r\n        AddColumn( TrendLevelreached, "Trend Level reached", 1, 1, IIf( UpperLevelreached, def_Color1, IIf( LowerLevelreached, colorRed, colorWhite ) ), 120 );\r\n        AddColumn( OBOS, "Overbought/Oversold", 1, 1, IIf( Oversold, def_Color1, IIf( Overbought, colorRed, colorWhite ) ), 120 );\r\n        AddColumn( IIf( Taio &gt; Level, BarsSince( Cross( Taio, Level ) ), IIf( Taio &lt; -Level, BarsSince( Cross( -Level, Taio ) ), Null ) ), "Bars since Trendlevel reached", 1.0 );\r\n        AddColumn( IIf( Taio2upsig, 1, IIf( Taio2dnsig, -1, Null ) ), "Taio 2 Signals", 1, 1, IIf( Taio2upsig, def_Color1, IIf( Taio2dnsig, colorRed, colorWhite ) ), 40 );\r\n        AddTextColumn( FullName(), "Full name", 120 );\r\n    }\r\n    else\r\n    {\r\n        Addefaultcolumns();\r\n        Adddefaultcolumns( 2, 1 );\r\n        AddColumn( Taio, "Taio", 1 );\r\n        AddColumn( Taio2, "Taio TF2", 1, 1, colorWhite, 60 );\r\n        AddColumn( TpVa, "T/V", 1, 1, IIf( TpVa == 1 OR TpVa == -1, colorLightBlue, colorWhite ), 40 );\r\n        AddColumn( ZLC, "ZLC", 1, 1, IIf( ZLCp, def_Color1, IIf( ZLCn, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( ZLB, "ZLB", 1, 1, IIf( ZLBp, def_Color1, IIf( ZLBn, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( TrendLevelreached, "TLR", 1, 1, IIf( UpperLevelreached, def_Color1, IIf( LowerLevelreached, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( OBOS, "OB/OS", 1, 1, IIf( Oversold, def_Color1, IIf( Overbought, colorRed, colorWhite ) ), 60 );\r\n        AddColumn( IIf( Taio &gt; Level, BarsSince( Cross( Taio, Level ) ), IIf( Taio &lt; -Level, BarsSince( Cross( -Level, Taio ) ), Null ) ), "BSTR", 1.0 );\r\n        AddColumn( IIf( Taio2upsig, 1, IIf( Taio2dnsig, -1, Null ) ), "T2 Sig", 1, 1, IIf( Taio2upsig, def_Color1, IIf( Taio2dnsig, colorRed, colorWhite ) ), 40 );\r\n        //AddTextColumn(FullName(),"Full name");\r\n    }\r\n}\r\n\r\n/*******************************************************************************************/\r\nPlotGrid( Level, colorDefault );\r\n\r\nPlotGrid( -Level, colorDefault );\r\n\r\nPlotGrid(   0, colorDefault );\r\n\r\nPlotGrid( 100, colorDefault );\r\n\r\nPlotGrid( -100, colorDefault );\r\n\r\nPlot( IIf( Ribbons_switch == 0, Ribbonsheight, -1e10 ), "", RibbonsColor, styleOwnScale | styleArea | styleNoLabel, -0.1, 100 );\r\n\r\nPlot( IIf( SecondTF2, Taio2, -1e10 ), "TF2 Taio", Taio2_color, SecondTFstyle );\r\n\r\nPlot( Taio, "TF1 Taio", Taio1_color, style1 );\r\n\r\nif ( Shadows_switch )\r\n{\r\n    PlotOHLC( 0, Taio, 0, Taio, "", IIf( Taio &gt; 0, up_color1, dn_color1 ), styleCloud | styleClipMinMax, -Level, Level );\r\n}\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Taio Indicator" + " - " +  Name() + " - " + EncodeColor( colorRed ) + Interval( 2 ) + EncodeColor() + "  - " + Date() + " - " + EncodeColor( LastValue( Taio1_color ) ) + "Taio = " + WriteVal( Taio, 1.2 ) + ", " + EncodeColor( LastValue( Taio2_color ) ) + "TF-Multiplier = " + WriteVal( Multiplier, 1.0 ) + ", " + "Taio 2nd time frame = " + WriteVal( Taio2, 1.2 ) + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - TAIO Indicator 2.afl</FilePath>
			<Flags>0</Flags>
			<MoreFlags>1073741843</MoreFlags>
			<Min>-113.044</Min>
			<Max>123.938</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Report Charts</Name>
		<Pane>
			<ChartID>1</ChartID>
			<PercentHeight>36</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) Vol " +WriteVal( V, 1.0 ) +" {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 )) ));\r\nPlot( C, "Close", ParamColor("Color", colorBlack ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\nif( ParamToggle("Tooltip shows", "All Values|Only Prices" ) )\r\n{\r\n Tooltip=StrFormat("Open: %g\\nHigh:  %g\\nLow:   %g\\nClose:  %g (%.1f%%)\\nVolume: "+NumToStr( V, 1 ), O, H, L, C, SelectedValue( ROC( C, 1 )));\r\n}\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Mid MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 45, 2, 300, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Long MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 100, 2, 400, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 300, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nStyle = ParamStyle("Style") | styleNoRescale | styleNoRescale;\r\nPlot( BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Volume");\r\nPlot( Volume, _DEFAULT_NAME(), ParamColor("Color", colorLavender ), styleNoTitle | ParamStyle( "Style", styleHistogram | styleOwnScale | styleThick | styleNoLabel, maskHistogram  ), 2 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Price Interpretation");\r\nmovshort = ParamField("Short Time MA", 8 );\r\nmovmed = ParamField("Mid Time MA", 9 );\r\nmovlong = ParamField("Long Time MA", 10 );\r\nbtop = ParamField("BBTop", 11 );\r\nbbot = ParamField("BBBottom", 12 );\r\nif( Status("action") == actionCommentary )\r\n{\r\nwidth = btop - bbot;\r\nlslop = LinRegSlope( C, 30 ) + 100;\r\nlslo = LLV( lslop, 90 );\r\nlshi = HHV( lslop, 90 );\r\nlswidth = lshi - lslo;\r\ntrend = 100*( lslop - lslo )/lswidth;\r\n\r\nmawidth = MA( width, 100 );\r\nrelwidth = 100*(width - mawidth)/mawidth;\r\n\r\n_N( tname = Name()+"("+FullName()+")" );\r\n\r\nprintf("Price and moving averages:\\n");\r\nprintf( tname + " has closed " + WriteIf( C &gt; movshort, "above" , "below" ) + " its Short time moving average. ");\r\n\r\nprintf("\\nShort time moving average is currently " + WriteIf( movshort &gt; movmed, "above", "below") + " mid-time, AND " + WriteIf( movshort &gt; movlong, "above", "below" ) + " long time moving averages.");\r\n\r\nprintf("\\nThe relationship between price and moving averages is: "+\r\nWriteIf( C &gt; movshort AND movshort &gt; movmed, "bullish",\r\nWriteIf( C &lt; movshort AND movshort &lt; movmed, "bearish", "neutral" ) ) + " in short-term, and "+\r\nWriteIf( movshort &gt; movmed AND movmed &gt; movlong , "bullish",\r\nWriteIf( movshort &lt; movmed AND movmed &lt; movlong, "bearish", "neutral" ) ) + " in mid-long term. ");\r\n\r\nprintf("\\n\\nBollinger Bands:\\n");\r\nprintf(tname+ " has closed " + \r\nWriteIf( C &lt; bbot, "below the lower band by " +\r\nWriteVal( 100 *( bbot-C )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &lt; 30, " This combined with the steep downtrend can suggest that the downward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the lower band and a downside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &gt; btop, "above the upper band by " +\r\nWriteVal( 100 *( C- btop )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &gt; 70, " This combined with the steep uptrend suggests that the upward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the upper band and a upside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &lt; btop AND ( ( btop - C ) / width ) &lt; 0.5, \r\n"below upper band by " +\r\nWriteVal( 100 *( btop - C )/ width, 1.1 ) + "%%. ", \r\nWriteIf( C &lt; btop AND C &gt; bbot , "above bottom band by " +\r\nWriteVal( 100 *( C - bbot )/ width, 1.1 ) + "%%. ", "" ) ));\r\n\r\nprintf("\\n"+\r\nWriteIf( ( trend &gt; 30 AND trend &lt; 70 AND ( C &gt; btop OR C &lt; bbot ) ) AND abs(relwidth) &gt; 40,\r\n\t\t "This picture becomes somewhat unclear due to the fact that Bollinger Bands are  currently",\r\n\t\t "Bollinger Bands are " )+\t  \r\nWriteVal( abs( relwidth ), 1.1 ) + "%% " +\r\nWriteIf( relwidth &gt; 0, "wider" , "narrower" ) +\r\n" than normal.");\r\n\r\nprintf("\\n");\r\n\r\nprintf(\r\nWriteIf( abs( relwidth ) &lt; 40, "The current width of the bands (alone) does not suggest anything conclusive about the future volatility or movement of prices.","")+\r\nWriteIf( relwidth &lt; -40, "The narrow width of the bands suggests low volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility increasing with a sharp price move has increased for the near-term. "+\r\n"The bands have been in this narrow range for " + WriteVal(BarsSince(Cross(-40,relwidth)),1.0) + " bars. The probability of a significant price move increases the longer the bands remain in this narrow range." ,"")+\r\nWriteIf( relwidth &gt; 40, "The large width of the bands suggest high volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility decreasing and prices entering (or remaining in) a trading range has increased for the near-term. "+\r\n"The bands have been in this wide range for  " + WriteVal(BarsSince(Cross(relwidth,40)),1.0) + " bars.The probability of prices consolidating into a less volatile trading range increases the longer the bands remain in this wide range." ,""));\r\n\r\nprintf("\\n\\nThis commentary is not a recommendation to buy or sell. Use at your own risk.");\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_Price.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741827</MoreFlags>
			<Min>474.685</Min>
			<Max>973.596</Max>
		</Pane>
		<Pane>
			<ChartID>2</ChartID>
			<PercentHeight>12</PercentHeight>
			<Formula>_SECTION_BEGIN("MACD");\r\nr1 = Param( "Fast avg", 12, 2, 200, 1 );\r\nr2 = Param( "Slow avg", 26, 2, 200, 1 );\r\nr3 = Param( "Signal avg", 9, 2, 200, 1 );\r\nPlot( ml = MACD(r1, r2), StrFormat(_SECTION_NAME()+"(%g,%g)", r1, r2), ParamColor("MACD color", colorRed ), ParamStyle("MACD style") );\r\nPlot( sl = Signal(r1,r2,r3), "Signal" + _PARAM_VALUES(), ParamColor("Signal color", colorBlue ), ParamStyle("Signal style") );\r\nPlot( ml-sl, "MACD Histogram", ParamColor("Histogram color", colorBlack ), styleNoTitle | ParamStyle("Histogram style", styleHistogram | styleNoLabel, maskHistogram ) );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\_MACD.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741849</MoreFlags>
			<Min>-68.5486</Min>
			<Max>52.6346</Max>
		</Pane>
		<Pane>
			<ChartID>1039</ChartID>
			<PercentHeight>12</PercentHeight>
			<Formula>_SECTION_BEGIN("PE");\r\n//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Volatility Exploration\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Volatility Exploration";\r\n\r\nSetChartOptions( 0, 0, chartGridPercent + chartGridMiddle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\npds = 100;\r\nRatioPds1 = Param( "Period 1", 5, 0, 100, 1 );\r\nRatioPds2 = Param( "Period 2", 100, 0, 200, 5 );\r\n/*******************************************************************************************/\r\nAddVolaRatio( RatioPds1, RatioPds2, pds );\r\n/*******************************************************************************************/\r\nPlot( VolaRatio, "Vola Ratio", 4, 1 );\r\nPlotGrid( 0, colorDefault );\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\nwidth = 50;\r\ndigits = 1.2;\r\nAddefaultcolumns();\r\nAddColumn( MA( V, 50 ), "ma(V,50)", 1 );\r\nAddColumn( MA( IV, 5 ), "Vola 5", digits, colorDefault, colorDefault, width );\r\nAddColumn( MA( IV, 10 ), "Vola 10", digits, colorDefault, colorDefault, width + 2 );\r\nAddColumn( MA( IV, 50 ), "Vola 50", digits, colorDefault, colorDefault, width + 2 );\r\nAddColumn( MA( IV, 100 ), "Vola 100", digits, colorDefault, colorDefault, width + 10 );\r\nAddColumn( VolaRatio, "Vola Ratio", digits, colorDefault, colorDefault, width + 60 );\r\nAddColumn( MA( IV, 5 ) / MA( IV, 100 ), "Vola Ratio 5/100", digits, colorDefault, colorDefault, width + 60 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Volatility Exploration" + " - " +  Name() + " - " + EncodeColor( colorRed ) + Interval( 2 ) + EncodeColor() + "  - " + Date();\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Volatility Exploration 1.afl</FilePath>
			<Flags>258</Flags>
			<MoreFlags>1073741825</MoreFlags>
			<Min>-62.1778</Min>
			<Max>164.658</Max>
		</Pane>
		<Pane>
			<ChartID>1044</ChartID>
			<PercentHeight>12</PercentHeight>
			<Formula>_SECTION_BEGIN("1. Portfolio Equity");\r\nfunction PlotGradientArea( array, caption, ColorTop, ColorBottom ) \r\n{ \r\n bkclr = GetChartBkColor(); \r\n\r\n HH = HighestVisibleValue( array ); \r\n if( NOT IsNull( hh ) ) SetChartBkGradientFill( ColorTop, ColorBottom, bkclr, Null, HH ); \r\n Plot( array, Caption, ColorBlend( ColorBottom, colorBlack ), styleNoLabel ); \r\n PlotOHLC( HH, HH, array, HH, "", bkclr, styleNoLabel | styleNoTitle | styleCloud, Null, Null, 0, -10 ); \r\n} \r\n\r\nTitle = "Portfolio Equity = " + C;\r\nPlotGradientArea( C, "Portfolio Equity", colorLightOrange, colorPaleGreen );\r\n\r\n//SetChartOptions(3, chartShowDates );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\1. Portfolio Equity 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>479.585</Min>
			<Max>957.072</Max>
		</Pane>
		<Pane>
			<ChartID>1045</ChartID>
			<PercentHeight>12</PercentHeight>
			<Formula>_SECTION_BEGIN("2. Underwater Equity");\r\n// Underwater Equity chart\r\n// (C)2009 AmiBroker.com\r\n// Should be used only on ~~~EQUITY symbol\r\n\r\nfunction PlotGradientAreaRev( array, caption, ColorTop, ColorBottom ) \r\n{ \r\n bkclr = GetChartBkColor(); \r\n\r\n HH = HighestVisibleValue( array ); \r\n LL = LowestVisibleValue( array ); \r\n if( NOT IsNull( hh ) ) SetChartBkGradientFill( ColorTop, ColorBottom, bkclr, LL, HH ); \r\n //Plot( array, Caption, ColorBlend( ColorBottom, colorBlack ), styleNoLabel ); \r\n array += LL *0.005; \r\n PlotOHLC( array, array, LL, array, "", bkclr, styleNoLabel | styleNoTitle | styleCloud, Null, Null, 0, -10 ); \r\n} \r\n\r\nEQ = C;\r\nMaxEQ = Highest( EQ );\r\nDD = 100 * ( Eq - MaxEQ ) / MaxEq;\r\nMaxDD = Lowest( DD );\r\n\r\nTitle = StrFormat("Drawdown = %.2g%%, Max. drawdown %.2g%%", DD, LastValue( MaxDD ) );\r\nPlotGradientAreaRev( DD, "Drawdown ", ColorRGB( 220, 255, 255 ), ColorRGB( 0, 0, 180 ) );\r\n\r\nPlot( MaxDD, "Max DD", colorRed, styleNoLabel, Null, Null, 0, 2 );\r\n\r\nSetChartOptions( 2, 0, chartGridPercent );\r\n\r\nif( Name() != "~~~EQUITY" ) Title = "Warning: wrong ticker! This chart should be used on ~~~EQUITY only";\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\2. Underwater Equity 1.afl</FilePath>
			<Flags>2</Flags>
			<MoreFlags>1073741825</MoreFlags>
			<Min>-48.9049</Min>
			<Max>2.2043</Max>
		</Pane>
		<Pane>
			<ChartID>1046</ChartID>
			<PercentHeight>12</PercentHeight>
			<Formula>_SECTION_BEGIN("3. Profit Table");\r\neq = C;\r\n\r\nyr = Year();\r\nmo = Month();\r\n\r\nYearChange = yr != Ref( yr, -1 );\r\nMonChange = mo != Ref( mo, -1 );\r\n\r\nFirstYr = 0;\r\nLastYr = 0;\r\n\r\nstartbar = 0;\r\n\r\n////////////////////////////\r\n// SKIP non-trading bars\r\n////////////////////////////\r\nfor( i = 0; i &lt; BarCount; i++ )\r\n{\r\n  if( eq[ i ] )\r\n  {\r\n    startbar = i;\r\n    break;\r\n  } \r\n}\r\n\r\n////////////////////////////\r\n// collect yearly / monthly changes in equity\r\n// into dynamic variables\r\n////////////////////////////\r\n\r\nLastYrValue = eq[ startbar  ];\r\nLastMoValue = eq[ startbar  ];\r\n\r\nMaxYrProfit = MinYrProfit = 0;\r\nMaxMoProfit = MinMoProfit = 0;\r\n\r\nfor( i = startbar + 1; i &lt; BarCount; i++ )\r\n{\r\n  if( YearChange[ i ] || i == BarCount - 1 )\r\n  {\r\n    Chg = 100 * ( -1 + eq[ i ] / LastYrValue );\r\n    VarSet("ChgYear"+ yr[ i - 1 ], Chg );\r\n\r\n    MaxYrProfit = Max( MaxYrProfit, Chg );\r\n    MinYrProfit = Min( MinYrProfit, Chg );\r\n\r\n    if( FirstYr == 0 ) FirstYr = yr[ i - 1 ];\r\n    LastYr = yr[ i ];\r\n\r\n    LastYrValue = eq[ i ];\r\n  }\r\n\r\n  if( MonChange [ i ] || i == BarCount - 1 )\r\n  {\r\n    mon = mo[ i - 1 ];\r\n\r\n    Chg = 100 * ( -1 + eq[ i ] / LastMoValue );\r\n\r\n    VarSet("ChgMon" + yr[ i - 1 ] + "-" + mon, Chg );\r\n    VarSet("SumChgMon"+ mon, Chg + Nz( VarGet("SumChgMon"+ mon ) ) );\r\n    VarSet("SumMon" + mon, 1 + Nz( VarGet("SumMon"+ mon ) ) );\r\n \r\n    MaxMoProfit = Max( MaxMoProfit, Chg );\r\n    MinMoProfit = Min( MinMoProfit, Chg );\r\n\r\n    LastMoValue = eq[ i ];\r\n  }\r\n}\r\n\r\n/////////////////////////////////////////////////\r\n// Drawing code &amp; helper functions\r\n////////////////////////////////////////////////\r\n\r\nGfxSetOverlayMode( 2 );\r\n\r\nCellHeight = (Status("pxheight")-1)/(LastYr - FirstYr + 3 ); \r\nCellWidth = (Status("pxwidth")-1)/14; \r\nGfxSelectFont( "Tahoma", 8.5 ); \r\n\r\nGfxSetBkMode( 1 );\r\n\r\nfunction PrintInCell( string, row, Col ) \r\n{\r\n Color =  ColorRGB( IIf( row == 0 || col == 0 || col == 13, 220, 255 ), 255, IIf( row % 2, 255, 220 ) );\r\n GfxSelectSolidBrush( Color   );\r\n GfxRectangle( Col * CellWidth, \r\n                    row * CellHeight, (Col + 1 ) * CellWidth + 1, \r\n                    (row + 1 ) * CellHeight  + 1); \r\n GfxDrawText( string, Col * CellWidth + 1, \r\n                    row * CellHeight + 1, \r\n                    (Col + 1 ) * CellWidth, (row + 1 ) * CellHeight, 32+5 ); \r\n} \r\n\r\nYOffset = 25;\r\nXOffset = 15;\r\n\r\nfunction DrawBar( text, bar, numbars, y, Miny, Maxy )\r\n{\r\n BarWidth = (Status("pxwidth") - 4 * XOffset )/( numbars + 1 ); \r\n BarHeight = Status("pxheight") - 2 * YOffset;\r\n relpos = ( y - Miny ) / (Maxy - Miny );\r\n\r\n xp = XOffset + ( bar + 0.5 ) * BarWidth;\r\n yp = YOffset + BarHeight * ( 1 - relpos );\r\n xe = XOffset + ( bar + 1 ) * BarWidth;\r\n ye = YOffset + BarHeight * ( 1 - ( -miny )/( maxy - miny ) );\r\n  \r\n if( y &gt; 0 )\r\n {\r\n GfxGradientRect( xp, yp, \r\n                  xe , ye,\r\n                  ColorHSB( 70, 255 * relpos, 255 ), ColorHSB( 70, 20, 255 ) ); \r\n }\r\n else\r\n {\r\n GfxGradientRect( xp, ye, \r\n                  xe , yp,\r\n                  ColorHSB( 0, 20, 255 ), ColorHSB( 0, 255 * ( 1 - relpos ), 255 ) ); \r\n }\r\n GfxTextOut( text, xp, ye );\r\n GfxTextOut( StrFormat("%.2f", y ), xp, yp );\r\n}    \r\n\r\nfunction DrawLevels( Miny, Maxy )\r\n{\r\n  range = Maxy - Miny;\r\n\r\n  grid = 100;\r\n  if( range &lt; 10 ) grid = 1;\r\n  else \r\n  if( range &lt; 20 ) grid = 2;\r\n  else \r\n  if( range &lt; 50 ) grid = 5;\r\n  else \r\n  if( range &lt; 100 ) grid = 10;\r\n  else \r\n  if( range &lt; 200 ) grid = 20;\r\n  else \r\n  if( range &lt; 500 ) grid = 50;\r\n\r\n  _TRACE("grid = "+grid +" range "+range );\r\n  \r\n  width = Status("pxwidth") - 4 * XOffset;\r\n  height = Status("pxheight") - 2 * YOffset;\r\n\r\n  GfxSelectPen( colorBlack, 1, 2 );\r\n  for( y = grid * ceil( Miny / grid ); y &lt;= grid * floor( Maxy / grid ); y += grid )\r\n  {\r\n    yp =  YOffset + Height * ( 1 -  ( y - Miny ) / (Maxy - Miny ) );\r\n\r\n    GfxMoveTo( XOffset, yp );\r\n    GfxLineTo( XOffset + width , yp );\r\n    GfxTextOut( ""+ y, XOffset + 2 + width, yp );\r\n  }\r\n\r\n  GfxSelectPen( colorBlack, 1, 0 );\r\n  GfxMoveTo( XOffset, YOffset );\r\n  GfxLineTo( XOffset + width, YOffset );\r\n  GfxLineTo( XOffset + width, YOffset + Height );\r\n  GfxLineTo( XOffset , YOffset + Height );\r\n  GfxLineTo( XOffset , YOffset );\r\n}\r\n\r\nMonthNames = "Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec";\r\n\r\nfunction DisplayProfitTable( )\r\n{\r\n Header = "Year,"+MonthNames+",Yr%";\r\n for( Col = 0; (Colname = StrExtract( Header, Col ) ) != ""; Col++ )\r\n {\r\n  PrintInCell( ColName, 0, Col );\r\n }\r\n\r\n Row = 1;\r\n for( y = FirstYr; y &lt;= LastYr; y++ )\r\n {\r\n  PrintInCell( StrFormat("%g", y ), Row, 0 ); \r\n  PrintInCell( StrFormat("%.1f%%", VarGet("ChgYear" + y ) ), Row, 13 ); \r\n  for( m = 1; m &lt;= 12; m++ )\r\n  { \r\n   Chg = VarGet("ChgMon" + y + "-" + m);\r\n   if( Chg ) \r\n     PrintInCell( StrFormat("%.1f%%", Chg ), Row, m );\r\n   else\r\n     PrintInCell( "N/A", Row, m );\r\n  }\r\n  Row++;\r\n } \r\n\r\n PrintInCell("Avg", Row, 0 );\r\n for( m = 1; m &lt;= 12; m++ )\r\n { \r\n   PrintInCell( StrFormat("%.1f%%",  Nz( VarGet("SumChgMon" + m)/VarGet("SumMon" + m ) ) ), Row, m );\r\n }\r\n\r\n}\r\n\r\nfunction DisplayYearlyProfits()\r\n{\r\n Bar = 0;\r\n for( y = FirstYr; y &lt;= LastYr; y++ )\r\n {\r\n   Chg = VarGet("ChgYear" + y );\r\n   DrawBar( ""+y, Bar++, ( LastYr - FirstYr + 1 ), Chg, MinYrProfit, MaxYrProfit );\r\n }\r\n GfxTextOut("Yearly % Profit chart", 10, 10 );\r\n\r\n DrawLevels( MinYrProfit, MaxYrProfit ); \r\n}\r\n\r\nfunction DisplayMonthlyProfits()\r\n{\r\n Bar = 0;\r\n \r\n MinAvgProf = MaxAvgProf = 0;\r\n for( y = 1; y &lt;= 12; y++ )\r\n {\r\n   Chg = VarGet("SumChgMon" + y ) / VarGet("SumMon" + y );\r\n   MinAvgProf = Min( MinAvgProf, Chg );\r\n   MaxAvgProf = Max( MaxAvgProf, Chg );\r\n }\r\n\r\n for( y = 1; y &lt;= 12; y++ )\r\n {\r\n   Chg = VarGet("SumChgMon" + y ) / VarGet("SumMon" + y );\r\n   DrawBar( StrExtract(MonthNames, y-1 ), Bar++, 13, Chg, MinAvgProf , MaxAvgProf );\r\n }\r\n GfxTextOut("Avg. Monthly % Profit chart", 10, 10 );\r\n\r\n DrawLevels( MinAvgProf , MaxAvgProf ); \r\n}\r\n\r\n///////////////////////////\r\n// This function checks if currently selected symbol\r\n// is portfolio equity\r\n//////////////////////////\r\nfunction CheckSymbol()\r\n{\r\n if( Name() != "~~~EQUITY" )\r\n {\r\n  GfxSelectFont( "Tahoma", 20 ); \r\n  GfxSetBkMode( 2 );\r\n  GfxTextOut("For accurate results switch to ~~~EQUITY symbol", 10, 10 );\r\n }\r\n}\r\n\r\n////////////////////////////\r\n// Main program - chart type switch\r\n////////////////////////////\r\ntype = ParamList("Chart Type", "Profit Table|Yearly Profits|Avg. Monthly Profits", 0 );\r\n\r\nswitch( type )\r\n{\r\n case "Profit Table": \r\n         DisplayProfitTable();  \r\n         break;\r\n case "Yearly Profits": \r\n         DisplayYearlyProfits();\r\n         break;\r\n case "Avg. Monthly Profits": \r\n         DisplayMonthlyProfits();\r\n         break;\r\n}\r\n\r\nCheckSymbol();\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\3. Profit Table 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>0</Min>
			<Max>0</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE-Price Patterns</Name>
		<Pane>
			<ChartID>1072</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Candlestick Recognition\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Candlesticks";\r\n\r\nSetChartOptions( 0, chartShowDates | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\ndef_PE_AB_Style = 0; //PatternExplorer style:0 //Amibroker style: 1\r\ndef_pricestyle = styleCandle;// + styleThick; //can be used at PatternExplorer mode\r\ndef_Band_switch = 1;//Off:0 //On:1\r\ndef_BandTyp = 0;//Off:0 //Bollinger Bands:1 //Headley Acceleration Bands:2 //Keltner Channel:3 //Price Channel:4\r\n/*******************************************************************************************/\r\n//AddparamUsefromChart(1);\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nActTrendFilter = ParamToggle( "Trend Filter", "Off,On", 0 );\r\nSRplot = ParamToggle( "Plot S/R", "Off,On", 1 );\r\nTextPlot = ParamToggle( "Plot Signal Text", "Off,On", 0 );\r\nBuyshape = Param( "Buy Shape Typ", def_BuyShape, 1, 60, 1 );\r\nSellshape = Param( "Sell Shape Typ", def_SellShape, 1, 60, 1 );\r\nBuyColor = ParamColor( "Buy Signals", def_BuyShapeColor );\r\nSellColor = ParamColor( "Sell Signals", def_SellShapeColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Pattern Selection" );\r\nDojistar_s = ParamToggle( "Doji Star", "Off,On", 1 );\r\nHammer_s = ParamToggle( "Hammer/Shooting Star", "Off,On", 1 );\r\nHangingman_s = ParamToggle( "Hanging Man/Inverted Hammer", "Off,On", 1 );\r\nSpinningtop_s = ParamToggle( "Spinning Top", "Off,On", 1 );\r\nEng_s = ParamToggle( "Engulfing", "Off,On", 1 );\r\nHarami_s = ParamToggle( "Harami", "Off,On", 1 );\r\nPiercingline_s = ParamToggle( "Piercing Line/Dark Cloud Cover", "Off,On", 1 );\r\nMorning_evening_star_s = ParamToggle( "Morning Star/Evening Star", "Off,On", 1 );\r\n_SECTION_END();\r\n/*Static - currently not support by amibroker\r\nif(InChart)StaticVarSet("PQQAWN",Dojistar_s);if(inAA AND Usefromchart) Dojistar_s = StaticVarGet("PQQAWN");\r\nif(InChart)StaticVarSet("ONLDUM",Hammer_s);if(inAA AND Usefromchart) Hammer_s = StaticVarGet("ONLDUM");\r\nif(InChart)StaticVarSet("CPAWNL",Hangingman_s);if(inAA AND Usefromchart) Hangingman_s = StaticVarGet("CPAWNL");\r\nif(InChart)StaticVarSet("MNHCWV",Spinningtop_s);if(inAA AND Usefromchart) Spinningtop_s = StaticVarGet("MNHCWV");\r\nif(InChart)StaticVarSet("FLXSHT",Eng_s);if(inAA AND Usefromchart) Eng_s = StaticVarGet("FLXSHT");\r\nif(InChart)StaticVarSet("FBDBRN",Harami_s);if(inAA AND Usefromchart) Harami_s = StaticVarGet("FBDBRN");\r\nif(InChart)StaticVarSet("OVITBK",Piercingline_s);if(inAA AND Usefromchart) Piercingline_s = StaticVarGet("OVITBK");\r\nif(InChart)StaticVarSet("VHVRAB",Morning_evening_star_s);if(inAA AND Usefromchart) Morning_evening_star_s = StaticVarGet("VHVRAB");\r\n*/\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f01.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\n\r\nif ( ActTrendFilter == 0 )\r\n{\r\n    Buy = def_Buy AND CandlePatternRank &gt; 0;\r\n    Sell = def_Sell AND CandlePatternRank &lt; 0;\r\n}\r\n\r\nif ( ActTrendFilter )\r\n{\r\n    Buy = def_Buy AND CandlePatternRank &gt; 0\r\n          AND PeTaio() &gt; 0\r\n          AND TaioTimeFrame( 5, 6, 4, expandLast ) &gt; 0\r\n          AND Taio2direction == 1; //define your conditions for the Trendfilter here.\r\n\r\n    Sell = def_Sell AND CandlePatternRank &lt; 0\r\n           AND PeTaio() &lt; 0\r\n           AND TaioTimeFrame( 5, 6, 4, expandLast ) &lt; 0\r\n           AND Taio2direction == 0; //define your conditions for the Trendfilter here.\r\n}\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter  AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( Buy OR Sell );\r\n\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\n\r\nAdddefaultcolumns( 2, 1 );\r\n\r\nif ( CandleColumnOn == 0 )\r\n    AddCandleColumn();\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nPlotShapes(\r\n    IIf( Buy, Buyshape,\r\n         IIf( Sell, Sellshape, Null ) ),\r\n    IIf( Buy, BuyColor, SellColor ), 0,\r\n    IIf( Buy, L, H ), IIf( Buy, -def_BuyShapeOffset, -def_SellShapeOffset ) );\r\n\r\nPlot( IIf( SRplot, Plot_Buy, Null ), "Support", Buycolor, 1 + styleNoTitle );\r\n\r\nPlot( IIf( SRplot, Plot_Sell, Null ), "Resistance", Sellcolor, 1 + styleNoTitle );\r\n\r\n/*******************************************************************************************/\r\nif ( TextPlot )\r\n{\r\n    //PlotSignalText (Condition,Text,AdText,AdTextArray,Distance,Array,TextColor,BGColor);\r\n    PlotSignalText ( PR &gt; 0, "Buy", 0, L, -0.8, L, BuyColor, colorDefault );\r\n    PlotSignalText ( PR &lt; 0, "Sell", 0, H, 1.0, H, SellColor, colorDefault );\r\n}\r\n\r\n/*******************************************************************************************/\r\nAddAlert( Hammer, Audio, Email, "Bullish Hammer" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beSSTAR, Audio, Email, "Bearish Shooting Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( InvertedHammer, Audio, Email, "Bullish Inverted Hammer" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( HangingMan, Audio, Email, "Bearish Hanging Man" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( SpinningTop AND NOT buDS, Audio, Email, "Bearish Spinning Top" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buENG, Audio, Email, "Bullish Engulfing" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beENG, Audio, Email, "Bearish Engulfing" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buHARAMI, Audio, Email, "Bullish Harami" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beHARAMI, Audio, Email, "Bearish Harami" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buHARAMICROSS, Audio, Email, "Bullish Harami Cross" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beHARAMICROSS, Audio, Email, "Bearish Harami Cross" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buDS, Audio, Email, "Bullish Doji Star" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beDS, Audio, Email, "Bearish Doji Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buPIERCINGLINE, Audio, Email, "Bullish Piercingline" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beDARKCLOUDCOVER, Audio, Email, "Bearish Dark Cloud Cover" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( buMorningStar, Audio, Email, "Bullish Morning Star" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( buMorningDojiStar, Audio, Email, "Bullish Morning Doji Star" + def_AudioAlertText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( beEveningStar, Audio, Email, "Bearish Evening Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( beEveningDojiStar, Audio, Email, "Bearish Evening Doji Star" + def_AudioAlertText, 2, BarComplete, def_SellSound1 );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip + "\\n\\n" + CandlePattern;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Candlestick Recognition" + default_priceTitle + ", " + EncodeColor( def_Color3 ) + WriteIf( CandlePatternRank &gt; 0, "Bullish ", WriteIf( CandlePatternRank &lt; 0, "Bearish ", "" ) ) + CandlePattern + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Candlesticks 4.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741847</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
		<Pane>
			<ChartID>1071</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Fractals\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Fractals";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Alerts" );\r\nSRbS = ParamToggle( "S/R broken", "Off,On", 1 );\r\nSRcS = ParamToggle( "S/R confirmed", "Off,On", 1 );\r\nPjabS = ParamToggle( "Price just above/below", "Off,On", 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main parameters" );\r\nSRplot = ParamToggle( "Plot S/R", "Off,On", 1 );\r\nSswitch = ParamToggle( "PLot Swing Chart", "Off,On", 0 );\r\nShswitch = ParamToggle( "Plot Swing Shapes", "Off,On", 0 );\r\nSwingSize = Param( "Swing Size %", 5, 0.1, 40, 0.1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Sensitivity" );\r\nAddparamUsefromChart2( def_UseFromChart );\r\nPatternPriceBasis = ParamToggle( "Pattern Price Basis", "Close|High &amp; Low", def_PatternPriceBasisFractals );\r\nBars = Param( "Bars", 5, 2, 20, 1 );\r\nMinVertSize = Param( "Minimum Vertical Size (*ATR)", 0, 0, 3.01, 0.05 );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "Ddf343", PatternPriceBasis );\r\n\r\nif ( inAA AND Usefromchart )\r\n    PatternPriceBasis = StaticVarGet( "Ddf343" );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "P54972", Bars );\r\n\r\nif ( inAA AND Usefromchart )\r\n    Bars = StaticVarGet( "P54972" );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "Adf343", MinVertSize );\r\n\r\nif ( inAA AND Usefromchart )\r\n    MinVertSize = StaticVarGet( "Adf343" );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\n\r\nSwingstyle = ParamStyle( "Swing Line", styleLine | styleThick, maskDefault );\r\n\r\nTopShape = Param( "Top Fractal Typ", 21, 0, 50, 1 );\r\n\r\nValleyShape = Param( "Valley Fractal Typ", 22, 0, 50, 1 );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\n\r\nSLC = ParamColor( "Swing Low", colorPaleGreen );\r\n\r\nSHC = ParamColor( "Swing High", colorLightOrange );\r\n\r\nSwingcolor = ParamColor( "Swing Line", def_Color6 );\r\n\r\nTopshapecolor = ParamColor( "Top  Fractal", def_SellShapeColor );\r\n\r\nValleyshapecolor = ParamColor( "Bottom Fractal", def_BuyShapeColor );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f13.afl&gt;\r\n/*******************************************************************************************/\r\nPlotShapes( IIf( Top, TopShape, -1e10 ), Topshapecolor, 0, H, def_BuyShapeOffset );\r\n\r\nPlotShapes( IIf( Valley, Valleyshape, -1e10 ), ValleyShapecolor, 0, L, def_SellShapeOffset );\r\n\r\nPlot( IIf( SRplot &amp; x &gt;= x_lasttop, LastValue( ValueWhen( top, TopInput, 1 ) ), Null ), "", Topshapecolor, 1 + styleNoRescale );\r\n\r\nPlot( IIf( SRplot &amp; x &gt;= x_lastvalley, LastValue( ValueWhen( Valley, ValleyInput, 1 ) ), Null ), "", Valleyshapecolor, 1 + styleNoRescale );\r\n\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND ( Sup_confirmed OR Res_break );\r\n\r\nSell = def_Sell AND ( Res_confirmed OR Sup_break );\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( SupSignals OR ResSignals );\r\n\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\n\r\nAdddefaultcolumns( 2, 1 );\r\n\r\nAddTextColumn(\r\n    WriteIf( Sup_pricejustabove, "Price just above",\r\n             WriteIf( Sup_confirmed, "Confirmed",\r\n                      WriteIf( Sup_break, "Break", "" ) ) ), "Support", 1.2,\r\n    IIf( Sup_pricejustabove OR sup_confirmed, colorGreen, colorRed ) );\r\n\r\nAddTextColumn(\r\n    WriteIf( Res_pricejustbelow, "Price just below",\r\n             WriteIf( Res_confirmed, "Confirmed",\r\n                      WriteIf( Res_break, "Break", "" ) ) ), "Resistance", 1.2,\r\n    IIf( Res_pricejustbelow OR Res_confirmed, colorRed, colorGreen ) );\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nPlotShapes( IIf( Shswitch AND PivotLow, shapeCircle, Null ), SLC, 0, L, -35 ) ;\r\n\r\nPlotShapes( IIf( Shswitch AND PivotHigh, shapeCircle, Null ), SHC, 0, H, 35 ) ;\r\n\r\nPlot( IIf( Sswitch, ZZ, Null ), " ", Swingcolor, Swingstyle + styleNoTitle );\r\n\r\n/*******************************************************************************************/\r\nif ( SRbS )\r\n{\r\n    AddAlert( Res_break, Audio, Email, "Resistance broken", 1, BarComplete, def_BuySound1 );\r\n    AddAlert( Sup_break, Audio, Email, "Support broken", 2, BarComplete, def_SellSound1 );\r\n}\r\n\r\nif ( SRcS )\r\n{\r\n    AddAlert( Sup_confirmed, Audio, Email, "Support confirmed", 1, BarComplete, def_BuySound2 );\r\n    AddAlert( Res_confirmed, Audio, Email, "Resistance confirmed", 2, BarComplete, def_SellSound2 );\r\n}\r\n\r\nif ( PjabS )\r\n{\r\n    AddAlert( Sup_pricejustabove, Audio, Email, "Price just above Support", 1, BarComplete, def_BuySound1 );\r\n    AddAlert( Res_pricejustbelow, Audio, Email, "Price just below Resistance", 2, BarComplete, def_SellSound1 );\r\n}\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Fractals" + default_priceTitle;\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Fractals 5.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741843</MoreFlags>
			<Min>474.685</Min>
			<Max>973.596</Max>
		</Pane>
		<Pane>
			<ChartID>1070</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Performance overview\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Performance Chart";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nGraphXSpace = Param( "Vertical Zoom Out", 10, 0, 100, 1 );\r\npds = Param( "Smoothing Period", 3, 0, 20, 1 );//select 1, if you want no smoothing\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Symbols" );\r\nSymbol1 = ParamStr( "Symbol 1", def_Symbol_1 );\r\nSymbol2 = ParamStr( "Symbol 2", def_Symbol_2 );\r\nSymbol3 = ParamStr( "Symbol 3", def_Symbol_3 );\r\nSymbol4 = ParamStr( "Symbol 4", def_Symbol_4 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\nColorT1 = ParamColor( "Symbol 1", colorBlue );\r\nColorT2 = ParamColor( "Symbol 2", colorGreen );\r\nColorT3 = ParamColor( "Symbol 3", colorRed );\r\nColorT4 = ParamColor( "Symbol 4", colorOrange );\r\nColorT5 = ParamColor( "Selected Symbol", def_Color_Selected_Symbol );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f04.afl&gt;\r\nPlot( Perf_T1, "", colorT1, 1 );\r\nPlot( Perf_T2, "", colorT2, 1 );\r\nPlot( Perf_T3, "", colorT3, 1 );\r\nPlot( Perf_T4, "", colorT4, 1 );\r\nPlot( Perf_T5, "", colorT5, 1 );\r\n/*******************************************************************************************/\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Performance Chart " + def_Title +\r\n        EncodeColor( def_Text2 ) + " Period = " + WriteVal( No_of_bars, 1.0 ) + " days," + EncodeColor( def_Color3 ) + " Smooth-Factor = " + WriteVal( pds, 1.0 ) + " \\n" +\r\n        EncodeColor( colorT1 ) + Symbol1 + "   " + WriteVal( Perf_T1, 1.0 ) + " %          " +\r\n        EncodeColor( colorT2 ) + Symbol2 + "   " + WriteVal( Perf_T2, 1.0 ) + "%          " +\r\n        EncodeColor( colorT3 ) + Symbol3 + "   " + WriteVal( Perf_T3, 1.0 ) + " %          " +\r\n        EncodeColor( colorT4 ) + Symbol4 + "   " + WriteVal( Perf_T4, 1.0 ) + " %\\n" +\r\n        EncodeColor( colorT5 ) + FullName() + "   " + WriteVal( Perf_T5, 1.0 ) + " % ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Performance Chart 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741851</MoreFlags>
			<Min>-21.7113</Min>
			<Max>52.0852</Max>
		</Pane>
		<Pane>
			<ChartID>1069</ChartID>
			<PercentHeight>24</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Rainbow Chart\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Rainbow Chart";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\n//AddparamUsefromChart(1);\r\nside = 1;\r\nAddAvgTypeParam( 1 );\r\n//if(InChart) StaticVarSet("B4G8C8",AvgType);if(inAA AND Usefromchart) AvgType = StaticVarGet("B4G8C8");\r\nPF = ParamField( "Price Field" );\r\n//PF parameter from chart not available automatically in AA. It has to be selected in AA if not close is used.\r\nincrement = Param( "Increment", 2, 1, 10, 1 );\r\n//if(InChart) StaticVarSet("F6P4C8",increment);if(inAA AND Usefromchart) increment = StaticVarGet("F6P4C8");\r\nStartAvg = Param( "Fastest Average (Period)", 3, 1, 20, 1 );\r\n//if(InChart) StaticVarSet("W6O4D1",StartAvg);if(inAA AND Usefromchart) StartAvg = StaticVarGet("W6O4D1");\r\nLastAvg = Param( "Slowest Average (Max.Period)", 20, 1, 100, 1 );\r\n//if(InChart) StaticVarSet("G4C0A6",LastAvg);if(inAA AND Usefromchart) LastAvg = StaticVarGet("G4C0A6");\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\nEffect = ParamToggle( "3D Effect", "No|Yes", 0 );\r\nDisplayType = ParamToggle( "Plot Style", "Lines,Shadows", def_LinesORShadows );\r\nLineStyle = ParamStyle( "Lines", styleThick, maskDefault );\r\nShapes = ParamToggle( "Plot Shapes", "Off,On", 1 );\r\nBuyshape = Param( "Buy Shape Typ", def_BuyShape, 0, 50, 1 );\r\nSellShape = Param( "Sell Shape Typ", def_SellShape, 0, 50, 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nCount = 0;\r\n\r\nfor ( i = StartAvg; i &lt; LastAvg; i = i + increment )\r\n{\r\n    /*******************************************************************************************/\r\n    _SECTION_BEGIN( "Colors" );\r\n    Hue = Param( "Hue", 15, 1, 50, 1 ) * i;\r\n    Saturation = Param( "Saturation", 150, 0, 255 );\r\n    Brightness = side * Param( "Brightness", 200, 0, 255 );\r\n    Buyshapecolor = ParamColor( "Buy Shape Color", def_BuyShapeColor );\r\n    Sellshapecolor = ParamColor( "Sell Shape Color", def_SellShapeColor );\r\n    _SECTION_END();\r\n    /*******************************************************************************************/\r\n    up = Average( Pf, i, AvgType );\r\n    down = Average( Pf, i + increment, AvgType );\r\n\r\n    if ( Effect )\r\n        side = IIf( up &lt;= down AND Ref( up &lt;= down, 1 ), 0.6, 1 );\r\n\r\n    a = 0;\r\n\r\n    Count = Count + 1;\r\n\r\n    if ( DisplayType )\r\n    {\r\n        PlotOHLC( up, up, down, down, "Average" + i, ColorHSB( Hue, Saturation, Brightness ), styleCloud | styleNoLabel | styleNoTitle );\r\n    }\r\n    else\r\n    {\r\n        Plot( up, "Average" + i, ColorHSB( Hue, Saturation, Brightness ), LineStyle | styleNoLabel | styleNoTitle );\r\n    }\r\n}\r\n\r\nFastest = Average( Pf, StartAvg, AvgType );\r\n\r\nSlowestPds = StartAVG + ( Count - 1 ) * Increment;\r\nSlowest = Average( Pf, SlowestPds, AvgType );\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND Cross( fastest, slowest );\r\nSell = def_Sell AND Cross( slowest, fastest );\r\n/*******************************************************************************************/\r\n/*\r\nBodySize = 0.1;\r\nHeikinAshiDoji = abs((HaClose-HaOpen))&lt;(HaHigh-HaLow)/(1/BodySize);\r\n\r\nBuy = def_Buy AND Close &lt; slowest AND HaClose&gt;HaOpen AND Ref(HeikinAshiDoji,-1);//Heikin ashi doji outside from Rainbow\r\nSell = def_Sell AND Close &gt; slowest AND HaClose&lt;HaOpen AND Ref(HeikinAshiDoji,-1);//Heikin ashi doji outside from Rainbow\r\n\r\n//Buy = def_Buy AND (Buy OR Cross(fastest,slowest));//Rainbow signal and HA doji\r\n//Sell = def_Sell AND (Sell OR Cross(slowest,fastest));//Rainbow signal and HA doji\r\n*/\r\n/*******************************************************************************************/\r\nPlotShapes( Buy*Buyshape*Shapes, Buyshapecolor, 0, L, -def_BuyShapeOffset - 5 );\r\nPlotShapes( Sell*Sellshape*Shapes, Sellshapecolor, 0, H, -def_SellShapeOffset - 5 );\r\n/*******************************************************************************************/\r\nAddAlert( Buy, Audio, Email, "Fastest Average crossed slowest Average", 1, BarComplete, def_BuySound1 );\r\nAddAlert( Sell, Audio, Email, "Slowest Average crossed Fastest Average", 2, BarComplete, def_SellSound1 );\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nFilter = Filter AND ( Buy OR Sell );\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\nAdddefaultcolumns( 2, 1 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\nTitle = "PatternExplorer.com - Rainbow Chart " + Avgtext;\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = Title + default_priceTitle + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Rainbow Chart 4.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE-Support nd Resistance</Name>
		<Pane>
			<ChartID>1058</ChartID>
			<PercentHeight>48</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Pivot Points\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Pivots";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n_SECTION_BEGIN( "Main Parameters" );\r\nPivotTF = ParamList( "Time Frame", List = "15 min,Hourly,4 Hour,Daily,Weekly", 3 );\r\nTF =\r\n    IIf( PivotTF == "15 min", in15Minute,\r\n         IIf( PivotTF == "Hourly", inHourly,\r\n              IIf( PivotTF == "4 Hour", inHourly * 4,\r\n                   IIf( PivotTF == "Daily", inDaily,\r\n                        IIf( PivotTF == "Weekly", inWeekly,\r\n                             IIf( PivotTF == "Weekly", inMonthly, Null ) ) ) ) ) );\r\nPivotTyp = ParamList( "Calculation Method", List = "Regular,Woodies FIB,Woodies" );\r\nPivotLineMode = ParamToggle( "Plot Pivot as entirely Line", "Off,On", 1 );\r\nLineMode = ParamToggle( "Plot entirely Lines", "On,Off", 1 );\r\nShadow = ParamToggle( "Plot Shadow", "Off,On", 0 );\r\nTitledisplay = ParamToggle( "Display Title Information", "Horizontal,Vertical", 0 );\r\n_SECTION_END();\r\n_SECTION_BEGIN( "Buy and Sell Signals" );\r\nSignalType = ParamList( "Strategy Selection", List1 = "Off,1: Pivot with Taio &amp; GMA,2: Simple Level-Cross Signals", 0 );\r\nUseExrem = ParamToggle( "Use Exrem", "Off|0n", 0 );\r\nBuyShape = Param( "Buy Shape Typ", def_BuyShape, 0, 50, 1 );\r\nSellShape = Param( "Sell Shape Typ", def_SellShape, 0, 50, 2 );\r\nBuyshapecolor = ParamColor( "Buy Shape Color", def_BuyShapeColor );\r\nSellshapecolor = ParamColor( "Sell Shape Color", def_SellShapeColor );\r\n_SECTION_END();\r\n\r\nfor ( i = 0; i &lt; 10; i++ )\r\n{\r\n    if ( StrExtract( List1, i ) == SignalType )\r\n        SignalTypeNumber = i;\r\n}\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\n\r\nPivotStyle = ParamStyle( "Pivot", styleThick | styleDots, maskAll ) + styleNoTitle;\r\n\r\nLineStyle = ParamStyle( "S/R Lines", styleThick, maskAll ) + styleNoTitle;\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\n\r\nR12Shadow = ParamColor( "Resistance Shadow", def_R12Shadow );\r\n\r\nRcolor = ParamColor( "Resistance", def_ResistanceColor );\r\n\r\nRPcolor = ParamColor( "Rising Pivot", def_RPcolor );\r\n\r\nFPcolor = ParamColor( "Falling Pivot", def_FPcolor );\r\n\r\nScolor = ParamColor( "Support", def_SupportColor );\r\n\r\nS12Shadow = ParamColor( "Support Shadow", def_S12Shadow );\r\n\r\nBackgroundColor = ParamColor( "Background", def_BackgroundColor );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f14.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nif ( SignalTypeNumber == 1 )\r\n{\r\n    MaxBars = 10;\r\n    Buy = PeTaio() &gt; 0 AND BarsSince( Cross( PeGMA( C, 5 ), PeGMA( C, 10 ) ) )&lt;MaxBars AND Close &gt; PP;\r\n    Sell = PeTaio() &lt; 0 AND BarsSince( Cross( PeGMA( C, 10 ), PeGMA( C, 5 ) ) ) &lt; MaxBars AND Close &lt; PP;\r\n    Short = 0;\r\n    Cover = 0;\r\n    BuyText = "Strategy 1 Buy";\r\n    SellText = "Strategy 1 Sell";\r\n    Buy = ExRem( Buy, Sell );\r\n    Sell = ExRem( Sell, Buy );\r\n    Short = ExRem( Short, Cover );\r\n    Cover = ExRem( Cover, Short );\r\n}\r\nelse\r\n    if ( SignalTypeNumber == 2 )\r\n    {\r\n        BarRef = 1;\r\n        //A signal is generated when the Close on the first bar of the new pivot period\r\n        //is below a level like R1 while it was above the R1 on the previous bar.\r\n        //This behaviour could be confusing, but it is a cross signal.\r\n        //To prevent confusions the default value is set to 1 which means that the first bar is ignored.\r\n        //The value could also be set to zero to use the first bar of the pivot period.\r\n\r\n        Buy =\r\n            IIf( PP == Ref( PP, -1 ),\r\n                 Cross( C, S1 ) OR Cross( C, S2 ) OR Cross( C, S3 ) OR Cross( C, PP ) OR Cross( C, R1 ) OR Cross( C, R2 ) OR Cross( C, R3 ),\r\n                 Cross( C, Ref( S1, -BarRef ) ) OR Cross( C, Ref( S2, -BarRef ) ) OR Cross( C, Ref( S3, -BarRef ) ) OR Cross( C, Ref( PP, -BarRef ) ) OR Cross( C, Ref( R1, -BarRef ) ) OR Cross( C, Ref( R2, -BarRef ) ) OR Cross( C, Ref( R3, -BarRef ) ) );\r\n        BuyText =\r\n            WriteIf( Cross( C, S1 ) AND PP == Ref( PP, -1 ), "Close crossed S1 upwards",\r\n                     WriteIf( Cross( C, S2 ) AND PP == Ref( PP, -1 ), "Close crossed S2 upwards",\r\n                              WriteIf( Cross( C, S3 ) AND PP == Ref( PP, -1 ), "Close crossed S3 upwards",\r\n                                       WriteIf( Cross( C, PP ) AND PP == Ref( PP, -1 ), "Close crossed PP upwards",\r\n                                                WriteIf( Cross( C, R1 ) AND PP == Ref( PP, -1 ), "Close crossed R1 upwards",\r\n                                                         WriteIf( Cross( C, R2 ) AND PP == Ref( PP, -1 ), "Close crossed R2 upwards",\r\n                                                                  WriteIf( Cross( C, R3 ) AND PP == Ref( PP, -1 ), "Close crossed R3 upwards",\r\n                                                                           WriteIf( Cross( C, Ref( S1, -BarRef ) ) AND PP != Ref( PP, -1 ), "Close crossed S1 upwards",\r\n                                                                                    WriteIf( Cross( C, Ref( S2, -BarRef ) ) AND PP != Ref( PP, -1 ), "Close crossed S2 upwards",\r\n                                                                                             WriteIf( Cross( C, Ref( S3, -BarRef ) ) AND PP != Ref( PP, -1 ), "Close crossed S3 upwards",\r\n                                                                                                      WriteIf( Cross( C, Ref( PP, -BarRef ) ) AND PP != Ref( PP, -1 ), "Close crossed PP upwards",\r\n                                                                                                               WriteIf( Cross( C, Ref( R1, -BarRef ) ) AND PP != Ref( PP, -1 ), "Close crossed R1 upwards",\r\n                                                                                                                        WriteIf( Cross( C, Ref( R2, -BarRef ) ) AND PP != Ref( PP, -1 ), "Close crossed R2 upwards",\r\n                                                                                                                                 WriteIf( Cross( C, Ref( R3, -BarRef ) ) AND PP != Ref( PP, -1 ), "Close crossed R3 upwards", "" ) ) ) ) ) ) ) ) ) ) ) ) ) );\r\n\r\n        SellText =\r\n            WriteIf( Cross( S1, C ) AND PP == Ref( PP, -1 ), "Close crossed S1 downwards",\r\n                     WriteIf( Cross( S2, C ) AND PP == Ref( PP, -1 ), "Close crossed S2 downwards",\r\n                              WriteIf( Cross( S3, C ) AND PP == Ref( PP, -1 ), "Close crossed S3 downwards",\r\n                                       WriteIf( Cross( PP, C ) AND PP == Ref( PP, -1 ), "Close crossed PP downwards",\r\n                                                WriteIf( Cross( R1, C ) AND PP == Ref( PP, -1 ), "Close crossed R1 downwards",\r\n                                                         WriteIf( Cross( R2, C ) AND PP == Ref( PP, -1 ), "Close crossed R2 downwards",\r\n                                                                  WriteIf( Cross( R3, C ) AND PP == Ref( PP, -1 ), "Close crossed R3 downwards",\r\n                                                                           WriteIf( Cross( Ref( S1, -BarRef ), C ) AND PP != Ref( PP, -1 ), "Close crossed S1 downwards",\r\n                                                                                    WriteIf( Cross( Ref( S2, -BarRef ), C ) AND PP != Ref( PP, -1 ), "Close crossed S2 downwards",\r\n                                                                                             WriteIf( Cross( Ref( S3, -BarRef ), C ) AND PP != Ref( PP, -1 ), "Close crossed S3 downwards",\r\n                                                                                                      WriteIf( Cross( Ref( PP, -BarRef ), C ) AND PP != Ref( PP, -1 ), "Close crossed PP downwards",\r\n                                                                                                               WriteIf( Cross( Ref( R1, -BarRef ), C ) AND PP != Ref( PP, -1 ), "Close crossed R1 downwards",\r\n                                                                                                                        WriteIf( Cross( Ref( R2, -BarRef ), C ) AND PP != Ref( PP, -1 ), "Close crossed R2 downwards",\r\n                                                                                                                                 WriteIf( Cross( Ref( R3, -BarRef ), C ) AND PP != Ref( PP, -1 ), "Close crossed R3 downwards", "" ) ) ) ) ) ) ) ) ) ) ) ) ) );\r\n\r\n\r\n        Sell =\r\n            IIf( PP == Ref( PP, -1 ),\r\n                 Cross( S1, C ) OR Cross( S2, C ) OR Cross( S3, C ) OR Cross( PP, C ) OR Cross( R1, C ) OR Cross( R2, C ) OR Cross( R3, C ),\r\n                 Cross( Ref( S1, -BarRef ), C ) OR Cross( Ref( S2, -BarRef ), C ) OR Cross( Ref( S3, -BarRef ), C ) OR Cross( Ref( PP, -BarRef ), C ) OR Cross( Ref( R1, -BarRef ), C ) OR Cross( Ref( R2, -BarRef ), C ) OR Cross( Ref( R3, -BarRef ), C ) );\r\n        Short = 0;\r\n        Cover = 0;\r\n    }\r\n    else\r\n    {\r\n        Buy = 0;\r\n        Sell = 0;\r\n        Short = 0;\r\n        Cover = 0;\r\n        BuyText = "";\r\n        SellText = "";\r\n    }\r\n\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nAddAlert( Buy, Audio, Email, BuyText, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( Sell, Audio, Email, SellText, 2, BarComplete, def_SellSound1 );\r\n\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nif ( UseExrem )\r\n{\r\n    Buy = ExRem( Buy, Sell );\r\n    Sell = ExRem( Sell, Buy );\r\n    Short = ExRem( Short, Cover );\r\n    Cover = ExRem( Cover, Short );\r\n}\r\n\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( Buy OR Sell );\r\n\r\nAddefaultcolumns();\r\n\r\nAdddefaultcolumns( 2, 1 );\r\n\r\nAddTextColumn( SignalType, "Selected Strategy" );\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nPlotPivotLevels( LineMode, PivotLineMode, SColor, RColor, RPColor, FPColor, LineStyle, PivotStyle );\r\n\r\nPlotShapes( BuyShape*Buy, BuyShapecolor, 0, L, -def_BuyShapeOffset );\r\n\r\nPlotShapes( SellShape*Sell, SellShapecolor, 0, H, -def_SellShapeOffset );\r\n\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nif ( Titledisplay )\r\n{\r\n    Title = "PatternExplorer.com - Pivot Points" + default_priceTitle +\r\n            ",Calculation Time Frame = " + PivotTF + "  " +\r\n            EncodeColor( Rcolor ) + "\\nR3 = " + WriteVal( R3, digits ) +\r\n            EncodeColor( Rcolor ) + "\\nR2 = " + WriteVal( R2, digits ) +\r\n            EncodeColor( Rcolor ) + "\\nR1 = " + WriteVal( R1, digits ) +\r\n            EncodeColor( IIf( LastValue( ppflip ), RPcolor, FPcolor ) ) + "\\nPP = " + WriteVal( PP, digits ) +\r\n            EncodeColor( Scolor ) + "\\nS1 = " + WriteVal( S1, digits ) +\r\n            EncodeColor( Scolor ) + "\\nS2 = " + WriteVal( S2, digits ) +\r\n            EncodeColor( Scolor ) + "\\nS3 = " + WriteVal( S3, digits );\r\n}\r\nelse\r\n{\r\n    Title = "PatternExplorer.com - Pivot Points" + default_priceTitle +\r\n            ", Calculation Time Frame = " + PivotTF + ",  " +\r\n            EncodeColor( Scolor ) + "S1 = " + WriteVal( S1, digits ) + ", " +\r\n            EncodeColor( Scolor ) + "S2 = " + WriteVal( S2, digits ) + ", " +\r\n            EncodeColor( Scolor ) + "S3 = " + WriteVal( S3, digits ) + ", " +\r\n            EncodeColor( IIf( LastValue( ppflip ), RPcolor, FPcolor ) ) + "PP = " + WriteVal( PP, digits ) + ", " +\r\n            EncodeColor( Rcolor ) + "R1 = " + WriteVal( R1, digits ) + ", " +\r\n            EncodeColor( Rcolor ) + "R2 = " + WriteVal( R2, digits ) + ", " +\r\n            EncodeColor( Rcolor ) + "R3 = " + WriteVal( R3, digits ) + "  ";\r\n}\r\n\r\n//The following lines can be used to plot single pivot levels\r\nAddSinglePivotLevel( "Level 1", def_PLevel = 0, def_TF = 3, def_color = colorcycle, style = 1 );\r\n\r\nAddSinglePivotLevel( "Level 2", def_PLevel = 0, def_TF = 4, def_color = colorcycle, style = 1 );\r\n\r\nAddSinglePivotLevel( "Level 3", def_PLevel = 0, def_TF = 5, def_color = colorcycle, style = 1 );\r\n\r\nAddSinglePivotLevel( "Level 4", def_PLevel = 0, def_TF = 4, def_color = colorcycle, style = 1 );\r\n\r\nAddSinglePivotLevel( "Level 5", def_PLevel = 0, def_TF = 4, def_color = colorcycle, style = 1 );\r\n\r\nAddSinglePivotLevel( "Level 6", def_PLevel = 0, def_TF = 4, def_color = colorcycle, style = 1 );\r\n\r\nAddSinglePivotLevel( "Level 7", def_PLevel = 0, def_TF = 4, def_color = colorcycle, style = 1 );\r\n\r\nAddSinglePivotLevel( "Level 8", def_PLevel = 0, def_TF = 4, def_color = colorcycle, style = 1 );\r\n/*******************************************************************************************/\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Pivots 3.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>473.771</Min>
			<Max>1058.68</Max>
		</Pane>
		<Pane>
			<ChartID>1059</ChartID>
			<PercentHeight>48</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Support &amp; Resistance\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - S &amp; R";\r\n\r\nSetChartOptions( 0, chartShowDates | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n\r\n_SECTION_BEGIN( "Main Parameters" );\r\nAddparamUsefromChart( def_UseFromChart );\r\nSensitivity = Param( "Sensitivity", 10, 0, 100, 1 );\r\n\r\nif ( InChart )\r\n    StaticVarSet( "FYIOKU", Sensitivity );\r\n\r\nif ( inAA AND Usefromchart )\r\n    Sensitivity = StaticVarGet( "FYIOKU" );\r\n\r\nDisRange = Param( "Plot 'far away' Lines Trigger", 3, 0, 10, 0.5 );\r\n\r\nColor_SL =  ParamColor( "Support", def_Color1 );\r\n\r\nColor_RL =  ParamColor( "Resistance", colorRed );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f15.afl&gt;\r\n/*******************************************************************************************/\r\nBS = break_G1_val == 1 OR break_G2_val == 1;\r\n\r\nSS = break_G1_val == -1 OR break_G2_val == -1;\r\n\r\nBuy = def_Buy AND BS;\r\n\r\nSell = SS;\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND BarIndex() == LastValue( BarIndex() ) AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( Buy OR Sell );\r\n\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\n\r\nAdddefaultcolumns( 2, 1 );\r\n\r\nAddTextColumn(\r\n    WriteIf( break_G1_val == -1, "Break",\r\n             WriteIf( break_G1_val == 1, "Break", "" ) ), "Minor Levels", 1.2,\r\n    IIf( break_G1_val == 1, colorGreen, IIf( break_G1_val == -1, colorRed, colorBlue ) ) );\r\n\r\nAddTextColumn(\r\n    WriteIf( break_G2_val == -1, "Break",\r\n             WriteIf( break_G2_val == 1, "Break", "" ) ), "Major Levels", 1.2,\r\n    IIf( break_G2_val == 1, colorGreen, IIf( break_G2_val == -1, colorRed, colorBlue ) ) );\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nPlot( IIf( x &gt;= XT1 &amp; RT1 &amp;NOT T1 == 0, T1, -1e10 ), "T1", IIf( LastValue( C ) &lt; T1, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XT2 &amp; RT2 &amp;NOT T2 == 0, T2, -1e10 ), "T2", IIf( LastValue( C ) &lt; T2, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XT3 &amp; RT3 &amp;NOT T3 == 0, T3, -1e10 ), "T3", IIf( LastValue( C ) &lt; T3, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XT4 &amp; RT4 &amp;NOT T4 == 0, T4, -1e10 ), "T4", IIf( LastValue( C ) &lt; T4, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XT5 &amp; RT5 &amp;NOT T5 == 0, T5, -1e10 ), "T5", IIf( LastValue( C ) &lt; T5, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XP1 &amp; RP1 &amp;NOT P1 == 0, P1, -1e10 ), "P1", IIf( LastValue( C ) &lt; P1, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XP2 &amp; RP2 &amp;NOT P2 == 0, P2, -1e10 ), "P2", IIf( LastValue( C ) &lt; P2, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XP3 &amp; RP3 &amp;NOT P3 == 0, P3, -1e10 ), "P3", IIf( LastValue( C ) &lt; P3, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XP4 &amp; RP4 &amp;NOT P4 == 0, P4, -1e10 ), "P4", IIf( LastValue( C ) &lt; P4, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XP5 &amp; RP5 &amp;NOT P5 == 0, P5, -1e10 ), "P5", IIf( LastValue( C ) &lt; P5, Color_RL, Color_SL ), 1 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XT6 &amp; RT6 &amp;NOT T6 == 0, T6, -1e10 ), "T6", IIf( LastValue( C ) &lt; T6, Color_RL, Color_SL ), 8 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XT7 &amp; RT7 &amp;NOT T7 == 0, T7, -1e10 ), "T7", IIf( LastValue( C ) &lt; T7, Color_RL, Color_SL ), 8 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XP6 &amp; RP6 &amp;NOT P6 == 0, P6, -1e10 ), "P6", IIf( LastValue( C ) &lt; P6, Color_RL, Color_SL ), 8 + 2048 + styleNoTitle );\r\n\r\nPlot( IIf( x &gt;= XP7 &amp; RP7 &amp;NOT P7 == 0, P7, -1e10 ), "P7", IIf( LastValue( C ) &lt; P7, Color_RL, Color_SL ), 8 + 2048 + styleNoTitle );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Support &amp; Resistance" + default_priceTitle + EncodeColor( IIf( NOT AnZ, def_Text2, colorRed ) ) + ",Sensitivity = " + WriteVal( Sensitivity, 1 ) + "     " + EncodeColor( colorRed ) + WriteIf( NOT AnZ, "", "  NO POINTS AVAILABLE -&gt; REDUCE SENSITIVITY " );\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - S &amp; R 3.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741847</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE-Alerts</Name>
		<Pane>
			<ChartID>1066</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Alert 1 Price based\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Alert 1 - Price";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert = 1, def_EmailAlert, def_BarComplete );\r\n_SECTION_BEGIN( "Main Parameters" );\r\nSwitch2 = ParamToggle( "Points/Percent", "Points,Percent", 1 );\r\nCentering = ParamToggle( "Range Centering", "Off,On", 1 );\r\nOffset = Param( "Maximum Deviation", 0.5, 0.0, 5, 0.01 );\r\nSuRangeColor = ParamColor( "Support Range", colorGreen );\r\nReRangeColor = ParamColor( "Resistance Range", colorRed );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f02.afl&gt;\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\nAddAlert( Buy_1, Audio, Email, "Close in Support Range", 1, BarComplete, def_BuySound1 );\r\nAddAlert( Buy_2, Audio, Email, "Resistance broken", 1, BarComplete, def_BuySound2 );\r\nAddAlert( Sell_1, Audio, Email, "Support broken", 2, BarComplete, def_SellSound1 );\r\nAddAlert( Sell_2, Audio, Email, "Close in Resistance Range", 2, BarComplete, def_SellSound2 );\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND ( Buy_1 OR Buy_2 );\r\nSell = def_Sell AND ( Sell_1 OR sell_2 );\r\n/*******************************************************************************************/\r\nPlot( IIf( Lx, SuAL_L, Null ), "", SuRangeColor, styleNoRescale, 0, 0, Shift );\r\nPlot( IIf( Lx, SuAL_H, Null ), "", SuRangeColor, styleNoRescale, 0, 0, Shift );\r\nPlot( IIf( Lx, ReAL_L, Null ), "", ReRangeColor, styleNoRescale, 0, 0, Shift );\r\nPlot( IIf( Lx, ReAL_H, Null ), "", ReRangeColor, styleNoRescale, 0, 0, Shift );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\nAddCustomCodeAfterPE();\r\n\r\nTitle = "PatternExplorer.com - Alert 1" + default_priceTitle\r\n        + EncodeColor( SuRangeColor ) + ", Support: " + WriteVal( LastValue( Study( "SU", GetChartID() ) ), digits2 )\r\n        + " (" + WriteVal( SuAL_L , digits2 ) + "-" + WriteVal( SuAL_H, digits2 ) + "), "\r\n        + EncodeColor( ReRangeColor ) + "Resistance: " + WriteVal( LastValue( Study( "RE", GetChartID() ) ), digits2 )\r\n        + " (" + WriteVal( ReAL_L, digits2 ) + "-" + WriteVal( ReAL_H, digits2 ) + "), "\r\n        + EncodeColor( def_Text2 ) + "" + "Max. Deviation: " + WriteVal( Offset, 1.2 )\r\n        + WriteIf( switch2, " %, ", " points, " ) + EncodeColor( def_Text1 ) + "Activated Alerts:"\r\n        + WriteIf( Audio AND NOT Email, " Audio ",\r\n                   WriteIf( Email AND NOT Audio, " Email ",\r\n                            WriteIf( Email AND Audio, " Audio &amp; Email ", " None " ) ) )\r\n        + WriteIf( Nd &gt; 0, "\\n", "" )\r\n        + EncodeColor( colorRed ) + WriteIf( Nd == 1, "SU not defined ",\r\n                                             WriteIf( Nd == 2, "RE not defined", WriteIf( Nd == 3, "SU &amp; RE not defined - No Alerts ", "" ) ) );\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Alert 1 - Price 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
		<Pane>
			<ChartID>1067</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Alert 2 Indicator based\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Alert 2 - Indicator";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n//AddparamUsefromChartFull(0);\r\nAddAlertParam( def_AudioAlert = 1, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Indicator Periods" );\r\nperiod1 = Param( "Period 1", 5, 1, 30, 1 );\r\nperiod2 = Param( "Period 2", 8, 1, 30, 1 );\r\n//if(InChart) StaticVarSet("X34320",period1);if(inAA AND Usefromchart) period1 = StaticVarGet("X34320");\r\n//if(InChart) StaticVarSet("X059df",period2);if(inAA AND Usefromchart) period2 = StaticVarGet("X059df");\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nOffset = Param( "Maximum Deviation", 20, 0.01, 200, 0.01 );\r\n//if(InChart) StaticVarSet("X0S2V0",Offset);if(inAA AND Usefromchart) Offset = StaticVarGet("X0S2V0");\r\nCentering = ParamToggle( "Range Centering", "Off,On", 0 );\r\n//if(InChart) StaticVarSet("C3A8G2",Centering);if(inAA AND Usefromchart) Centering = StaticVarGet("C3A8G2");\r\nRE = Param( "Upper Level", 100, -100, 100, 1 );\r\n//if(InChart) StaticVarSet("G8A7E1",RE);if(inAA AND Usefromchart) RE = StaticVarGet("G8A7E1");\r\nSU = Param( "Lower Level", -100, -100, 100, 1 );\r\n//if(InChart) StaticVarSet("W5R0Q2",SU);if(inAA AND Usefromchart) SU = StaticVarGet("W5R0Q2");\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\nIndstyle = ParamStyle( "Indicator", styleLine, maskAll );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\nReColor = ParamColor( "Upper Range", colorRed );\r\nSuColor = ParamColor( "Lower Range", colorGreen );\r\nIndcolor = ParamColor( "Indicator", def_IndicatorColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n/*******************************************************************************************/\r\nInd = PeTaio( period1, period2 ); //Enter your indicator here\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f03.afl&gt;\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND ( Buy_1 OR Buy_2 );\r\nSell = def_Sell AND ( Sell_1 OR Sell_2 );\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nFilter = Filter AND ( Buy OR Sell );\r\n/*******************************************************************************************/\r\nAddAlert( Buy_1, Audio, Email, "Indicator in Lower Range", 1, BarComplete, def_BuySound1 );\r\nAddAlert( Buy_2, Audio, Email, "Indicator left Lower Range", 1, BarComplete, def_BuySound2 );\r\nAddAlert( Sell_2, Audio, Email, "Indicator in Upper Range", 2, BarComplete, def_SellSound1 );\r\nAddAlert( Sell_1, Audio, Email, "Indicator left Upper Range", 2, BarComplete, def_SellSound2 );\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\nAdddefaultcolumns( 2, 1 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\nPlot( Ind, "Indicator", Indcolor, Indstyle );\r\nPlot( SU, "Low-Level", SuColor, styleDashed );\r\nPlot( RE, "High-Level", ReColor, styleDashed );\r\nPlot( IIf( Lx, SuAL_L, Null ), "", SuColor, styleNoRescale + styleNoLabel, 0, 0, Shift );\r\nPlot( IIf( Lx, SuAL_H, Null ), "", SuColor, styleNoRescale, 0, 0, Shift );\r\nPlot( IIf( Lx, ReAL_L, Null ), "", ReColor, styleNoRescale, 0, 0, Shift );\r\nPlot( IIf( Lx, ReAL_H, Null ), "", ReColor, styleNoRescale + styleNoLabel, 0, 0, Shift );\r\n/*******************************************************************************************/\r\nToolTip = def_Tooltip;\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Alert 2, " +\r\n        StrFormat( " - {{NAME}} - {{INTERVAL}} {{DATE}}, " ) +\r\n        EncodeColor( Sucolor ) + "Low Level: " + WriteVal( SU, 1.0 ) +\r\n        " (" + WriteVal( SuAL_L, 1.1 ) + " to " + WriteVal( SuAL_H, 1.0 ) + "), " +\r\n        EncodeColor( Recolor ) + "High Level: " + WriteVal( RE, 1.0 ) +\r\n        " (" + WriteVal( ReAL_L, 1.0 ) + " to " + WriteVal( ReAL_H, 1.0 ) + "), " +\r\n        EncodeColor( def_Text2 ) + "Max. Deviation = " + WriteVal( Offset, 1.0 ) + " Points, " +\r\n        EncodeColor( def_Text1 ) + "Activated Alerts:"\r\n        + WriteIf( Audio AND NOT Email, " Audio ",\r\n                   WriteIf( Email AND NOT Audio, " Email ",\r\n                            WriteIf( Email AND Audio, " Audio &amp; Email ", " None " ) ) );\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Alert 2 - Indicator 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741843</MoreFlags>
			<Min>-104</Min>
			<Max>110.24</Max>
		</Pane>
		<Pane>
			<ChartID>1068</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>_SECTION_BEGIN("PE - Alert 3");\r\n//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Alert 3 - Custom Condition\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Alert 3 - Custom";\r\n\r\nSetChartOptions( 0, chartShowDates | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\nAddAlertParam( def_AudioAlert = 1, def_EmailAlert, def_BarComplete );\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n//The following part is used to define your personal signals.\r\n//Please save a copy of this file under another name to assure that your modifications\r\n//will NOT be overwritten when installing PatternExplorer updates.\r\n//Write = 0; to deativate alerts. Example: Short = 0;\r\n\r\nBuy = def_Buy AND Ref( PeTaio(), -1 ) == LLV( PeTaio(), 3 )AND Ref( PeTaio(), -1 ) &lt; -80;//Your buy condition\r\nBuytext = "Sample buy signal";\r\n\r\nSell = def_Sell AND Ref( PeTaio(), -1 ) == HHV( PeTaio(), 3 )AND Ref( PeTaio(), -1 ) &gt; 80;//Your sell condition\r\nSelltext = "Sample sell signal";\r\n\r\nShort = def_Short AND Cross( 80, StochD() ); //Your short condition\r\nShorttext = "Sample short signal";\r\n\r\nCover = def_Cover AND Cross( StochD(), 20 ); //Your cover condition\r\nCovertext = "Sample cover signal";\r\n/*******************************************************************************************/\r\n\r\n/*\r\nYou can use the following code block to use buy signals only if last long trade was closed and\r\nshort signals only if last short trade was closed.\r\nBuy = ExRem(Buy,Sell);\r\nSell = ExRem(Sell,Buy);\r\nCover = ExRem(Cover,Short);\r\nShort = ExRem(Short,Cover);\r\n*/\r\n\r\n\r\n/*\r\nThe code below shows some basic implementation of stops AND profits with optimization.\r\n\r\nDigits = 0.001;\r\nTakeProfit=Optimize("profit",0.001*Digits,0.0006*Digits,0.002*Digits,0.0001*Digits);\r\nLossStop=Optimize("stop",0.0009*Digits,0.0006*Digits,0.002*Digits,0.0001*Digits);\r\nApplyStop(type = 0, mode = 2, amount = LossStop, exitatstop = 1, volatile = False, ReEntryDelay = 0 );\r\nApplyStop(type = 1, mode = 2, amount = Takeprofit, exitatstop = 1, volatile = False, ReEntryDelay = 0 );\r\n\r\n*/\r\n\r\n//Equity(1); //This line will also plot your exits at applystop/takeprofit\r\n\r\n/*******************************************************************************************/\r\nAddAlert( Buy, Audio, Email, Buytext, 1, BarComplete, def_BuySound1 );\r\nAddAlert( Sell, Audio, Email, Selltext, 2, BarComplete, def_SellSound1 );\r\nAddAlert( Short, Audio, Email, Shorttext, 3, BarComplete, def_ShortSound1 );\r\nAddAlert( Cover, Audio, Email, Covertext, 4, BarComplete, def_CoverSound1 );\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nFilter = Filter AND ( Buy OR Sell OR Short OR Cover );\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\nAdddefaultcolumns( 3, 1 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\nPlotShapes( def_BuyShape*Buy, def_BuyShapeColor, layer = 0, yposition = Low, offset = -def_BuyShapeOffset );\r\nPlotShapes( def_SellShape*Sell, def_SellShapeColor, layer = 0, yposition = High, offset = -def_SellShapeOffset );\r\nPlotShapes( def_ShortShape*Short, def_ShortShapeColor, layer = 0, yposition = High, offset = -def_ShortShapeOffset );\r\nPlotShapes( def_CoverShape*Cover, def_CoverShapeColor, layer = 0, yposition = Low, offset = -def_CoverShapeOffset );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Alert 3" + default_priceTitle\r\n        + EncodeColor( def_Text1 ) + ", Activated Alerts:"\r\n        + WriteIf( Audio AND NOT Email, " Audio ",\r\n                   WriteIf( Email AND NOT Audio, " Email ",\r\n                            WriteIf( Email AND Audio, " Audio &amp; Email ", " None " ) ) );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Alert 3 - Custom 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741847</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE-Basic #1</Name>
		<Pane>
			<ChartID>1060</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - AT - Guppy Multiple Moving Average\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Guppy MMA";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\nAddAvgTypeParam( 3 );\r\nShapes = ParamToggle( "Plot Shapes", "Off,On", 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nAvgTextname2 = AvgTextname;\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Section 1 - Periods" );\r\nP1 = Average( C, Param( "Avg 1", 3, 1, 100, 1 ), AvgType );\r\nP2 = Average( C, Param( "Avg 2", 5, 1, 100, 1 ), AvgType );\r\nP3 = Average( C, Param( "Avg 3", 8, 1, 100, 1 ), AvgType );\r\nP4 = Average( C, Param( "Avg 4", 10, 1, 100, 1 ), AvgType );\r\nP5 = Average( C, Param( "Avg 5", 12, 1, 100, 1 ), AvgType );\r\nP6 = Average( C, Param( "Avg 6", 15, 1, 100, 1 ), AvgType );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Section 2 - Periods" );\r\nP7 = Average( C, Param( "Avg 7", 30, 1, 100, 1 ), AvgType );\r\nP8 = Average( C, Param( "Avg 8", 35, 1, 100, 1 ), AvgType );\r\nP9 = Average( C, Param( "Avg 9", 40, 1, 100, 1 ), AvgType );\r\nP10 = Average( C, Param( "Avg 10", 45, 1, 100, 1 ), AvgType );\r\nP11 = Average( C, Param( "Avg 11", 50, 1, 100, 1 ), AvgType );\r\nP12 = Average( C, Param( "Avg 12", 55, 1, 100, 1 ), AvgType );\r\nP13 = Average( C, Param( "Avg 13", 60, 1, 100, 1 ), AvgType );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\nStyle1 = ParamStyle( "Section 1", def_GuppyLineStyle, maskAll );\r\nStyle2 = ParamStyle( "Section 2", def_GuppyLineStyle, maskAll );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Colors" );\r\nColor1 = ParamColor( "Section 1", def_GuppyLineColor1 );\r\nColor2 = ParamColor( "Section 2", def_GuppyLineColor2 );\r\n_SECTION_END();\r\n_SECTION_BEGIN( "Shape Types" );\r\nBuyshape = Param( "Buy", def_BuyShape, 0, 50, 1 );\r\nSellShape = Param( "Sell", def_SellShape, 0, 50, 1 );\r\n//ShortShape = Param("Short",def_ShortShape,0,50,1);\r\n//Covershape = Param("Cover",def_CoverShape,0,50,1);\r\n_SECTION_END();\r\n_SECTION_BEGIN( "Shape Colors" );\r\nBuyshapecolor = ParamColor( "Buy Shape", def_BuyShapeColor );\r\nSellshapecolor = ParamColor( "Sell Shape", def_SellShapeColor );\r\n//Shortshapecolor = ParamColor("Short Shape",def_ShortShapeColor);\r\n//Covershapecolor = ParamColor("Cover Shape",def_CoverShapeColor);\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nPlot( P1, "Avg 1", Color1, style1 + styleNoTitle + styleNoLabel );\r\nPlot( P2, "Avg 2", Color1, style1 + styleNoTitle + styleNoLabel );\r\nPlot( P3, "Avg 3", Color1, style1 + styleNoTitle + styleNoLabel );\r\nPlot( P4, "Avg 4", Color1, style1 + styleNoTitle + styleNoLabel );\r\nPlot( P5, "Avg 5", Color1, style1 + styleNoTitle + styleNoLabel );\r\nPlot( P6, "Avg 6", Color1, style1 + styleNoTitle + styleNoLabel );\r\nPlot( P7, "Avg 7", Color2, style2 + styleNoTitle + styleNoLabel );\r\nPlot( P8, "Avg 8", Color2, style2 + styleNoTitle + styleNoLabel );\r\nPlot( P9, "Avg 9", Color2, style2 + styleNoTitle + styleNoLabel );\r\nPlot( P10, "Avg 10", Color2, style2 + styleNoTitle + styleNoLabel );\r\nPlot( P11, "Avg 11", Color2, style2 + styleNoTitle + styleNoLabel );\r\nPlot( P12, "Avg 12", Color2, style2 + styleNoTitle + styleNoLabel );\r\nPlot( P13, "Avg 13", Color2, style2 + styleNoTitle + styleNoLabel );\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND Cross ( P1, P8 ) AND P1 &gt; P13;\r\nSell = def_Sell AND Cross( P8, P1 ) AND P1 &lt; P13;\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nFilter = Filter AND ( Buy OR Sell );\r\nAddefaultcolumns();\r\nAdddefaultcolumns( 2, 1 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\n//Equity(1,0);\r\nPlotShapes( IIf( Buy AND Shapes, Buyshape, Null ), Buyshapecolor, 0, L, -def_BuyShapeOffset );\r\nPlotShapes( IIf( Sell AND Shapes, Sellshape, Null ), Sellshapecolor, 0, H, -def_SellShapeOffset );\r\n\r\nAddAlert( Cross( P1, P8 ) AND P1 &gt; P13, Audio, Email, "Traders-Average crossed Investors-Average", 1, BarComplete, def_BuySound1 );\r\nAddAlert( Cross( P8, P1 ) AND P1 &lt; P13, Audio, Email, "Investors-Average crossed Traders-Average", 2, BarComplete, def_SellSound1 );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - GMMA - " + EncodeColor( def_Color1 ) + "Type " + AvgTextname2 + EncodeColor( colorDefault ) + default_priceTitle + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Guppy MMA 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
		<Pane>
			<ChartID>1061</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Ichimoku Chart\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Ichimoku Chart";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\np1 = Param( "Turning Line", 9, 5, 20, 1 );//also known as Kijun Sen\r\np2 = Param( "Standard Line", 26, 5, 40, 1 );//also known as Tenkan Sen\r\np3 = Param( "Delayed Line", 26, 0, 40, 1 );//also known as Chikou Span\r\np4 = Param( "Cloud F-Bars", 26, 0, 40, 1 );//also known as Chikou Span\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Buy and Sell Signals" );\r\nStrategy = ParamList( "Strategy", List1 = "1: Tenkan Sen/Kijun Sen Cross" );//,2: ,3: ,4: ,5: ",0);\r\nMinStrength = ParamList( "Min Signal Strength", List2 = "1 - Weak,2 - Mid,3 - Strong,4 - Only best", 2 );\r\n\r\nfor ( i = 0; i &lt; 10; i++ )\r\n{\r\n    if ( StrExtract( List1, i ) == Strategy )\r\n        SelectedStrategy = i + 1;\r\n}\r\n\r\nfor ( i = 0; i &lt; 10; i++ )\r\n{\r\n    if ( StrExtract( List2, i ) == MinStrength )\r\n        SelectedMinStrength = i + 1;\r\n}\r\n\r\nBuyShape = Param( "Buy Shape Typ", def_BuyShape, 0, 50, 1 );\r\n\r\nSellShape = Param( "Sell Shape Typ", def_SellShape, 0, 50, 2 );\r\nBuyshapecolor = ParamColor( "Buy Shape Color", def_BuyShapeColor );\r\nSellshapecolor = ParamColor( "Sell Shape Color", def_SellShapeColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\nTLstyle = ParamStyle( "Turning Line", styleThick );\r\nSLstyle = ParamStyle( "Standard Line", styleThick );\r\nDLstyle = ParamStyle( "Delayed Line", styleThick | styleNoTitle );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nGraphZOrder = 0;\r\nAddICHIMOKU2( p1, p2, p3, p4 );\r\nHSB = 0;\r\n/*******************************************************************************************/\r\n\r\nif ( HSB )\r\n{\r\n    _SECTION_BEGIN( "Cloud 1" );\r\n    Hue = Param( "Hue", 90, 0, 255, 1 );\r\n    Saturation = Param( "Saturation", 255, 0, 255, 1 );\r\n    Brightness = Param( "Brightness", 60, 0, 255, 1 );\r\n    Cloud1color = ColorHSB( Hue, Saturation, Brightness );\r\n    _SECTION_END();\r\n\r\n    _SECTION_BEGIN( "Cloud 2" );\r\n    Hue = Param( "Hue", 0, 0, 255, 1 );\r\n    Saturation = Param( "Saturation", 180, 0, 255, 1 );\r\n    Brightness = Param( "Brightness", 125, 0, 255, 1 );\r\n    Cloud2color = ColorHSB( Hue, Saturation, Brightness );\r\n    _SECTION_END();\r\n}\r\nelse\r\n{\r\n    _SECTION_BEGIN( "Colors" );\r\n    TLcolor = ParamColor( "Turning Line", def_Color3 );\r\n    SLcolor = ParamColor( "Standard Line", def_StandardLine );\r\n    DLcolor = ParamColor( "Delayed Line", colorGrey50 );\r\n    Cloud1color = ParamColor( "Cloud 1", def_Cloud1color );\r\n    Cloud2color = ParamColor( "Cloud 2", def_Cloud2color );\r\n    _SECTION_END();\r\n}\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\nGraphZOrder = 0;\r\n\r\n/*******************************************************************************************/\r\n//Strategy 1: Tenkan Sen/Kijun Sen Cross\r\nMinTLSL = Min( TL, SL );\r\n\r\nMaxTLSL = Max( TL, SL );\r\n\r\nBuyPositionTLSL_1 = IIf( MinTLSL &gt; CloudHigh, 3, IIf( MinTLSL &gt; CloudLow AND MaxTLSL &lt; CloudHigh, 2, 1 ) );\r\n\r\nSellPositionTLSL_1 = IIf( MaxTLSL &lt; CloudLow, 3, IIf( MinTLSL &gt; CloudLow AND MaxTLSL &lt; CloudHigh, 2, 1 ) );\r\n\r\nBuyStrength_1 =  BuyPositionTLSL_1 + IIf( RDL, 1, -1 );\r\n\r\nSellStrength_1 = SellPositionTLSL_1 + IIf( FDL, 1, -1 );\r\n\r\nBuy_1 = Cross( TL, SL ) AND BuyStrength_1 &gt;= SelectedMinStrength;\r\n\r\nSell_1 = Cross( SL, TL ) AND SellStrength_1 &gt;= SelectedMinStrength;\r\n\r\nStrength_1 = IIf( Buy_1, BuyStrength_1, IIf( Sell_1, SellStrength_1, 0 ) );\r\n\r\nInterpretation = "\\n" + "Strategy = " + "\\n" + Strategy + "\\n\\n";\r\n\r\nBuyInterpretation1 =\r\n    WriteIf( BuyPositionTLSL_1 == 3, "The cross happend above the cloud, this is a strong signal and gives 3 ranking points.",\r\n             WriteIf( BuyPositionTLSL_1 == 2, "The cross happend inside the cloud, this is a mid signal and gives 2 ranking points.",\r\n                      WriteIf( BuyPositionTLSL_1 == 1, "The cross happend below the cloud, this is a weak signal and gives 1 ranking point.", "" ) ) );\r\n\r\nBuyInterpretation1 = BuyInterpretation1 +\r\n                     WriteIf( BuyStrength_1 == BuyPositionTLSL_1 + 1, "\\n\\nDelayed line is above past close. This shows rising prices and gives 1 ranking point.",\r\n                              WriteIf( BuyStrength_1 == BuyPositionTLSL_1 - 1, "\\n\\nDelayed line is below past close. This shows falling prices and gives -1 ranking point.", "" ) );\r\n\r\nSellInterpretation1 =\r\n    WriteIf( SellPositionTLSL_1 == 3, "The cross happend below the cloud, this is a strong signal and gives 3 ranking points.",\r\n             WriteIf( SellPositionTLSL_1 == 2, "The cross happend inside the cloud, this is a mid signal and gives 2 ranking points.",\r\n                      WriteIf( SellPositionTLSL_1 == 1, "The cross happend above the cloud, this is a weak signal and gives 1 ranking point.", "" ) ) );\r\n\r\nSellInterpretation1 = SellInterpretation1 +\r\n                      WriteIf( SellStrength_1 == SellPositionTLSL_1 + 1, "\\n\\nDelayed line is below past close. This shows falling prices and gives 1 ranking point.",\r\n                               WriteIf( SellStrength_1 == SellPositionTLSL_1 - 1, "\\n\\nDelayed line is above past close. This shows rising prices and gives -1 ranking point.", "" ) );\r\n\r\nInterpretation = Interpretation +\r\n                 WriteIf( Buy_1, Buyinterpretation1, WriteIf( Sell_1, Sellinterpretation1, "" ) );\r\n\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND Buy_1;\r\n\r\nSell = def_Sell AND Sell_1;\r\n\r\n/*******************************************************************************************/\r\nAddAlert( Buy, Audio, Email, "Standard line crossed Turning line", 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( Sell, Audio, Email, "Turning line crossed Standard line", 2, BarComplete, def_SellSound1 );\r\n\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Lines" );\r\n\r\nPlot( TL, "TL", TLcolor, TLstyle );\r\n\r\nPlot( SL, "SL", SLcolor, SLstyle );\r\n\r\nPlot( DL, "DL", DLcolor, DLstyle );\r\n\r\nPlotOHLC( 0, SpanA_ahead, SpanB_ahead, SpanB_ahead, "Cloud", IIf( SpanA_ahead &gt; SpanB_ahead, Cloud1color, Cloud2color ), styleCloud + styleNoTitle + styleNoLabel, Null, Null, p4 );\r\n\r\nPlotShapes( BuyShape*Buy, BuyShapecolor, 0, L, -def_BuyShapeOffset );\r\n\r\nPlotShapes( SellShape*Sell, SellShapecolor, 0, H, -def_SellShapeOffset );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( Buy OR Sell );\r\n\r\nAddefaultcolumns();\r\n\r\nAdddefaultcolumns( 2, 1 );\r\n\r\nAddColumn( Strength_1, "Signal Strength", 1.0 );\r\n\r\nAddTextColumn( FullName(), "Full name" );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip + WriteIf( Buy, "\\n\\n" + "Signal = Buy, " + "Signal strength = " + WriteVal( Strength_1, 1.0 ), WriteIf( Sell, "\\n\\n" + "Signal = Sell, " + "Signal strength = " + WriteVal( Strength_1, 1.0 ), "" ) ) + "\\n" + interpretation;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Ichimoku Chart" + default_priceTitle + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Ichimoku Chart 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
		<Pane>
			<ChartID>1062</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Volume\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Volume";\r\n\r\nSetChartOptions( 0, chartShowDates | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Volume" );\r\nType = ParamList( "Color Mode", "Simple,Standard,Extended", 2 );\r\nUpColor = ParamColor( "Up Color", colorGreen );\r\nDnColor = ParamColor( "Down Color", colorRed );\r\nNeutralColor = ParamColor( "Neutral Color", def_Color6 );\r\nstyle =  ParamStyle( "Style", styleHistogram | styleOwnScale | styleThick, maskHistogram  );\r\n/*******************************************************************************************/\r\n\r\nif ( Type == "Simple" )\r\n    Plot( Volume, _DEFAULT_NAME(), NeutralColor, style );\r\n\r\n/*******************************************************************************************/\r\nif ( Type == "Standard" )\r\n    Plot( Volume, _DEFAULT_NAME(), IIf( C &gt; O, UpColor, DnColor ), style );\r\n\r\n/*******************************************************************************************/\r\nif ( Type == "Extended" )\r\n    Plot( Volume, _DEFAULT_NAME(), IIf( C &gt; Ref( C, -1 ) AND V &gt; Ref( V, -1 ), UpColor, IIf( C &lt; Ref( C, -1 ) AND V &gt; Ref( V, -1 ), DnColor, NeutralColor ) ), style );\r\n\r\n_SECTION_END();\r\n\r\n/*******************************************************************************************/\r\nAddGradientBackground( def_BGColorswitch, def_BgTopcolor, def_BgBottomcolor, def_titlebkcolor );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com" + " - " +  Name() + " - " + EncodeColor( colorOrange ) + "Volume = " + WriteVal( Volume ) + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Volume 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741843</MoreFlags>
			<Min>-8101</Min>
			<Max>425789</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>PE-Basic #2</Name>
		<Pane>
			<ChartID>1063</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Price chart\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Price Chart";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nAddefaultcolumns();\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\n\r\nif ( inAA )\r\n{\r\n    _SECTION_BEGIN( "Fundamental Data" );\r\n\r\n    if ( ParamToggle( "Show Columns in AA", "Off,On", 1 ) )\r\n    {\r\n        AddColumn( GetFnData( "EPS" ), "EPS" );\r\n        AddColumn( GetFnData( "EPSEstCurrentYear" ), "EPS Est Current Year" );\r\n        AddColumn( GetFnData( "EPSEstNextYear" ), "EPS Est Next Year" );\r\n        AddColumn( GetFnData( "EPSEstNextQuarter" ), "EPS Est Next Quarter" );\r\n        AddColumn( GetFnData( "PEGRatio" ), "PEG Ratio" );\r\n        AddColumn( GetFnData( "SharesFloat" ), "Shares Float", 1.0 );\r\n        AddColumn( GetFnData( "SharesOut" ), "Shares Out", 1.0 );\r\n        //AddColumn(GetFnData("DividendPayDate"),"Dividend Pay Date");\r\n        //AddColumn(GetFnData("ExDividendDate"),"Ex Dividend Date");\r\n        AddColumn( GetFnData( "BookValuePerShare" ), "Book Value Per Share" );\r\n        AddColumn( GetFnData( "DividendPerShare" ), "Dividend Per Share" );\r\n        AddColumn( GetFnData( "ProfitMargin" ), "Profit Margin" );\r\n        AddColumn( GetFnData( "OperatingMargin" ), "Operating Margin" );\r\n        AddColumn( GetFnData( "OneYearTargetPrice" ), "One Year Target Price" );\r\n        AddColumn( GetFnData( "ReturnOnAssets" ), "Return On Assets" );\r\n        AddColumn( GetFnData( "ReturnOnEquity" ), "Return On Equity" );\r\n        AddColumn( GetFnData( "QtrlyRevenueGrowth" ), "Qtrly Revenue Growth" );\r\n        AddColumn( GetFnData( "GrossProfitPerShare" ), "Gross Profit Per Share" );\r\n        AddColumn( GetFnData( "SalesPerShare" ), "Sales Per Share" );\r\n        AddColumn( GetFnData( "EBITDAPerShare" ), "EBITDA Per Share" );\r\n        AddColumn( GetFnData( "QtrlyEarningsGrowth" ), "Qtrly Earnings Growth" );\r\n        AddColumn( GetFnData( "InsiderHoldPercent" ), "Insider Hold Percent" );\r\n        AddColumn( GetFnData( "InstitutionHoldPercent" ), "Institution Hold Percent" );\r\n        AddColumn( GetFnData( "SharesShort" ), "Shares Short", 1.0 );\r\n        AddColumn( GetFnData( "SharesShortPrevMonth" ), "Shares Short Prev Month", 1.0 );\r\n        AddColumn( GetFnData( "ForwardDividendPerShare" ), "Forward Dividend Per Share" );\r\n        AddColumn( GetFnData( "ForwardEPS" ), "Forward EPS" );\r\n        AddColumn( GetFnData( "OperatingCashFlow" ), "Operating Cash Flow", 1.0 );\r\n        AddColumn( GetFnData( "LeveredFreeCashFlow" ), "Levered Free Cash Flow", 1.0 );\r\n        AddColumn( GetFnData( "Beta" ), "Beta" );\r\n        AddColumn( GetFnData( "LastSplitRatio" ), "Last Split Ratio" );\r\n        //AddColumn(GetFnData("LastSplitDate"),"Last Split Date");\r\n    }\r\n\r\n    _SECTION_END();\r\n}\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n\r\n/*******************************************************************************************/\r\nTitle = "PatternExplorer.com - Price Chart" + default_priceTitle + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Price Chart 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
		<Pane>
			<ChartID>1064</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Price chart TS - with Taio based Shapes\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Price Chart TS";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Indicator Periods" );\r\nperiod1 = Param( "Period 1", 5, 1, 30, 1 );\r\nperiod2 = Param( "Period 2", 6, 1, 30, 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Settings" );\r\nTrendLevel = Param( "Trend Level", 50, 0, 90, 1 );\r\nOBOSLevel = Param( "OB/OS Level", 80, 0, 100, 1 );\r\nOBOSLevelTF2 = Param( "OB/OS Level TF2", 60, 25, 100, 1 );\r\nTF2drop = ParamToggle( "TF2 Turn Over", "Off|0n", 0 );\r\nTaio2expandMode = ParamToggle( "Taio TF2 Expand Mode", "Expand First|Expand Last", 1 );\r\nMultiplier = Param( "Second Time Frame Multiplier", 4, 1, 30, 1 );\r\nUseExrem = ParamToggle( "Use Exrem", "Off|0n", 0 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Buy and Sell Signals" );\r\nBuySig = ParamList( "Buy Signal", List1 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Oversold,Trend Level reached,Taio2 Direction change", 2 );\r\nSellSig = ParamList( "Sell Signal", List2 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Overbought,Trend Level reached,Taio2 Direction change", 1 );\r\nBuyShape = Param( "Buy Shape Typ", def_BuyShape, 0, 50, 1 );\r\nSellShape = Param( "Sell Shape Typ", def_SellShape, 0, 50, 2 );\r\nBuyshapecolor = ParamColor( "Buy Shape Color", def_BuyShapeColor );\r\nSellshapecolor = ParamColor( "Sell Shape Color", def_SellShapeColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Short and Cover Signals" );\r\nShortSig = ParamList( "Short Signal", List1sig2 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Overbought,Trend Level reached,Taio2 Direction change", 7 );\r\nCoverSig = ParamList( "Cover Signal", List2sig2 = "Off,Taio Top,Taio Valley,Zero Line Cross,Zero Line Bounce,Oversold,Trend Level reached,Taio2 Direction change", 7 );\r\nShortShape = Param( "Short Shape Typ", def_ShortShape, 0, 50, 2 );\r\nCoverShape = Param( "Cover Shape Typ", def_CoverShape, 0, 50, 1 );\r\nShortshapecolor = ParamColor( "Short Shape Color", def_ShortShapeColor );\r\nCovershapecolor = ParamColor( "Cover Shape Color", def_CoverShapeColor );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\Lib\\PatternExplorer_f05.afl&gt;\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND\r\n      IIf( BuySignal == 0, Null,\r\n           IIf( BuySignal == 1, TpVa == -1,\r\n                IIf( BuySignal == 2, TpVa == 1,\r\n                     IIf( BuySignal == 3, ZLC == 1,\r\n                          IIf( BuySignal == 4, ZLB == 1,\r\n                               IIf( BuySignal == 5, Oversold == 1,\r\n                                    IIf( BuySignal == 6, UpperLevelreached == 1,\r\n                                         IIf( BuySignal == 7, Taio2upsig == 1, Null ) ) ) ) ) ) ) );\r\nSell = def_Sell AND\r\n       IIf( SellSignal == 0, Null,\r\n            IIf( SellSignal == 1, TpVa == -1,\r\n                 IIf( SellSignal == 2, TpVa == 1,\r\n                      IIf( SellSignal == 3, ZLC == -1,\r\n                           IIf( SellSignal == 4, ZLB == -1,\r\n                                IIf( SellSignal == 5, Overbought == -1,\r\n                                     IIf( SellSignal == 6, LowerLevelreached == -1,\r\n                                          IIf( SellSignal == 7, Taio2dnsig == 1, Null ) ) ) ) ) ) ) );\r\nShort = def_Short AND\r\n        IIf( ShortSignal == 0, Null,\r\n             IIf( ShortSignal == 1, TpVa == -1,\r\n                  IIf( ShortSignal == 2, TpVa == 1,\r\n                       IIf( ShortSignal == 3, ZLC == -1,\r\n                            IIf( ShortSignal == 4, ZLB == -1,\r\n                                 IIf( ShortSignal == 5, Overbought == 1,\r\n                                      IIf( ShortSignal == 6, LowerLevelreached == 1,\r\n                                           IIf( ShortSignal == 7, Taio2dnsig == 1, Null ) ) ) ) ) ) ) );\r\nCover = def_Cover AND\r\n        IIf( CoverSignal == 0, Null,\r\n             IIf( CoverSignal == 1, TpVa == -1,\r\n                  IIf( CoverSignal == 2, TpVa == 1,\r\n                       IIf( CoverSignal == 3, ZLC == 1,\r\n                            IIf( CoverSignal == 4, ZLB == 1,\r\n                                 IIf( CoverSignal == 5, Oversold == 1,\r\n                                      IIf( CoverSignal == 6, UpperLevelreached == 1,\r\n                                           IIf( CoverSignal == 7, Taio2upsig == 1, Null ) ) ) ) ) ) ) );\r\n\r\nif ( UseExrem )\r\n{\r\n    Buy = ExRem( Buy, Sell );\r\n    Sell = ExRem( Sell, Buy );\r\n    Short = ExRem( Short, Cover );\r\n    Cover = ExRem( Cover, Short );\r\n}\r\n\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\n\r\nFilter = Filter AND ( Buy OR Sell OR Short OR Cover );\r\n\r\n/*******************************************************************************************/\r\nAddAlert( Buy, Audio, Email, BuySig, 1, BarComplete, def_BuySound1 );\r\n\r\nAddAlert( Sell, Audio, Email, SellSig, 2, BarComplete, def_SellSound1 );\r\n\r\nAddAlert( Short, Audio, Email, ShortSig, 3, BarComplete, def_ShortSound1 );\r\n\r\nAddAlert( Cover, Audio, Email, CoverSig, 4, BarComplete, def_CoverSound1 );\r\n\r\n/*******************************************************************************************/\r\nif ( inAA )\r\n{\r\n    _SECTION_BEGIN( "Automatic Analysis - Exploration" );\r\n    Widecolumns = ParamToggle( "Wide columns", "No,Yes", 1 );\r\n    _SECTION_END();\r\n    /*******************************************************************************************/\r\n\r\n    if ( Widecolumns )\r\n    {\r\n        Addefaultcolumns();\r\n        AddColumn( Taio, "Taio", 1 );\r\n        AddColumn( Taio2, "Taio TF2", 1, 1, colorWhite, 60 );\r\n        AddColumn( TpVa, "Taio Top / Valley", 1, 1, IIf( TpVa == 1 OR TpVa == -1, colorLightBlue, colorWhite ), 100 );\r\n        AddColumn( ZLC, "Zero Line Cross", 1, 1, IIf( ZLCp, def_Color1, IIf( ZLCn, colorRed, colorWhite ) ), 90 );\r\n        AddColumn( ZLB, "Zero Line Bounce", 1, 1, IIf( ZLBp, def_Color1, IIf( ZLBn, colorRed, colorWhite ) ), 100 );\r\n        AddColumn( TrendLevelreached, "Trend Level reached", 1, 1, IIf( UpperLevelreached, def_Color1, IIf( LowerLevelreached, colorRed, colorWhite ) ), 120 );\r\n        AddColumn( OBOS, "Overbought/Oversold", 1, 1, IIf( Oversold, def_Color1, IIf( Overbought, colorRed, colorWhite ) ), 120 );\r\n        AddColumn( IIf( Taio &gt; TrendLevel, BarsSince( Cross( Taio, TrendLevel ) ), IIf( Taio &lt; -TrendLevel, BarsSince( Cross( -TrendLevel, Taio ) ), Null ) ), "Bars since Trendlevel reached", 1.0 );\r\n        AddTextColumn( FullName(), "Full name", 120 );\r\n    }\r\n    else\r\n    {\r\n        Addefaultcolumns();\r\n        Adddefaultcolumns( 2, 1 );\r\n        AddColumn( Taio, "Taio", 1 );\r\n        AddColumn( Taio2, "Taio TF2", 1, 1, colorWhite, 60 );\r\n        AddColumn( TpVa, "T/V", 1, 1, IIf( TpVa == 1 OR TpVa == -1, colorLightBlue, colorWhite ), 40 );\r\n        AddColumn( ZLC, "ZLC", 1, 1, IIf( ZLCp, def_Color1, IIf( ZLCn, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( ZLB, "ZLB", 1, 1, IIf( ZLBp, def_Color1, IIf( ZLBn, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( TrendLevelreached, "TLR", 1, 1, IIf( UpperLevelreached, def_Color1, IIf( LowerLevelreached, colorRed, colorWhite ) ), 40 );\r\n        AddColumn( OBOS, "OB/OS", 1, 1, IIf( Oversold, def_Color1, IIf( Overbought, colorRed, colorWhite ) ), 60 );\r\n        AddColumn( IIf( Taio &gt; TrendLevel, BarsSince( Cross( Taio, TrendLevel ) ), IIf( Taio &lt; -TrendLevel, BarsSince( Cross( -TrendLevel, Taio ) ), Null ) ), "BSTR", 1.0 );\r\n        AddTextColumn( FullName(), "Full name" );\r\n    }\r\n}\r\n\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\nPlotShapes( BuyShape*Buy, BuyShapecolor, 0, L, -def_BuyShapeOffset );\r\n\r\nPlotShapes( SellShape*Sell, SellShapecolor, 0, H, -def_SellShapeOffset );\r\n\r\nPlotShapes( ShortShape*Short, Shortshapecolor, 0, H, -def_ShortShapeOffset );\r\n\r\nPlotShapes( CoverShape*Cover, Covershapecolor, 0, L, -def_CoverShapeOffset );\r\n\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\n\r\nTitle = "PatternExplorer.com - Price Chart TS" + default_priceTitle + " ";\r\n\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Price Chart TS 3.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
		<Pane>
			<ChartID>1065</ChartID>
			<PercentHeight>33</PercentHeight>
			<Formula>//|-----------------------------------------------------------------------------------------\r\n//|PatternExplorer.com - Rainbow Chart\r\n//|Copyright © 2007, PatternExplorer.com\r\n//|http://www.PatternExplorer.com\r\n//|e-mail: support@PatternExplorer.com\r\n//|-----------------------------------------------------------------------------------------\r\nFormulaName = "PE - Rainbow Chart";\r\n\r\nSetChartOptions( 0, chartShowDates | chartShowArrows | chartLogarithmic | chartWrapTitle );\r\n#pragma nocache\r\n#include_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl"\r\n#Include_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl"\r\n/*******************************************************************************************/\r\nAddCustomCodeBeforePE();\r\n/*******************************************************************************************/\r\nAddAlertParam( def_AudioAlert, def_EmailAlert, def_BarComplete );\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Main Parameters" );\r\n//AddparamUsefromChart(1);\r\nside = 1;\r\nAddAvgTypeParam( 1 );\r\n//if(InChart) StaticVarSet("B4G8C8",AvgType);if(inAA AND Usefromchart) AvgType = StaticVarGet("B4G8C8");\r\nPF = ParamField( "Price Field" );\r\n//PF parameter from chart not available automatically in AA. It has to be selected in AA if not close is used.\r\nincrement = Param( "Increment", 2, 1, 10, 1 );\r\n//if(InChart) StaticVarSet("F6P4C8",increment);if(inAA AND Usefromchart) increment = StaticVarGet("F6P4C8");\r\nStartAvg = Param( "Fastest Average (Period)", 3, 1, 20, 1 );\r\n//if(InChart) StaticVarSet("W6O4D1",StartAvg);if(inAA AND Usefromchart) StartAvg = StaticVarGet("W6O4D1");\r\nLastAvg = Param( "Slowest Average (Max.Period)", 20, 1, 100, 1 );\r\n//if(InChart) StaticVarSet("G4C0A6",LastAvg);if(inAA AND Usefromchart) LastAvg = StaticVarGet("G4C0A6");\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\n_SECTION_BEGIN( "Styles" );\r\nEffect = ParamToggle( "3D Effect", "No|Yes", 0 );\r\nDisplayType = ParamToggle( "Plot Style", "Lines,Shadows", def_LinesORShadows );\r\nLineStyle = ParamStyle( "Lines", styleThick, maskDefault );\r\nShapes = ParamToggle( "Plot Shapes", "Off,On", 1 );\r\nBuyshape = Param( "Buy Shape Typ", def_BuyShape, 0, 50, 1 );\r\nSellShape = Param( "Sell Shape Typ", def_SellShape, 0, 50, 1 );\r\n_SECTION_END();\r\n/*******************************************************************************************/\r\nCount = 0;\r\n\r\nfor ( i = StartAvg; i &lt; LastAvg; i = i + increment )\r\n{\r\n    /*******************************************************************************************/\r\n    _SECTION_BEGIN( "Colors" );\r\n    Hue = Param( "Hue", 15, 1, 50, 1 ) * i;\r\n    Saturation = Param( "Saturation", 150, 0, 255 );\r\n    Brightness = side * Param( "Brightness", 200, 0, 255 );\r\n    Buyshapecolor = ParamColor( "Buy Shape Color", def_BuyShapeColor );\r\n    Sellshapecolor = ParamColor( "Sell Shape Color", def_SellShapeColor );\r\n    _SECTION_END();\r\n    /*******************************************************************************************/\r\n    up = Average( Pf, i, AvgType );\r\n    down = Average( Pf, i + increment, AvgType );\r\n\r\n    if ( Effect )\r\n        side = IIf( up &lt;= down AND Ref( up &lt;= down, 1 ), 0.6, 1 );\r\n\r\n    a = 0;\r\n\r\n    Count = Count + 1;\r\n\r\n    if ( DisplayType )\r\n    {\r\n        PlotOHLC( up, up, down, down, "Average" + i, ColorHSB( Hue, Saturation, Brightness ), styleCloud | styleNoLabel | styleNoTitle );\r\n    }\r\n    else\r\n    {\r\n        Plot( up, "Average" + i, ColorHSB( Hue, Saturation, Brightness ), LineStyle | styleNoLabel | styleNoTitle );\r\n    }\r\n}\r\n\r\nFastest = Average( Pf, StartAvg, AvgType );\r\n\r\nSlowestPds = StartAVG + ( Count - 1 ) * Increment;\r\nSlowest = Average( Pf, SlowestPds, AvgType );\r\n/*******************************************************************************************/\r\nBuy = def_Buy AND Cross( fastest, slowest );\r\nSell = def_Sell AND Cross( slowest, fastest );\r\n/*******************************************************************************************/\r\n/*\r\nBodySize = 0.1;\r\nHeikinAshiDoji = abs((HaClose-HaOpen))&lt;(HaHigh-HaLow)/(1/BodySize);\r\n\r\nBuy = def_Buy AND Close &lt; slowest AND HaClose&gt;HaOpen AND Ref(HeikinAshiDoji,-1);//Heikin ashi doji outside from Rainbow\r\nSell = def_Sell AND Close &gt; slowest AND HaClose&lt;HaOpen AND Ref(HeikinAshiDoji,-1);//Heikin ashi doji outside from Rainbow\r\n\r\n//Buy = def_Buy AND (Buy OR Cross(fastest,slowest));//Rainbow signal and HA doji\r\n//Sell = def_Sell AND (Sell OR Cross(slowest,fastest));//Rainbow signal and HA doji\r\n*/\r\n/*******************************************************************************************/\r\nPlotShapes( Buy*Buyshape*Shapes, Buyshapecolor, 0, L, -def_BuyShapeOffset - 5 );\r\nPlotShapes( Sell*Sellshape*Shapes, Sellshapecolor, 0, H, -def_SellShapeOffset - 5 );\r\n/*******************************************************************************************/\r\nAddAlert( Buy, Audio, Email, "Fastest Average crossed slowest Average", 1, BarComplete, def_BuySound1 );\r\nAddAlert( Sell, Audio, Email, "Slowest Average crossed Fastest Average", 2, BarComplete, def_SellSound1 );\r\n/*******************************************************************************************/\r\nFilter = def_Filter AND NOT GroupID() == 253;\r\nFilter = Filter AND ( Buy OR Sell );\r\n/*******************************************************************************************/\r\nAddefaultcolumns();\r\nAdddefaultcolumns( 2, 1 );\r\nAddTextColumn( FullName(), "Full name" );\r\n/*******************************************************************************************/\r\nToolTip = def_ToolTip;\r\nTitle = "PatternExplorer.com - Rainbow Chart " + Avgtext;\r\n/*******************************************************************************************/\r\n#include_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;\r\n/*******************************************************************************************/\r\n/*******************************************************************************************/\r\nAddCustomCodeAfterPE();\r\n/*******************************************************************************************/\r\nTitle = Title + default_priceTitle + " ";\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\PE - Rainbow Chart 3.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741855</MoreFlags>
			<Min>474.553</Min>
			<Max>998.304</Max>
		</Pane>
	</Sheet>
	<Includes>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f10.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f13.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f01.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f05.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f10.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f06.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f07.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f11.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f12.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f01.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Defaults.afl</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once "C:\\Program Files (x86)\\AmiBroker5\\Formulas\\PatternExplorer\\#Defaults &amp; Mods\\PE - Mods.afl</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f13.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f04.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f14.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f15.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f02.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f03.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\Lib\\PatternExplorer_f05.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_f0.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
		<File>
			<Path>_once  &lt;\\PEInc\\PatternExplorer_1.afl&gt;</Path>
			<Formula>
			</Formula>
		</File>
	</Includes>
</Window>
